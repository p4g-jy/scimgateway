// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: SCIM Stream is a prerequisite for message subscription
//       for details see: https://elshaug.xyz/docs/scim-stream
//
// ================================================================
'use strict';const a0_0x1411a2=a0_0x1aec;(function(_0x1bc9a9,_0xce0693){const _0x47297a=a0_0x1aec,_0x5e16f5=_0x1bc9a9();while(!![]){try{const _0x242b43=-parseInt(_0x47297a(0x18e))/0x1+parseInt(_0x47297a(0x1bb))/0x2*(-parseInt(_0x47297a(0x175))/0x3)+parseInt(_0x47297a(0xfe))/0x4*(parseInt(_0x47297a(0x111))/0x5)+parseInt(_0x47297a(0x1a6))/0x6*(-parseInt(_0x47297a(0x11d))/0x7)+parseInt(_0x47297a(0x103))/0x8*(-parseInt(_0x47297a(0x1bd))/0x9)+-parseInt(_0x47297a(0x11a))/0xa+parseInt(_0x47297a(0x19a))/0xb*(parseInt(_0x47297a(0x16f))/0xc);if(_0x242b43===_0xce0693)break;else _0x5e16f5['push'](_0x5e16f5['shift']());}catch(_0x51457b){_0x5e16f5['push'](_0x5e16f5['shift']());}}}(a0_0x4879,0x43510));const nats=require(a0_0x1411a2(0xf6)),ascii127=require(a0_0x1411a2(0x16a)),fs=require('fs'),utils=require(a0_0x1411a2(0x102)),path=require(a0_0x1411a2(0x160)),crypto=require(a0_0x1411a2(0x14d));function a0_0x1aec(_0x18737c,_0x26d716){const _0x48799c=a0_0x4879();return a0_0x1aec=function(_0x1aecd9,_0x47fd71){_0x1aecd9=_0x1aecd9-0xf5;let _0x22d9ab=_0x48799c[_0x1aecd9];return _0x22d9ab;},a0_0x1aec(_0x18737c,_0x26d716);}module['exports'][a0_0x1411a2(0x130)]=function(_0xf1bb45,_0x3002aa,_0xb77f27,_0x53b3e4){const _0xbbad37=a0_0x1411a2,_0x1b5b69=_0xf1bb45,_0x51a98e=_0x3002aa,_0xf45a2b=_0xb77f27,_0xbf5b23=_0x53b3e4;if(!_0x51a98e['certificate']||!_0x51a98e[_0xbbad37(0x106)]['ca']){_0x1b5b69[_0xbbad37(0x170)][_0xbbad37(0x188)](_0x1b5b69[_0xbbad37(0x10f)]+'['+_0x1b5b69[_0xbbad37(0x18f)]+']\x20subscriber\x20error:\x20missing\x20certificate\x20configuration');return;}if(!_0x51a98e[_0xbbad37(0x1b3)]){_0x1b5b69[_0xbbad37(0x170)][_0xbbad37(0x188)](_0x1b5b69[_0xbbad37(0x10f)]+'['+_0x1b5b69['pluginName']+_0xbbad37(0x198));return;}let _0x47b2c2='';for(let _0x1ef563=0x0;_0x1ef563<_0x1b5b69[_0xbbad37(0x170)][_0xbbad37(0x19b)][_0xbbad37(0x172)];_0x1ef563++){if(_0x1b5b69['logger'][_0xbbad37(0x19b)][_0x1ef563][_0xbbad37(0x120)]===_0xbbad37(0x11c)){_0x47b2c2=_0x1b5b69[_0xbbad37(0x170)][_0xbbad37(0x19b)][_0x1ef563][_0xbbad37(0x112)];break;}}const _0x1a761a=''+(_0x47b2c2==='debug'?'\x0a':''),_0x1922d9={};try{_0x1922d9['ca']=[fs[_0xbbad37(0x109)](_0x1b5b69['configDir']+'/certs/'+_0x51a98e[_0xbbad37(0x106)]['ca'])];}catch(_0x2c6aa){_0x1b5b69[_0xbbad37(0x170)][_0xbbad37(0x188)](_0x1b5b69[_0xbbad37(0x10f)]+'['+_0x1b5b69['pluginName']+_0xbbad37(0x122)+_0x2c6aa[_0xbbad37(0x1b4)]);return;}const _0x11e7f3={},_0x143446=new TextEncoder()[_0xbbad37(0x124)](_0x51a98e[_0xbbad37(0xf6)][_0xbbad37(0x14f)]),_0x411b6a=_0x51a98e[_0xbbad37(0xf6)]['jwt'];_0x11e7f3[_0xbbad37(0x15d)]=nats['jwtAuthenticator'](_0x411b6a,_0x143446),_0x11e7f3[_0xbbad37(0x19f)]=_0x51a98e['baseUrls'],_0x11e7f3['tls']=_0x1922d9,_0x11e7f3[_0xbbad37(0x140)]=![],_0x11e7f3['reconnect']=!![],_0x11e7f3['reconnectTimeWait']=0x3e8*0xa,_0x11e7f3['maxReconnectAttempts']=-0x1,_0x11e7f3[_0xbbad37(0x195)]=0x2*0x3c*0x3e8,_0x11e7f3[_0xbbad37(0x1a7)]=0x5,_0x11e7f3[_0xbbad37(0x132)]=![];let _0x496767;this[_0xbbad37(0x1be)]=async()=>{const _0x20e8d4=_0xbbad37;try{_0x496767=await nats['connect'](_0x11e7f3);}catch(_0x61f63){_0x1b5b69['logger'][_0x20e8d4(0x188)](_0x1b5b69[_0x20e8d4(0x10f)]+'['+_0x1b5b69['pluginName']+_0x20e8d4(0x15a)+_0xf45a2b+']['+_0xbf5b23+']\x20connect\x20error:\x20'+_0x61f63['message']+'\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration'),_0x11e7f3[_0x20e8d4(0x140)]=!![];try{_0x496767=await nats[_0x20e8d4(0x1be)](_0x11e7f3);}catch(_0x174020){_0x1b5b69[_0x20e8d4(0x170)]['error'](_0x1b5b69[_0x20e8d4(0x10f)]+'['+_0x1b5b69[_0x20e8d4(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+_0x20e8d4(0x1b8)+_0x174020['message']);return;}}_0x1b5b69['logger'][_0x20e8d4(0x135)](_0x1b5b69[_0x20e8d4(0x10f)]+'['+_0x1b5b69[_0x20e8d4(0x18f)]+_0x20e8d4(0x15a)+_0xf45a2b+']['+_0xbf5b23+']\x20connected\x20'+(_0x11e7f3[_0x20e8d4(0x158)]['ca']?_0x20e8d4(0x158):'')+'\x20'+_0x496767[_0x20e8d4(0x157)]()),_0x496767[_0x20e8d4(0x150)]()[_0x20e8d4(0x17a)](_0x5be8ff=>{const _0x4bff47=_0x20e8d4;_0x5be8ff&&_0x1b5b69[_0x4bff47(0x170)][_0x4bff47(0x188)](_0x1b5b69[_0x4bff47(0x10f)]+'['+_0x1b5b69[_0x4bff47(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+']\x20closed\x20with\x20error:\x20'+_0x5be8ff[_0x4bff47(0x1b4)]);});},this[_0xbbad37(0xfc)]=async()=>{const _0x714335=_0xbbad37;if(!_0xbf5b23||!_0x51a98e[_0x714335(0x10a)]||!_0x51a98e[_0x714335(0x106)]||!_0x51a98e[_0x714335(0x106)]['ca']||!_0x51a98e['nats']||!_0x51a98e[_0x714335(0xf6)]['tenant']||!_0x51a98e[_0x714335(0xf6)][_0x714335(0x14f)]||!_0x51a98e[_0x714335(0xf6)][_0x714335(0x199)]){_0x1b5b69[_0x714335(0x170)]['error'](_0x1b5b69[_0x714335(0x10f)]+'['+_0x1b5b69[_0x714335(0x18f)]+_0x714335(0x15a)+_0xf45a2b+']['+_0xbf5b23+_0x714335(0x13d));return;}if(_0xbf5b23[_0x714335(0xff)]('.')['length']<0x2){_0x1b5b69[_0x714335(0x170)][_0x714335(0x188)](_0x1b5b69[_0x714335(0x10f)]+'['+_0x1b5b69['pluginName']+_0x714335(0x15a)+_0xf45a2b+']['+_0xbf5b23+']\x20error:\x20subject\x20'+_0xbf5b23+_0x714335(0x1ab));return;}if(_0xbf5b23['includes'](',')){_0x1b5b69['logger'][_0x714335(0x188)](_0x1b5b69[_0x714335(0x10f)]+'['+_0x1b5b69[_0x714335(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+_0x714335(0x16e));return;}if(!_0x496767){_0x1b5b69[_0x714335(0x170)]['error'](_0x1b5b69[_0x714335(0x10f)]+'['+_0x1b5b69[_0x714335(0x18f)]+_0x714335(0x15a)+_0xf45a2b+']['+_0xbf5b23+_0x714335(0x178));return;}const _0x1fa7c2=async(_0x457fc8,_0x12019c)=>{const _0x205e55=_0x714335;try{_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x135)](_0x457fc8+_0x205e55(0x15b)+_0x12019c);let _0x588661;try{if(_0x51a98e[_0x205e55(0x146)]&&Array[_0x205e55(0x141)](_0x51a98e[_0x205e55(0x146)]))for(let _0x4994d6=0x0;_0x4994d6<_0x51a98e[_0x205e55(0x146)][_0x205e55(0x172)];_0x4994d6++){const _0x2f33ea=_0x51a98e['replaceDomains'][_0x4994d6];if(!_0x2f33ea[_0x205e55(0x171)]||!_0x2f33ea[_0x205e55(0x171)]['includes']('.')||!_0x2f33ea['to']||!_0x2f33ea['to'][_0x205e55(0x163)]('.'))continue;const _0x5682cc=new RegExp('@'+_0x2f33ea[_0x205e55(0x171)]+'\x22','gi');_0x12019c=_0x12019c[_0x205e55(0x1a5)](_0x5682cc,'@'+_0x2f33ea['to']+'\x22');}_0x588661=JSON[_0x205e55(0x177)](_0x12019c);}catch(_0x93f9ce){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](_0x457fc8+'\x20message\x20json\x20parsing\x20error:\x20'+_0x93f9ce[_0x205e55(0x1b4)]+_0x205e55(0x133)+_0x12019c),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}const _0x5772f2=_0x588661['user'];if(!_0x5772f2){_0x1b5b69[_0x205e55(0x170)]['error'](_0x457fc8+_0x205e55(0x194)+JSON[_0x205e55(0x13b)](_0x588661)),_0x1b5b69['logger'][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}if(!_0x5772f2['userName']){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](_0x457fc8+'\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20'+JSON[_0x205e55(0x13b)](_0x588661)),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}delete _0x5772f2[_0x205e55(0x180)];let _0x5ddf26;_0x5772f2['id']&&(_0x5ddf26=_0x5772f2['id'],delete _0x5772f2['id']);let _0x18ded9;_0x5772f2[_0x205e55(0x1ae)]&&(_0x18ded9=utils[_0x205e55(0x12f)](_0x5772f2['onCreate']),delete _0x5772f2[_0x205e55(0x1ae)]);await _0x2b8d29(_0x5772f2);const _0x579f72=_0x5772f2['userName'];let _0x20103e,_0x5991c3;try{_0x20103e=await _0x41c8ed(_0x205e55(0xf5),_0x579f72);}catch(_0x5ca322){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](_0x457fc8+_0x205e55(0x155)+_0x5ca322[_0x205e55(0x1b4)]),_0x1b5b69['logger'][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}if(!_0x51a98e[_0x205e55(0x154)]){let _0x1aec3c=![];if(_0x588661[_0x205e55(0x145)]&&Array[_0x205e55(0x141)](_0x588661[_0x205e55(0x145)]))for(let _0x36717d=0x0;_0x36717d<_0x588661[_0x205e55(0x145)][_0x205e55(0x172)];_0x36717d++){const _0x5bc6ff=_0x588661['Operations'][_0x36717d];_0x5bc6ff[_0x205e55(0x160)]['startsWith'](_0x205e55(0x1b7))&&(_0x5bc6ff[_0x205e55(0x160)]='groups',Array[_0x205e55(0x141)](_0x5bc6ff[_0x205e55(0x173)])?(_0x5bc6ff['value'][0x0]['id']=_0x5bc6ff[_0x205e55(0x173)][0x0][_0x205e55(0x173)],_0x5bc6ff[_0x205e55(0x173)][0x0]['display']=_0x5bc6ff[_0x205e55(0x173)][0x0][_0x205e55(0xfd)]+_0x205e55(0x128)+_0x5bc6ff[_0x205e55(0x173)][0x0]['value'],delete _0x5bc6ff[_0x205e55(0x173)][0x0]['value'],delete _0x5bc6ff[_0x205e55(0x173)][0x0][_0x205e55(0xfd)]):_0x5bc6ff[_0x205e55(0x173)]=[{'id':_0x5bc6ff[_0x205e55(0x173)],'display':_0x5bc6ff['value']}],delete _0x5bc6ff['typeId'],_0x1aec3c=!![]);}if(_0x5772f2[_0x205e55(0x1b7)]&&Array[_0x205e55(0x141)](_0x5772f2['roles'])&&_0x5772f2['roles'][_0x205e55(0x172)]>0x0){if(!_0x5772f2[_0x205e55(0x12a)])_0x5772f2[_0x205e55(0x12a)]=[];if(!Array[_0x205e55(0x141)](_0x5772f2[_0x205e55(0x12a)]))_0x5772f2[_0x205e55(0x12a)]=[];for(let _0x274880=0x0;_0x274880<_0x5772f2['roles'][_0x205e55(0x172)];_0x274880++){const _0x219f94={},_0x4adb66=_0x5772f2[_0x205e55(0x1b7)][_0x274880];_0x219f94[_0x205e55(0x173)]=_0x4adb66[_0x205e55(0x173)],_0x219f94['display']=_0x4adb66[_0x205e55(0xfd)]+_0x205e55(0x128)+_0x4adb66[_0x205e55(0x1a4)],_0x5772f2[_0x205e55(0x12a)]['push'](_0x219f94);}delete _0x5772f2[_0x205e55(0x1b7)],_0x1aec3c=!![];}if(_0x1aec3c)_0x1b5b69[_0x205e55(0x170)]['debug'](_0x457fc8+_0x205e55(0x151)+JSON[_0x205e55(0x13b)](_0x588661));}if(_0x51a98e[_0x205e55(0x182)]&&_0x588661['activityOperation']==='modifyUser'){if(_0x5772f2[_0x205e55(0x12a)]&&Array[_0x205e55(0x141)](_0x5772f2[_0x205e55(0x12a)])&&_0x5772f2[_0x205e55(0x12a)]['length']===0x0){if(_0x5772f2[_0x205e55(0x1b7)]&&Array[_0x205e55(0x141)](_0x5772f2[_0x205e55(0x1b7)])&&_0x5772f2[_0x205e55(0x1b7)]['length']===0x0){if(_0x588661['Operations']&&Array[_0x205e55(0x141)](_0x588661[_0x205e55(0x145)])&&_0x588661[_0x205e55(0x145)][_0x205e55(0x172)]>0x0)for(let _0x460646=0x0;_0x460646<_0x588661['Operations'][_0x205e55(0x172)];_0x460646++){const _0xd6cbdf=_0x588661[_0x205e55(0x145)][_0x460646];if(_0xd6cbdf['op']==='remove'){if(_0xd6cbdf[_0x205e55(0x160)]){if(_0xd6cbdf['path']['startsWith'](_0x205e55(0x1b7))&&_0xd6cbdf['typeId'])_0x588661[_0x205e55(0x159)]='deleteUser';else _0xd6cbdf[_0x205e55(0x160)]===_0x205e55(0x12a)&&(_0x588661[_0x205e55(0x159)]='deleteUser');}}}}}}if(!_0x20103e){if(_0x588661[_0x205e55(0x159)]==='deleteUser'){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x168)+_0x579f72+_0x205e55(0x10b)),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+'\x20done'+_0x1a761a);return;}if(_0x51a98e[_0x205e55(0x11b)]&&_0x51a98e[_0x205e55(0x11b)]===!![]){_0x1b5b69['logger'][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x1aa)+_0x579f72+_0x205e55(0x167)),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}if(Object[_0x205e55(0x14b)][_0x205e55(0x166)][_0x205e55(0x190)](_0x5772f2,_0x205e55(0x1af))){if(typeof _0x5772f2['active']===_0x205e55(0x1b6)){const _0x322d28=_0x5772f2['active']['toLowerCase']();if(_0x322d28===_0x205e55(0x1a8))_0x5772f2['active']=!![];else{if(_0x322d28===_0x205e55(0x100))_0x5772f2[_0x205e55(0x1af)]=![];}}if(_0x5772f2[_0x205e55(0x1af)]===![]){_0x1b5b69[_0x205e55(0x170)]['debug'](_0x457fc8+_0x205e55(0x1aa)+_0x579f72+_0x205e55(0x1b5)),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}}_0x1b5b69[_0x205e55(0x170)]['debug'](_0x457fc8+_0x205e55(0x187)+_0x579f72);const _0x3fbea2=utils[_0x205e55(0x12f)](_0x5772f2);try{delete _0x3fbea2[_0x205e55(0x12a)];!_0x3fbea2[_0x205e55(0x193)]&&_0x51a98e[_0x205e55(0x131)]&&_0x51a98e[_0x205e55(0x131)]===!![]&&(_0x3fbea2[_0x205e55(0x193)]=utils[_0x205e55(0x191)](0xf));if(_0x18ded9||_0x5ddf26){if(_0x18ded9)for(const _0x50f86f in _0x18ded9){_0x3fbea2[_0x50f86f]=_0x18ded9[_0x50f86f];}if(_0x5ddf26)_0x3fbea2['id']=_0x5ddf26;await _0x2b8d29(_0x3fbea2);}await _0x1b5b69[_0x205e55(0x119)](_0xf45a2b,_0x3fbea2),_0x5772f2['groups']&&Array['isArray'](_0x5772f2[_0x205e55(0x12a)])&&_0x5772f2[_0x205e55(0x12a)][_0x205e55(0x172)]>0x0&&(_0x5991c3=await _0x41c8ed(_0x205e55(0xf5),_0x579f72));}catch(_0xe72b1){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](_0x457fc8+_0x205e55(0x123)+JSON[_0x205e55(0x13b)](_0x3fbea2)+_0x205e55(0xf9)+_0xe72b1[_0x205e55(0x1b4)]+'}'),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+'\x20done'+_0x1a761a);return;}}if(_0x20103e||_0x5991c3){if(_0x588661[_0x205e55(0x159)]==='deleteUser'){if(_0x51a98e[_0x205e55(0x11b)]&&_0x51a98e[_0x205e55(0x11b)]===!![]){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x13c)+_0x20103e+'\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true'),_0x1b5b69[_0x205e55(0x170)]['debug'](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}_0x1b5b69['logger']['debug'](_0x457fc8+_0x205e55(0x13c)+_0x20103e);try{await _0x1b5b69[_0x205e55(0x161)](_0xf45a2b,_0x20103e);}catch(_0x7d9e68){_0x1b5b69[_0x205e55(0x170)]['error'](_0x457fc8+'\x20Delete\x20User\x20id='+_0x20103e+_0x205e55(0xf9)+_0x7d9e68['message']+'}'),_0x1b5b69[_0x205e55(0x170)]['debug'](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}}else{if(_0x5991c3)_0x20103e=_0x5991c3;_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x13a)+_0x20103e);const _0x33ba9f={};_0x33ba9f[_0x205e55(0x179)]=()=>{},_0x33ba9f[_0x205e55(0x183)]={},_0x33ba9f['params'][_0x205e55(0x189)]=_0xf45a2b,_0x33ba9f[_0x205e55(0x183)]['id']=_0x20103e,_0x33ba9f['request']={},_0x33ba9f[_0x205e55(0x197)][_0x205e55(0x152)]=_0xf45a2b?'/'+_0xf45a2b+_0x205e55(0x136)+_0x20103e:_0x205e55(0x136)+_0x20103e,_0x33ba9f[_0x205e55(0x197)][_0x205e55(0x17f)]=_0x5772f2;try{await _0x1b5b69['replaceUsrGrp'](_0x33ba9f);}catch(_0x740dc8){_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](_0x457fc8+_0x205e55(0x13a)+_0x20103e+_0x205e55(0xf9)+_0x740dc8[_0x205e55(0x1b4)]),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}if(_0x33ba9f[_0x205e55(0x101)]&&(_0x33ba9f[_0x205e55(0x101)]<0xc8||_0x33ba9f['status']>0x12b)){if(_0x33ba9f['body']){if(_0x33ba9f[_0x205e55(0x17f)]['detail']){let _0x539b9d=_0x33ba9f[_0x205e55(0x17f)]['detail'];_0x539b9d=_0x539b9d[_0x205e55(0x1a5)](_0x1b5b69[_0x205e55(0x10f)]+'['+_0x1b5b69[_0x205e55(0x18f)]+']',''+_0x457fc8),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](''+_0x539b9d);}else{if(_0x33ba9f[_0x205e55(0x17f)]['Errors']&&Array[_0x205e55(0x141)](_0x33ba9f[_0x205e55(0x17f)][_0x205e55(0x1ad)])&&_0x33ba9f[_0x205e55(0x17f)][_0x205e55(0x1ad)][_0x205e55(0x172)]>0x0){let _0x2232d2=_0x33ba9f[_0x205e55(0x17f)]['Errors'][0x0][_0x205e55(0x138)];_0x2232d2=_0x2232d2[_0x205e55(0x1a5)](_0x1b5b69[_0x205e55(0x10f)]+'['+_0x1b5b69['pluginName']+']',''+_0x457fc8),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x188)](''+_0x2232d2);}}}}if(_0x51a98e['usePutSoftSync']){const [_0x1beee7,_0x2adddd]=_0x1b5b69['convertedScim20']({'Operations':_0x588661[_0x205e55(0x145)]});if(_0x2adddd){_0x1b5b69[_0x205e55(0x170)]['error'](_0x457fc8+'\x20Replace\x20User\x20id='+_0x20103e+'\x20convertedScim20\x20error:\x20'+_0x2adddd[_0x205e55(0x1b4)]),_0x1b5b69[_0x205e55(0x170)][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);return;}const _0x1c99d0=[];if(_0x1beee7['roles']&&Array[_0x205e55(0x141)](_0x1beee7[_0x205e55(0x1b7)]))for(let _0x58cdb3=0x0;_0x58cdb3<_0x1beee7[_0x205e55(0x1b7)][_0x205e55(0x172)];_0x58cdb3++){_0x1beee7[_0x205e55(0x1b7)][_0x58cdb3]['operation']&&_0x1beee7[_0x205e55(0x1b7)][_0x58cdb3][_0x205e55(0x12b)]===_0x205e55(0x11f)&&_0x1c99d0[_0x205e55(0x176)](_0x1beee7[_0x205e55(0x1b7)][_0x58cdb3]);}if(_0x1c99d0['length']>0x0)try{await _0x1b5b69['modifyUser'](_0xf45a2b,_0x20103e,{'roles':_0x1c99d0});}catch(_0x4d73f2){_0x1b5b69[_0x205e55(0x170)]['error'](_0x457fc8+_0x205e55(0x13a)+_0x20103e+_0x205e55(0x143)+_0x4d73f2[_0x205e55(0x1b4)]);}const _0x710ecf=[];if(_0x1beee7[_0x205e55(0x12a)]&&Array['isArray'](_0x1beee7[_0x205e55(0x12a)]))for(let _0x48e928=0x0;_0x48e928<_0x1beee7[_0x205e55(0x12a)]['length'];_0x48e928++){_0x1beee7[_0x205e55(0x12a)][_0x48e928][_0x205e55(0x12b)]&&_0x1beee7[_0x205e55(0x12a)][_0x48e928][_0x205e55(0x12b)]===_0x205e55(0x11f)&&_0x710ecf[_0x205e55(0x176)](_0x1beee7[_0x205e55(0x12a)][_0x48e928]);}if(_0x710ecf[_0x205e55(0x172)]>0x0)for(let _0x28651d=0x0;_0x28651d<_0x710ecf['length'];_0x28651d++){try{await _0x1b5b69[_0x205e55(0x196)](_0xf45a2b,_0x710ecf[_0x28651d]['id'],{'members':[{'operation':_0x205e55(0x11f),'value':_0x20103e}]});}catch(_0x4948cb){_0x1b5b69['logger'][_0x205e55(0x188)](_0x457fc8+'\x20Replace\x20User\x20id='+_0x20103e+_0x205e55(0x15c)+_0x4948cb['message']);}}}}}_0x1b5b69['logger'][_0x205e55(0x132)](_0x457fc8+_0x205e55(0x17b)+_0x1a761a);}catch(_0x250e68){_0x1b5b69[_0x205e55(0x170)]['error'](_0x1b5b69[_0x205e55(0x10f)]+'['+_0x1b5b69[_0x205e55(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+']\x20error:\x20'+_0x250e68['message']+_0x205e55(0x1ba)+_0x1a761a);}},_0x8f9f70=nats[_0x714335(0x162)](),_0x1f060c=_0x496767[_0x714335(0x12c)](),_0x43bdeb=('durable_'+_0x1b5b69[_0x714335(0x18f)]+'_'+_0xf45a2b)[_0x714335(0x139)]('*','#')[_0x714335(0x139)]('>','##')[_0x714335(0x139)]('.','_');let _0x28fbc8;const _0x163836=async()=>{const _0x1ba13f=_0x714335;try{const _0x874ea=''+_0x51a98e[_0x1ba13f(0xf6)]['tenant'],_0x142ec9=await _0x496767[_0x1ba13f(0x1a0)](),_0x41a175=async()=>{const _0x2a362f=_0x1ba13f;let _0x41a21c;try{_0x41a21c=await _0x1f060c[_0x2a362f(0x185)]['get'](_0x874ea,_0x43bdeb);}catch(_0x34b801){await _0x142ec9['consumers']['add'](_0x874ea,{'durable_name':_0x43bdeb,'ack_policy':nats[_0x2a362f(0x19c)][_0x2a362f(0x1ac)],'deliver_policy':nats['DeliverPolicy'][_0x2a362f(0x18d)],'deliver_group':_0x51a98e?.['nats']?.[_0x2a362f(0x1b9)]||null,'filter_subject':_0xbf5b23}),_0x41a21c=await _0x1f060c[_0x2a362f(0x185)][_0x2a362f(0x108)](_0x874ea,_0x43bdeb);}(_0xbf5b23!==_0x41a21c?.[_0x2a362f(0x117)]?.['config']?.[_0x2a362f(0x107)]||_0x51a98e?.[_0x2a362f(0xf6)]?.[_0x2a362f(0x1b9)]!==_0x41a21c?.[_0x2a362f(0x117)]?.[_0x2a362f(0x125)]?.[_0x2a362f(0x1bf)])&&(await _0x142ec9[_0x2a362f(0x185)][_0x2a362f(0x142)](_0x874ea,_0x43bdeb,{'deliver_group':_0x51a98e?.['nats']?.['queueGroup']||null,'filter_subject':_0xbf5b23}),_0x41a21c=await _0x1f060c[_0x2a362f(0x185)]['get'](_0x874ea,_0x43bdeb)),_0x28fbc8=await _0x41a21c[_0x2a362f(0x148)]({'max_messages':0x64});};await _0x41a175();const _0x271ca6=async()=>{const _0x4247a5=_0x1ba13f;for await(const _0x3e80e5 of await _0x28fbc8[_0x4247a5(0x101)]()){switch(_0x3e80e5['type']){case nats['ConsumerEvents']['ConsumerNotFound']:if(_0x3e80e5[_0x4247a5(0x169)]===0x1)_0x1b5b69[_0x4247a5(0x170)][_0x4247a5(0x135)](_0x1b5b69[_0x4247a5(0x10f)]+'['+_0x1b5b69[_0x4247a5(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+_0x4247a5(0x15f)+_0x3e80e5[_0x4247a5(0xfd)]),_0x41a175();else _0x3e80e5[_0x4247a5(0x169)]%0xa===0x0&&_0x1b5b69['logger'][_0x4247a5(0x188)](_0x1b5b69[_0x4247a5(0x10f)]+'['+_0x1b5b69[_0x4247a5(0x18f)]+_0x4247a5(0x15a)+_0xf45a2b+']['+_0xbf5b23+']\x20client\x20consumer\x20error:\x20'+_0x3e80e5[_0x4247a5(0xfd)]+_0x4247a5(0x181)+_0x3e80e5['data']);break;}}};_0x271ca6();for await(const _0x159352 of _0x28fbc8){if(!_0x159352[_0x1ba13f(0x17d)]||!_0x159352[_0x1ba13f(0x17d)][_0x1ba13f(0x108)](_0x1ba13f(0x18a))){_0x159352[_0x1ba13f(0x126)]();continue;}const _0x1d5cb3=_0x1b5b69[_0x1ba13f(0x10f)]+'['+_0x1b5b69[_0x1ba13f(0x18f)]+_0x1ba13f(0x15a)+_0xf45a2b+']['+_0x159352[_0x1ba13f(0x147)]+']['+_0x28fbc8['getProcessed']()+']['+(_0x159352[_0x1ba13f(0x17d)]?_0x159352['headers'][_0x1ba13f(0x108)]('Msg-Id'):'')+']',_0x3a8c7b=_0x8f9f70[_0x1ba13f(0x1b0)](_0x159352[_0x1ba13f(0x169)]);await _0x1fa7c2(_0x1d5cb3,_0x3a8c7b),_0x159352[_0x1ba13f(0x126)]();}}catch(_0x388062){_0x1b5b69[_0x1ba13f(0x170)][_0x1ba13f(0x188)](_0x1b5b69['gwName']+'['+_0x1b5b69['pluginName']+_0x1ba13f(0x15a)+_0xf45a2b+']['+_0xbf5b23+']\x20subscriber\x20stopped\x20error:\x20'+_0x388062['message']);}};_0x163836();const _0x16ee92=async()=>{const _0x2504f1=_0x714335;let _0x2e6e59=0x0;for await(const _0x632557 of _0x496767[_0x2504f1(0x101)]()){switch(_0x632557[_0x2504f1(0xfd)]){case nats['Events'][_0x2504f1(0x14a)]:_0x1b5b69[_0x2504f1(0x170)][_0x2504f1(0x188)](_0x1b5b69[_0x2504f1(0x10f)]+'['+_0x1b5b69['pluginName']+_0x2504f1(0x15a)+_0xf45a2b+']['+_0xbf5b23+']\x20client\x20disconnected\x20'+_0x632557['data']+'\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available'),_0x2e6e59=0x0;break;case nats[_0x2504f1(0x15e)]['Reconnect']:_0x1b5b69[_0x2504f1(0x170)][_0x2504f1(0x135)](_0x1b5b69[_0x2504f1(0x10f)]+'['+_0x1b5b69[_0x2504f1(0x18f)]+_0x2504f1(0x15a)+_0xf45a2b+']['+_0xbf5b23+_0x2504f1(0x1a9)+_0x632557[_0x2504f1(0x169)]);try{if(_0x28fbc8[_0x2504f1(0x127)])await _0x28fbc8[_0x2504f1(0x127)]();}catch(_0x2c773e){if(_0x28fbc8[_0x2504f1(0x1bc)])_0x28fbc8[_0x2504f1(0x1bc)]();}break;case nats['Events']['Error']:_0x1b5b69['logger']['error'](_0x1b5b69[_0x2504f1(0x10f)]+'['+_0x1b5b69[_0x2504f1(0x18f)]+_0x2504f1(0x15a)+_0xf45a2b+']['+_0xbf5b23+_0x2504f1(0x17e)+_0x632557[_0x2504f1(0x169)]);break;case nats['DebugEvents']['Reconnecting']:_0x2e6e59+=0x1;_0x2e6e59%0x1e===0x0&&_0x1b5b69[_0x2504f1(0x170)][_0x2504f1(0x132)](_0x1b5b69['gwName']+'['+_0x1b5b69[_0x2504f1(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+_0x2504f1(0x11e)+_0x632557[_0x2504f1(0x169)]+'\x20(count='+_0x2e6e59+')');break;case nats[_0x2504f1(0x118)][_0x2504f1(0x14e)]:_0x1b5b69[_0x2504f1(0x170)]['debug'](_0x1b5b69[_0x2504f1(0x10f)]+'['+_0x1b5b69[_0x2504f1(0x18f)]+']\x20subscriber['+_0xf45a2b+']['+_0xbf5b23+_0x2504f1(0x18c)+_0x632557[_0x2504f1(0x169)]);break;}}};_0x16ee92(),process['on']('SIGTERM',async()=>{const _0x2d097c=_0x714335;_0x496767&&await _0x496767[_0x2d097c(0x114)]();}),process['on'](_0x714335(0x174),async()=>{const _0x3c0a14=_0x714335;_0x496767&&await _0x496767[_0x3c0a14(0x114)]();});};const _0x41c8ed=async(_0x38edb6,_0x341584)=>{const _0x260d58=_0xbbad37,_0x450738={'attribute':_0x38edb6,'operator':'eq','value':_0x341584,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0xf69688=[_0x38edb6];if(_0x38edb6!=='id')_0xf69688[_0x260d58(0x176)]('id');try{const _0x50e550=await _0x1b5b69[_0x260d58(0x192)](_0xf45a2b,_0x450738,_0xf69688);if(!_0x50e550||!_0x50e550[_0x260d58(0x1a3)]||!Array[_0x260d58(0x141)](_0x50e550[_0x260d58(0x1a3)]))throw new Error(_0x260d58(0x149)+JSON[_0x260d58(0x13b)](_0x450738)+_0x260d58(0x1c0));if(_0x50e550[_0x260d58(0x1a3)][_0x260d58(0x172)]===0x0)return null;else{if(_0x50e550[_0x260d58(0x1a3)]['length']>0x2)throw new Error(_0x260d58(0x149)+JSON['stringify'](_0x450738)+_0x260d58(0x186));else{const _0xbb55d8=_0x50e550[_0x260d58(0x1a3)][0x0];if(!_0xbb55d8['id'])throw new Error(_0x260d58(0x149)+JSON['stringify'](_0x450738)+_0x260d58(0xf7)+JSON[_0x260d58(0x13b)](_0xbb55d8)+_0x260d58(0x134));return decodeURIComponent(_0xbb55d8['id']);}}}catch(_0x596add){throw new Error(_0x260d58(0x149)+JSON[_0x260d58(0x13b)](_0x450738)+_0x260d58(0xf9)+_0x596add['message']+'}');}},_0xc86e53=_0x37a0c1=>{const _0x51c5bb=_0xbbad37;if(!_0x37a0c1||typeof _0x37a0c1!==_0x51c5bb(0x1b6))return[null,null];_0x37a0c1=_0x37a0c1[_0x51c5bb(0xf8)]();const _0x5508e9=_0x37a0c1[_0x51c5bb(0x121)]('(');if(_0x5508e9<0x1)return[null,null];if(_0x37a0c1[_0x51c5bb(0x16d)](_0x37a0c1['length']-0x1)!==')')return[null,null];if(_0x58509e(_0x37a0c1,'(')!==_0x58509e(_0x37a0c1,')'))return[null,null];const _0x45ce57=_0x37a0c1[_0x51c5bb(0x16d)](0x0,_0x5508e9),_0x5c28aa=_0x37a0c1[_0x51c5bb(0x16d)](_0x5508e9+0x1,_0x37a0c1[_0x51c5bb(0x172)]-0x1);let _0x363710=[];const _0x1e4037=_0x5c28aa[_0x51c5bb(0xff)](',');let _0x386956='';for(let _0x4bec25=0x0;_0x4bec25<_0x1e4037[_0x51c5bb(0x172)];_0x4bec25++){const _0xa9de1f=_0x386956?_0x386956+','+_0x1e4037[_0x4bec25]:_0x1e4037[_0x4bec25],_0x563eb9=_0x58509e(_0xa9de1f,'('),_0x386037=_0x58509e(_0xa9de1f,')');if(_0x563eb9===_0x386037)_0x363710[_0x51c5bb(0x176)](_0x41cb8f(_0xa9de1f,'\x22')),_0x386956='';else{if(_0x386956)_0x386956+=','+_0x1e4037[_0x4bec25];else _0x386956+=_0x1e4037[_0x4bec25];}}if(_0x363710[_0x51c5bb(0x172)]===0x0)_0x363710=null;return[_0x45ce57,_0x363710];};function _0x58509e(_0x544d4d,_0x250097){const _0x53b31f=_0xbbad37;let _0x412704=0x0;for(let _0x43d2c9=0x0;_0x43d2c9<_0x544d4d[_0x53b31f(0x172)];_0x43d2c9++){_0x544d4d['charAt'](_0x43d2c9)===_0x250097&&(_0x412704+=0x1);}return _0x412704;}const _0x41cb8f=(_0x4e8cb6,_0x2d3bf0)=>{const _0x1e0401=_0xbbad37;if(typeof _0x4e8cb6!==_0x1e0401(0x1b6)||typeof _0x2d3bf0!==_0x1e0401(0x1b6))return _0x4e8cb6;if(_0x4e8cb6['length']===0x1)return _0x4e8cb6;if(_0x2d3bf0[_0x1e0401(0x172)]!==0x1)return _0x4e8cb6;return _0x4e8cb6=_0x4e8cb6[_0x1e0401(0xf8)](),_0x4e8cb6[_0x1e0401(0x16d)](0x0,0x1)===_0x2d3bf0&&(_0x4e8cb6=_0x4e8cb6[_0x1e0401(0x16d)](0x1)),_0x4e8cb6[_0x1e0401(0x16d)](_0x4e8cb6['length']-0x1)===_0x2d3bf0&&(_0x4e8cb6=_0x4e8cb6['substring'](0x0,_0x4e8cb6[_0x1e0401(0x172)]-0x1)),_0x4e8cb6;},_0x4954c4=async(_0x21c4d1,_0x161bb9,_0x500bd3)=>{const _0x57bc7f=_0xbbad37;if(!_0x21c4d1||!_0x161bb9||!_0x500bd3)return null;const [_0xcc3fc9,_0x508a96]=_0xc86e53(_0x500bd3);if(!_0xcc3fc9||!_0x508a96){const _0x2d2f38=_0x500bd3['split']('(');if(_0x2d2f38[_0x57bc7f(0x172)]>0x1){const _0x5ec68b=[_0x57bc7f(0x165),_0x57bc7f(0x144),_0x57bc7f(0x137),'elementnumber',_0x57bc7f(0x14c),_0x57bc7f(0x1a5),_0x57bc7f(0x12e),_0x57bc7f(0x113),'getuniquevalue'],_0x10db09=_0x2d2f38[0x0]['toLowerCase']();if(_0x5ec68b[_0x57bc7f(0x163)](_0x10db09))return null;}return _0x500bd3;}for(let _0x4c02ba=0x0;_0x4c02ba<_0x508a96['length'];_0x4c02ba++){if(_0x508a96[_0x4c02ba][_0x57bc7f(0x16d)](0x0,0x1)==='['){const _0x1a583f=_0x508a96[_0x4c02ba][_0x57bc7f(0x121)](']');if(_0x1a583f<0x0)return null;const _0x3a5918=_0x508a96[_0x4c02ba]['substring'](0x1,_0x1a583f),_0x333e83=_0x3a5918[_0x57bc7f(0xff)]('.');let _0x121cf5;for(let _0x19b301=0x0;_0x19b301<_0x333e83[_0x57bc7f(0x172)];_0x19b301++){if(_0x19b301===0x0)_0x121cf5=_0x21c4d1[_0x333e83[_0x19b301]];else{if(!_0x121cf5)return null;_0x121cf5=_0x121cf5[_0x333e83[_0x19b301]];}}if(!_0x121cf5)return null;_0x508a96[_0x4c02ba]=_0x121cf5;}}for(let _0x206d0c=0x0;_0x206d0c<_0x508a96['length'];_0x206d0c++){const [_0x4b2cf6]=_0xc86e53(_0x508a96[_0x206d0c]);_0x4b2cf6&&(_0x508a96[_0x206d0c]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x508a96[_0x206d0c]));}if(_0x508a96[0x0]===null)return null;switch(_0xcc3fc9['toLowerCase']()){case _0x57bc7f(0x165):{if(_0x508a96[_0x57bc7f(0x172)]!==0x1)return null;const [_0x1c5e1a]=_0xc86e53(_0x508a96[0x0]);if(_0x1c5e1a)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x1c5e1a);if(_0x508a96[0x0]===null)return null;return _0x508a96[0x0]['toLowerCase']();}case _0x57bc7f(0x144):{if(_0x508a96['length']!==0x1)return null;const [_0x410306]=_0xc86e53(_0x508a96[0x0]);if(_0x410306)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x410306);if(_0x508a96[0x0]===null)return null;return _0x508a96[0x0][_0x57bc7f(0x13e)]();}case _0x57bc7f(0x137):{if(_0x508a96[_0x57bc7f(0x172)]!==0x2)return null;const [_0x1122f7]=_0xc86e53(_0x508a96[0x0]);if(_0x1122f7)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x1122f7);if(_0x508a96[0x0]===null)return null;if(isNaN(_0x508a96[0x1]))return null;return _0x508a96[0x0][_0x57bc7f(0x16d)](0x0,_0x508a96[0x1]);}case _0x57bc7f(0x19e):{const [_0x171fda]=_0xc86e53(_0x508a96[0x0]);if(_0x508a96['length']<0x2)return null;if(_0x171fda)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x171fda);if(_0x508a96[0x0]===null)return null;const _0x1580f0=_0x508a96[0x1];if(isNaN(_0x1580f0))return null;let _0x3e1639;if(_0x508a96[_0x57bc7f(0x172)]===0x3)_0x3e1639=_0x508a96[0x0][_0x57bc7f(0xff)](_0x508a96[0x2]);else _0x3e1639=_0x3e1639=_0x508a96[0x0][_0x57bc7f(0xff)]('\x20');if(_0x1580f0<=_0x3e1639[_0x57bc7f(0x172)])return _0x3e1639[_0x1580f0-0x1];else return'';}case _0x57bc7f(0x1a5):{const [_0x119ba5]=_0xc86e53(_0x508a96[0x0]);if(_0x119ba5)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x119ba5);if(_0x508a96[0x0]===null)return null;if(_0x508a96[_0x57bc7f(0x172)]!==0x3)return null;return _0x508a96[0x0]['replaceAll'](_0x508a96[0x1],_0x508a96[0x2]);}case _0x57bc7f(0x12e):{if(_0x508a96[_0x57bc7f(0x172)]!==0x1)return null;const [_0x483ece]=_0xc86e53(_0x508a96[0x0]);if(_0x483ece)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x483ece);if(_0x508a96[0x0]===null)return null;return ascii127[_0x57bc7f(0x156)](_0x508a96[0x0]);}case _0x57bc7f(0x14c):{let _0x3720b2='';for(let _0x4af84b=0x0;_0x4af84b<_0x508a96[_0x57bc7f(0x172)];_0x4af84b++){const [_0x1a6cc7]=_0xc86e53(_0x508a96[_0x4af84b]);if(_0x1a6cc7)_0x508a96[_0x4af84b]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x1a6cc7);if(_0x508a96[_0x4af84b]===null)return null;_0x3720b2+=_0x508a96[_0x4af84b];}return _0x3720b2;}case _0x57bc7f(0x113):{if(_0x508a96[_0x57bc7f(0x172)]>0x2)return null;const [_0x27e51b]=_0xc86e53(_0x508a96[0x0]);if(_0x27e51b)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x27e51b);if(_0x508a96[0x0]===null)return null;const _0x5264b6=parseInt(_0x508a96[0x0]);if(isNaN(_0x5264b6))return null;let _0x16903c=_0x57bc7f(0x110);_0x16903c+=','+_0x508a96[0x0];if(_0x508a96[_0x57bc7f(0x172)]===0x2&&_0x508a96[0x1][_0x57bc7f(0x1a2)]()==='true')_0x16903c+=_0x57bc7f(0x12d);else _0x16903c+=',false';return _0x16903c+='##',_0x16903c;}case _0x57bc7f(0x10d):{if(_0x508a96['length']!==0x1)return null;const [_0x519cfe]=_0xc86e53(_0x508a96[0x0]);if(_0x519cfe)_0x508a96[0x0]=await _0x4954c4(_0x21c4d1,_0x161bb9,_0x519cfe);if(_0x508a96[0x0]===null)return null;let _0x2df61a,_0x28f3ec=![],_0x3c29ba='';const _0x51f0e6=_0x508a96[0x0][_0x57bc7f(0xff)]('##');if(_0x51f0e6[_0x57bc7f(0x172)]>0x2)for(let _0x1e5d37=0x0;_0x1e5d37<_0x51f0e6['length'];_0x1e5d37++){if(_0x51f0e6[_0x1e5d37][_0x57bc7f(0x164)]('doIncrement')){const _0x25abb9=_0x51f0e6[_0x1e5d37][_0x57bc7f(0xff)](',');if(_0x25abb9[_0x57bc7f(0x172)]<0x2)return null;const _0x5180cb=parseInt(_0x25abb9[0x1]);if(isNaN(_0x5180cb))return null;_0x3c29ba='##'+_0x51f0e6[_0x1e5d37]+'##',_0x2df61a=_0x25abb9[0x1],_0x25abb9[_0x57bc7f(0x172)]>0x2&&(_0x28f3ec=_0x25abb9[0x2][_0x57bc7f(0x1a2)]()===_0x57bc7f(0x1a8));}}let _0x58c654,_0x6881dc=0x0,_0x3f1e13=0x0;if(_0x2df61a){_0x3f1e13=_0x2df61a[_0x57bc7f(0x172)],_0x6881dc=0xa;for(let _0x376afb=0x1;_0x376afb<_0x3f1e13;_0x376afb++){_0x6881dc*=0xa;}_0x6881dc-=0x1,_0x58c654=parseInt(_0x2df61a);if(isNaN(_0x58c654))return null;_0x58c654-=0x1;}else _0x58c654=0x0;do{_0x58c654+=0x1;let _0x54db33=_0x508a96[0x0];if(_0x2df61a!==undefined&&_0x3c29ba){let _0x5e2a2f=_0x58c654[_0x57bc7f(0x1a1)]();while(_0x5e2a2f[_0x57bc7f(0x172)]<_0x3f1e13){_0x5e2a2f='0'+_0x5e2a2f;}_0x28f3ec?_0x54db33=_0x54db33[_0x57bc7f(0x1a5)](_0x3c29ba,_0x5e2a2f):(_0x54db33=_0x54db33[_0x57bc7f(0x1a5)](_0x3c29ba,''),_0x28f3ec=!![],_0x58c654-=0x1);}try{const _0x1879d3=await _0x41c8ed(_0x161bb9,_0x54db33);if(!_0x1879d3)return _0x54db33;}catch(_0x3d00f0){return _0x1b5b69['logger'][_0x57bc7f(0x188)](_0x1b5b69[_0x57bc7f(0x10f)]+'['+_0x1b5b69[_0x57bc7f(0x18f)]+']\x20'+_0xcc3fc9+_0x57bc7f(0x155)+_0x3d00f0[_0x57bc7f(0x1b4)]),null;}}while(_0x58c654<_0x6881dc);return null;}default:}return null;},_0x2b8d29=async _0x194a4f=>{const _0x16e799=_0xbbad37;for(const _0xd1378f in _0x194a4f){const _0x47f63b=_0x194a4f[_0xd1378f],[_0x41f45a,_0x554434]=_0xc86e53(_0x47f63b);if(_0x41f45a){const _0x1889e0=''+_0xd1378f,_0x375176=_0x41f45a+'('+_0x554434[_0x16e799(0x14c)](',')+')',_0x25af4b=await _0x4954c4(_0x194a4f,_0x1889e0,_0x375176);if(_0x25af4b===null)delete _0x194a4f[_0xd1378f];else _0x194a4f[_0xd1378f]=_0x25af4b;}for(const _0x515c5b in _0x47f63b){const _0x18f4ef=_0x47f63b[_0x515c5b],[_0x2b839e,_0x1ac6c7]=_0xc86e53(_0x18f4ef);if(_0x2b839e){const _0xcdc2f9=_0xd1378f+'.'+_0x515c5b,_0x343017=_0x2b839e+'('+_0x1ac6c7['join'](',')+')',_0xd5d493=await _0x4954c4(_0x194a4f,_0xcdc2f9,_0x343017);if(_0xd5d493===null)delete _0x47f63b[_0x515c5b];else _0x47f63b[_0x515c5b]=_0xd5d493;}}}return _0x194a4f;};},module[a0_0x1411a2(0x18b)]['getAppRoles']=async(_0x269b83,_0x41cd39,_0x3c323b,_0xab541b)=>{const _0x39d4cb=a0_0x1411a2,_0x4c4302=_0x39d4cb(0x184),_0x50ef1d=_0x269b83;_0x50ef1d[_0x39d4cb(0x170)][_0x39d4cb(0x132)](_0x50ef1d[_0x39d4cb(0x10f)]+'['+_0x50ef1d[_0x39d4cb(0x18f)]+_0x39d4cb(0x1b1)+_0x4c4302+'\x22');try{if(!fs[_0x39d4cb(0x129)](_0x50ef1d[_0x39d4cb(0x105)]+_0x39d4cb(0x153)))fs[_0x39d4cb(0x16c)](_0x50ef1d['configDir']+_0x39d4cb(0x153));}catch(_0x627b){}const _0x449744=path['join'](''+_0x50ef1d[_0x39d4cb(0x105)],_0x39d4cb(0xfb),_0x39d4cb(0x116)+_0x50ef1d[_0x39d4cb(0x18f)]+'_autogenerated.cfg'),_0x503364={};utils[_0x39d4cb(0x10c)](_0x449744)&&fs['readFileSync'](_0x449744,_0x39d4cb(0x17c))['split'](/\r?\n/)[_0x39d4cb(0xfa)](_0x6cc593=>{const _0x1d031c=_0x39d4cb,_0xd73676=_0x6cc593[_0x1d031c(0xff)]('\x20');_0xd73676[_0x1d031c(0x172)]===0x2&&(_0x503364[_0xd73676[0x0]]=_0xd73676[0x1]);});const _0x3358f8=fs[_0x39d4cb(0x115)](_0x449744,{'flags':'w','encoding':'utf8','mode':0x1b6,'autoClose':!![]}),_0x2fac1c=[],_0x3d7d84=await _0x50ef1d['getGroups'](_0x41cd39,{'attribute':undefined,'operator':undefined,'value':undefined},['id',_0x39d4cb(0x16b)]);return _0x3d7d84[_0x39d4cb(0x1a3)][_0x39d4cb(0xfa)](_0x393f9a=>{const _0x883997=_0x39d4cb;if(_0x393f9a['id']){let _0x9fedaf=crypto[_0x883997(0x104)]();if(_0x503364[_0x393f9a['id']])_0x9fedaf=_0x503364[_0x393f9a['id']];const _0x3507f1={'allowedMemberTypes':[_0x883997(0x10e)],'description':'SCIM\x20Stream\x20-\x20Autogenerated','displayName':_0x393f9a['displayName']||_0x393f9a['id'],'id':_0x9fedaf,'isEnabled':!![],'lang':null,'origin':_0x883997(0x19d),'value':decodeURIComponent(_0x393f9a['id'])};_0x2fac1c[_0x883997(0x176)](_0x3507f1),_0x3358f8[_0x883997(0x13f)](_0x393f9a['id']+'\x20'+_0x9fedaf+'\x0a');}}),_0x3358f8['close'](),_0x50ef1d[_0x39d4cb(0x170)][_0x39d4cb(0x132)](_0x50ef1d[_0x39d4cb(0x10f)]+'['+_0x50ef1d[_0x39d4cb(0x18f)]+_0x39d4cb(0x1b2)+_0x449744),{'Resources':[{'appRoles':_0x2fac1c}]};};function a0_0x4879(){const _0x15416b=['\x20missing\x20user\x20object\x20in\x20message:\x20','pingInterval','modifyGroup','request',']\x20subscriber\x20error:\x20configuration\x20scim.usePutSoftSync\x20must\x20be\x20set\x20to\x20true','jwt','11fqtDHk','transports','AckPolicy','Application','elementnumber','servers','jetstreamManager','toString','toLowerCase','Resources','display','replace','6MQgCHF','maxPingOut','true',']\x20client\x20reconnected\x20','\x20Create\x20userName=','\x20should\x20have\x20syntax:\x20<collector>.<channel>','Explicit','Errors','onCreate','active','decode',']\x20handling\x20\x22',']\x20approle\x20uuid\x20file\x20created:\x20','usePutSoftSync','message','\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false','string','roles',']\x20connect\x20error:\x20','queueGroup','\x20=>\x20subscriber\x20not\x20activated','2phKdrN','unsubscribe','99Dzpzks','connect','deliver_group','\x20error:\x20missing\x20result','userName','nats','\x20result=','trim','\x20error:\x20','forEach','approles','subscribe','type','16eqgiys','split','false','status','../lib/utils','195200ONtCea','randomUUID','configDir','certificate','filter_subject','get','readFileSync','baseUrls','\x20message:\x20user\x20does\x20not\x20exist','fsExistsSync','getuniquevalue','User','gwName','##doIncrement','606980iBjpxJ','level','increment','drain','createWriteStream','approles_','_info','DebugEvents','createUser','2730260PzSmiM','modifyOnly','file','2588117ywbgdu',']\x20client\x20is\x20attempting\x20to\x20reconnect\x20','delete','name','indexOf',']\x20subscriber\x20certificate\x20error:\x20','\x20createUser()\x20obj=','encode','config','ack','consumerInfo','\x20-\x20','existsSync','groups','operation','jetstream',',true','normalize','copyObj','Subscriber','generateUserPassword','debug','\x20message:\x20','\x20error:\x20missing\x20id}','info','/Users/','firstn','description','replaceAll','\x20Replace\x20User\x20id=','stringify','\x20Delete\x20User\x20id=',']\x20error:\x20missing\x20one\x20or\x20more\x20mandatory\x20configurations\x20e.g.\x20stream.baseUrls,\x20stream.certificate.ca,\x20nats.tenant,\x20nats.subject,\x20nats.secret\x20and\x20nats.jwt','toUpperCase','write','waitOnFirstConnect','isArray','update','\x20role\x20removal\x20error:\x20','uppercase','Operations','replaceDomains','subject','consume','getUsers()\x20getObj=','Disconnect','prototype','join','crypto','StaleConnection','secret','closed','\x20roles\x20converted\x20to\x20groups\x20message:\x20','originalUrl','/approles','skipConvertRolesToGroups','\x20getUserId()\x20error:\x20','foldReplacing','getServer','tls','activityOperation',']\x20subscriber[','\x20handling\x20message:\x20','\x20group\x20removal\x20error:\x20','authenticator','Events',']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20','path','deleteUser','StringCodec','includes','startsWith','lowercase','hasOwnProperty','\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true','\x20Delete\x20User\x20userName=','data','fold-to-ascii','displayName','mkdirSync','substring',']\x20error:\x20subject\x20not\x20allowing\x20comma\x20separated\x20multiples','20623236AKvPBN','logger','from','length','value','SIGINT','1587606TEyRMd','push','parse',']\x20error:\x20client\x20have\x20not\x20been\x20initialized','set','then','\x20done','utf-8','headers',']\x20client\x20error\x20','body','schemas','\x20count=','deleteUserOnLastGroupRoleRemoval','params','getAppRoles','consumers','\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}','\x20Create\x20User\x20userName=','error','baseEntity','Msg-Id','exports',']\x20client\x20has\x20a\x20stale\x20connection\x20','New','488100qWTawF','pluginName','call','createRandomPassword','getUsers','password'];a0_0x4879=function(){return _0x15416b;};return a0_0x4879();}