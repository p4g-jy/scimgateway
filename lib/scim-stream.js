// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: SCIM Stream is a prerequisite for message subscription
//       for details see: https://elshaug.xyz/docs/scim-stream
//
// ================================================================
'use strict';function a0_0x5d24(_0x34e02f,_0x5e545f){const _0x5dd086=a0_0x5dd0();return a0_0x5d24=function(_0x5d24dd,_0x150eb7){_0x5d24dd=_0x5d24dd-0x1df;let _0x3df8e4=_0x5dd086[_0x5d24dd];return _0x3df8e4;},a0_0x5d24(_0x34e02f,_0x5e545f);}const a0_0x4938eb=a0_0x5d24;(function(_0x43e191,_0x19c8ff){const _0x280594=a0_0x5d24,_0x1a8494=_0x43e191();while(!![]){try{const _0x2c107f=parseInt(_0x280594(0x22b))/0x1+parseInt(_0x280594(0x29d))/0x2+parseInt(_0x280594(0x1f5))/0x3+-parseInt(_0x280594(0x294))/0x4*(-parseInt(_0x280594(0x260))/0x5)+-parseInt(_0x280594(0x23d))/0x6*(parseInt(_0x280594(0x272))/0x7)+-parseInt(_0x280594(0x1e3))/0x8*(-parseInt(_0x280594(0x287))/0x9)+-parseInt(_0x280594(0x1fb))/0xa;if(_0x2c107f===_0x19c8ff)break;else _0x1a8494['push'](_0x1a8494['shift']());}catch(_0x235f9c){_0x1a8494['push'](_0x1a8494['shift']());}}}(a0_0x5dd0,0x34b1f));function a0_0x5dd0(){const _0x4264c9=['indexOf','getProcessed','\x20createUser()\x20obj=','approles_','modifyUser','getAppRoles','\x20error:\x20missing\x20result','transports','secret',']\x20error:\x20subject\x20',']\x20error:\x20subject\x20not\x20allowing\x20comma\x20separated\x20multiples',']\x20client\x20error\x20','info','substring','getuniquevalue','convertedScim20','Reconnecting','createWriteStream','Application','\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}','logger','write','ConsumerNotFound','waitOnFirstConnect','includes','displayName','toString','5XrxlLf','maxReconnectAttempts','unsubscribe','remove',']\x20error:\x20client\x20have\x20not\x20been\x20initialized','baseEntity','\x20Replace\x20User\x20id=','nats','increment','params','get','\x20Delete\x20User\x20id=','roles','DebugEvents',']\x20approle\x20uuid\x20file\x20created:\x20','deliver_group','##doIncrement','usePutSoftSync','16730hLampn','New','Errors','groups','update','trim','deleteUser','getServer','originalUrl','active','jwt','\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available','SIGTERM','prototype','length','durable_','subscribe','pluginName','config','createUser',']\x20subscriber\x20error:\x20missing\x20certificate\x20configuration','3474ieESwK','join','from','closed','DeliverPolicy','replace','ack','data','value','split','message','configDir','\x20Create\x20User\x20userName=','543908ktHKjD','operation','request',',true','\x20roles\x20converted\x20to\x20groups:\x20','jetstreamManager',']\x20connect\x20error:\x20','modifyOnly','\x20-\x20','787014dnyiXr','name','forEach','utf-8','replaceAll','baseUrls','charAt','display','push',']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20',']\x20subscriber[',']\x20error:\x20missing\x20one\x20or\x20more\x20mandatory\x20configurations\x20e.g.\x20stream.baseUrls,\x20stream.certificate.ca,\x20nats.tenant,\x20nats.subject,\x20nats.secret\x20and\x20nats.jwt','Subscriber','false','elementnumber','certificate',']\x20client\x20reconnected\x20','_autogenerated.cfg','deleteUserOnLastGroupRoleRemoval',']\x20client\x20disconnected\x20','typeId','Reconnect','filter_subject',',false','utf8','1624VTFxVj','drain','generateUserPassword','getUsers','decode','true','\x20done','/approles','createRandomPassword','getGroups','userName','\x20convertedScim20\x20error:\x20',']\x20handling\x20\x22','replaceDomains','\x20error:\x20','\x20missing\x20user\x20object\x20in\x20message:\x20','close',']\x20subscriber\x20certificate\x20error:\x20','807117KecqOE','Operations',']\x20subscriber\x20stopped\x20error:\x20','lowercase','headers','tls','6294010GRaYgG','delete','tenant','startsWith','body','StaleConnection','foldReplacing','firstn',']\x20subscriber\x20error:\x20configuration\x20scim.usePutSoftSync\x20must\x20be\x20set\x20to\x20true','modifyGroup','error','\x20error:\x20missing\x20id}','randomUUID','encode','Events',']\x20client\x20consumer\x20error:\x20','fsExistsSync','password','uppercase','_info','Msg-Id','../lib/utils','toUpperCase','consume','AckPolicy','\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20','reconnectTimeWait','/certs/','type','path','reconnect','skipConvertRolesToGroups','\x20=>\x20subscriber\x20not\x20activated','readFileSync','\x20getUserId()\x20error:\x20','\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration','toLowerCase','copyObj','\x20message:\x20user\x20does\x20not\x20exist',']\x20connected\x20','\x20result=','isArray','string',']\x20client\x20has\x20a\x20stale\x20connection\x20','servers','\x20(count=','getUsers()\x20getObj=','status','381829pQemJE','\x20group\x20removal\x20error:\x20','consumers','\x20Create\x20userName=','gwName','exports','add','SIGINT','user','normalize','onCreate','Resources','set','jetstream','StringCodec','\x20should\x20have\x20syntax:\x20<collector>.<channel>','stringify','detail','1038elVXHy','connect','activityOperation','debug','schemas','consumerInfo','crypto',']\x20closed\x20with\x20error:\x20'];a0_0x5dd0=function(){return _0x4264c9;};return a0_0x5dd0();}const nats=require(a0_0x4938eb(0x267)),ascii127=require('fold-to-ascii'),fs=require('fs'),utils=require(a0_0x4938eb(0x210)),path=require(a0_0x4938eb(0x218)),crypto=require(a0_0x4938eb(0x243));module[a0_0x4938eb(0x230)][a0_0x4938eb(0x2a9)]=function(_0x265ac2,_0x3d2e4a,_0x4f5872,_0x32981d){const _0x5e4129=a0_0x4938eb,_0x31290f=_0x265ac2,_0x24a4cf=_0x3d2e4a,_0x51705e=_0x4f5872,_0x258328=_0x32981d;if(!_0x24a4cf[_0x5e4129(0x2ac)]||!_0x24a4cf['certificate']['ca']){_0x31290f[_0x5e4129(0x259)]['error'](_0x31290f[_0x5e4129(0x22f)]+'['+_0x31290f[_0x5e4129(0x283)]+_0x5e4129(0x286));return;}if(!_0x24a4cf[_0x5e4129(0x271)]){_0x31290f[_0x5e4129(0x259)][_0x5e4129(0x205)](_0x31290f[_0x5e4129(0x22f)]+'['+_0x31290f[_0x5e4129(0x283)]+_0x5e4129(0x203));return;}let _0xed36c7='';for(let _0x12e63a=0x0;_0x12e63a<_0x31290f[_0x5e4129(0x259)][_0x5e4129(0x24c)][_0x5e4129(0x280)];_0x12e63a++){if(_0x31290f[_0x5e4129(0x259)][_0x5e4129(0x24c)][_0x12e63a][_0x5e4129(0x29e)]==='file'){_0xed36c7=_0x31290f[_0x5e4129(0x259)][_0x5e4129(0x24c)][_0x12e63a]['level'];break;}}const _0x429c50=''+(_0xed36c7===_0x5e4129(0x240)?'\x0a':''),_0x1b72fe={};try{_0x1b72fe['ca']=[fs[_0x5e4129(0x21c)](_0x31290f[_0x5e4129(0x292)]+_0x5e4129(0x216)+_0x24a4cf[_0x5e4129(0x2ac)]['ca'])];}catch(_0x5d7181){_0x31290f[_0x5e4129(0x259)]['error'](_0x31290f['gwName']+'['+_0x31290f[_0x5e4129(0x283)]+_0x5e4129(0x1f4)+_0x5d7181[_0x5e4129(0x291)]);return;}const _0x5af871={},_0x361a53=new TextEncoder()[_0x5e4129(0x208)](_0x24a4cf['nats'][_0x5e4129(0x24d)]),_0x35a9dc=_0x24a4cf['nats'][_0x5e4129(0x27c)];_0x5af871['authenticator']=nats['jwtAuthenticator'](_0x35a9dc,_0x361a53),_0x5af871[_0x5e4129(0x227)]=_0x24a4cf[_0x5e4129(0x2a2)],_0x5af871['tls']=_0x1b72fe,_0x5af871[_0x5e4129(0x25c)]=![],_0x5af871[_0x5e4129(0x219)]=!![],_0x5af871[_0x5e4129(0x215)]=0x3e8*0xa,_0x5af871[_0x5e4129(0x261)]=-0x1,_0x5af871['pingInterval']=0x2*0x3c*0x3e8,_0x5af871['maxPingOut']=0x5,_0x5af871['debug']=![];let _0x1266da;this['connect']=async()=>{const _0x1f89d5=_0x5e4129;try{_0x1266da=await nats[_0x1f89d5(0x23e)](_0x5af871);}catch(_0x263728){_0x31290f['logger']['error'](_0x31290f[_0x1f89d5(0x22f)]+'['+_0x31290f['pluginName']+_0x1f89d5(0x2a7)+_0x51705e+']['+_0x258328+_0x1f89d5(0x29a)+_0x263728[_0x1f89d5(0x291)]+_0x1f89d5(0x21e)),_0x5af871[_0x1f89d5(0x25c)]=!![];try{_0x1266da=await nats[_0x1f89d5(0x23e)](_0x5af871);}catch(_0x4f0fab){_0x31290f[_0x1f89d5(0x259)]['error'](_0x31290f[_0x1f89d5(0x22f)]+'['+_0x31290f['pluginName']+_0x1f89d5(0x2a7)+_0x51705e+']['+_0x258328+_0x1f89d5(0x29a)+_0x4f0fab['message']);return;}}_0x31290f[_0x1f89d5(0x259)][_0x1f89d5(0x251)](_0x31290f[_0x1f89d5(0x22f)]+'['+_0x31290f[_0x1f89d5(0x283)]+']\x20subscriber['+_0x51705e+']['+_0x258328+_0x1f89d5(0x222)+(_0x5af871[_0x1f89d5(0x1fa)]['ca']?'tls':'')+'\x20'+_0x1266da[_0x1f89d5(0x279)]()),_0x1266da[_0x1f89d5(0x28a)]()['then'](_0x55b93e=>{const _0x1c08b1=_0x1f89d5;_0x55b93e&&_0x31290f[_0x1c08b1(0x259)][_0x1c08b1(0x205)](_0x31290f[_0x1c08b1(0x22f)]+'['+_0x31290f[_0x1c08b1(0x283)]+_0x1c08b1(0x2a7)+_0x51705e+']['+_0x258328+_0x1c08b1(0x244)+_0x55b93e[_0x1c08b1(0x291)]);});},this[_0x5e4129(0x282)]=async()=>{const _0x20cb03=_0x5e4129;if(!_0x258328||!_0x24a4cf['baseUrls']||!_0x24a4cf[_0x20cb03(0x2ac)]||!_0x24a4cf['certificate']['ca']||!_0x24a4cf[_0x20cb03(0x267)]||!_0x24a4cf[_0x20cb03(0x267)][_0x20cb03(0x1fd)]||!_0x24a4cf[_0x20cb03(0x267)][_0x20cb03(0x24d)]||!_0x24a4cf[_0x20cb03(0x267)][_0x20cb03(0x27c)]){_0x31290f['logger'][_0x20cb03(0x205)](_0x31290f[_0x20cb03(0x22f)]+'['+_0x31290f['pluginName']+_0x20cb03(0x2a7)+_0x51705e+']['+_0x258328+_0x20cb03(0x2a8));return;}if(_0x258328[_0x20cb03(0x290)]('.')['length']<0x2){_0x31290f[_0x20cb03(0x259)][_0x20cb03(0x205)](_0x31290f[_0x20cb03(0x22f)]+'['+_0x31290f[_0x20cb03(0x283)]+_0x20cb03(0x2a7)+_0x51705e+']['+_0x258328+_0x20cb03(0x24e)+_0x258328+_0x20cb03(0x23a));return;}if(_0x258328[_0x20cb03(0x25d)](',')){_0x31290f[_0x20cb03(0x259)][_0x20cb03(0x205)](_0x31290f[_0x20cb03(0x22f)]+'['+_0x31290f[_0x20cb03(0x283)]+_0x20cb03(0x2a7)+_0x51705e+']['+_0x258328+_0x20cb03(0x24f));return;}if(!_0x1266da){_0x31290f[_0x20cb03(0x259)][_0x20cb03(0x205)](_0x31290f[_0x20cb03(0x22f)]+'['+_0x31290f['pluginName']+_0x20cb03(0x2a7)+_0x51705e+']['+_0x258328+_0x20cb03(0x264));return;}const _0x4f4f80=async(_0x4efcda,_0x3b0b8d)=>{const _0xf88169=_0x20cb03;try{_0x31290f[_0xf88169(0x259)]['info'](_0x4efcda+'\x20handling\x20message:\x20'+_0x3b0b8d);let _0x33ed57;try{if(_0x24a4cf[_0xf88169(0x1f0)]&&Array[_0xf88169(0x224)](_0x24a4cf[_0xf88169(0x1f0)]))for(let _0x451988=0x0;_0x451988<_0x24a4cf[_0xf88169(0x1f0)]['length'];_0x451988++){const _0x4dced2=_0x24a4cf[_0xf88169(0x1f0)][_0x451988];if(!_0x4dced2[_0xf88169(0x289)]||!_0x4dced2[_0xf88169(0x289)][_0xf88169(0x25d)]('.')||!_0x4dced2['to']||!_0x4dced2['to'][_0xf88169(0x25d)]('.'))continue;const _0xc572b4=new RegExp('@'+_0x4dced2['from']+'\x22','gi');_0x3b0b8d=_0x3b0b8d[_0xf88169(0x28c)](_0xc572b4,'@'+_0x4dced2['to']+'\x22');}_0x33ed57=JSON['parse'](_0x3b0b8d);}catch(_0x57eee){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+'\x20message\x20json\x20parsing\x20error:\x20'+_0x57eee['message']+'\x20message:\x20'+_0x3b0b8d),_0x31290f[_0xf88169(0x259)]['debug'](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}const _0x1e1f47=_0x33ed57[_0xf88169(0x233)];if(!_0x1e1f47){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x1f2)+JSON[_0xf88169(0x23b)](_0x33ed57)),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}if(!_0x1e1f47['userName']){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x214)+JSON['stringify'](_0x33ed57)),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+'\x20done'+_0x429c50);return;}delete _0x1e1f47[_0xf88169(0x241)];let _0x507f88;_0x1e1f47['id']&&(_0x507f88=_0x1e1f47['id'],delete _0x1e1f47['id']);let _0x3375ab;_0x1e1f47[_0xf88169(0x235)]&&(_0x3375ab=utils[_0xf88169(0x220)](_0x1e1f47[_0xf88169(0x235)]),delete _0x1e1f47['onCreate']);await _0x51aadb(_0x1e1f47);const _0x4dcfe9=_0x1e1f47[_0xf88169(0x1ed)];let _0x26747f,_0x52508f;try{_0x26747f=await _0x232e97(_0xf88169(0x1ed),_0x4dcfe9);}catch(_0x14c5fd){_0x31290f['logger'][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x21d)+_0x14c5fd['message']),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}if(!_0x24a4cf[_0xf88169(0x21a)]){let _0x1557a5=![];if(_0x33ed57[_0xf88169(0x1f6)]&&Array[_0xf88169(0x224)](_0x33ed57[_0xf88169(0x1f6)]))for(let _0x141f3b=0x0;_0x141f3b<_0x33ed57[_0xf88169(0x1f6)]['length'];_0x141f3b++){const _0x56d25a=_0x33ed57[_0xf88169(0x1f6)][_0x141f3b];_0x56d25a[_0xf88169(0x218)]['startsWith']('roles')&&(_0x56d25a[_0xf88169(0x218)]=_0xf88169(0x275),Array[_0xf88169(0x224)](_0x56d25a[_0xf88169(0x28f)])?(_0x56d25a['value'][0x0]['id']=_0x56d25a['value'][0x0][_0xf88169(0x28f)],_0x56d25a[_0xf88169(0x28f)][0x0][_0xf88169(0x2a4)]=_0x56d25a[_0xf88169(0x28f)][0x0]['type']+_0xf88169(0x29c)+_0x56d25a['value'][0x0][_0xf88169(0x28f)],delete _0x56d25a[_0xf88169(0x28f)][0x0][_0xf88169(0x28f)],delete _0x56d25a[_0xf88169(0x28f)][0x0][_0xf88169(0x217)]):_0x56d25a[_0xf88169(0x28f)]=[{'id':_0x56d25a[_0xf88169(0x28f)],'display':_0x56d25a[_0xf88169(0x28f)]}],delete _0x56d25a['typeId'],_0x1557a5=!![]);}if(_0x1e1f47[_0xf88169(0x26c)]&&Array[_0xf88169(0x224)](_0x1e1f47['roles'])&&_0x1e1f47[_0xf88169(0x26c)]['length']>0x0){if(!_0x1e1f47[_0xf88169(0x275)])_0x1e1f47[_0xf88169(0x275)]=[];if(!Array[_0xf88169(0x224)](_0x1e1f47[_0xf88169(0x275)]))_0x1e1f47[_0xf88169(0x275)]=[];for(let _0x141def=0x0;_0x141def<_0x1e1f47['roles'][_0xf88169(0x280)];_0x141def++){const _0x4ad06e={},_0x4a7747=_0x1e1f47[_0xf88169(0x26c)][_0x141def];_0x4ad06e[_0xf88169(0x28f)]=_0x4a7747[_0xf88169(0x28f)],_0x4ad06e['display']=_0x4a7747[_0xf88169(0x217)]+_0xf88169(0x29c)+_0x4a7747[_0xf88169(0x2a4)],_0x1e1f47[_0xf88169(0x275)]['push'](_0x4ad06e);}delete _0x1e1f47[_0xf88169(0x26c)],_0x1557a5=!![];}if(_0x1557a5)_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x298)+JSON[_0xf88169(0x23b)](_0x33ed57));}if(!_0x26747f){if(_0x33ed57['activityOperation']==='deleteUser'){_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+'\x20Delete\x20User\x20userName='+_0x4dcfe9+_0xf88169(0x221)),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}if(_0x24a4cf[_0xf88169(0x29b)]&&_0x24a4cf[_0xf88169(0x29b)]===!![]){_0x31290f['logger'][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x22e)+_0x4dcfe9+'\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true'),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}if(Object[_0xf88169(0x27f)]['hasOwnProperty']['call'](_0x1e1f47,_0xf88169(0x27b))){if(typeof _0x1e1f47[_0xf88169(0x27b)]===_0xf88169(0x225)){const _0x2d5227=_0x1e1f47[_0xf88169(0x27b)][_0xf88169(0x21f)]();if(_0x2d5227===_0xf88169(0x1e8))_0x1e1f47['active']=!![];else{if(_0x2d5227===_0xf88169(0x2aa))_0x1e1f47[_0xf88169(0x27b)]=![];}}if(_0x1e1f47['active']===![]){_0x31290f['logger'][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x22e)+_0x4dcfe9+'\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false'),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}}_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x293)+_0x4dcfe9);const _0x211f3f=utils[_0xf88169(0x220)](_0x1e1f47);try{delete _0x211f3f['groups'];!_0x211f3f['password']&&_0x24a4cf[_0xf88169(0x1e5)]&&_0x24a4cf['generateUserPassword']===!![]&&(_0x211f3f[_0xf88169(0x20c)]=utils[_0xf88169(0x1eb)](0xf));if(_0x3375ab||_0x507f88){if(_0x3375ab)for(const _0x19952b in _0x3375ab){_0x211f3f[_0x19952b]=_0x3375ab[_0x19952b];}if(_0x507f88)_0x211f3f['id']=_0x507f88;await _0x51aadb(_0x211f3f);}await _0x31290f[_0xf88169(0x285)](_0x51705e,_0x211f3f),_0x1e1f47['groups']&&Array[_0xf88169(0x224)](_0x1e1f47[_0xf88169(0x275)])&&_0x1e1f47['groups'][_0xf88169(0x280)]>0x0&&(_0x52508f=await _0x232e97('userName',_0x4dcfe9));}catch(_0x3c734d){_0x31290f[_0xf88169(0x259)]['error'](_0x4efcda+_0xf88169(0x247)+JSON[_0xf88169(0x23b)](_0x211f3f)+_0xf88169(0x1f1)+_0x3c734d[_0xf88169(0x291)]+'}'),_0x31290f['logger']['debug'](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}}if(_0x26747f||_0x52508f){if(_0x33ed57[_0xf88169(0x23f)]===_0xf88169(0x278)){if(_0x24a4cf[_0xf88169(0x29b)]&&_0x24a4cf[_0xf88169(0x29b)]===!![]){_0x31290f['logger']['debug'](_0x4efcda+_0xf88169(0x26b)+_0x26747f+'\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true'),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x26b)+_0x26747f);try{await _0x31290f[_0xf88169(0x278)](_0x51705e,_0x26747f);}catch(_0x5c87cd){_0x31290f[_0xf88169(0x259)]['error'](_0x4efcda+_0xf88169(0x26b)+_0x26747f+'\x20error:\x20'+_0x5c87cd[_0xf88169(0x291)]+'}'),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+'\x20done'+_0x429c50);return;}}else{if(_0x52508f)_0x26747f=_0x52508f;_0x31290f['logger'][_0xf88169(0x240)](_0x4efcda+'\x20Replace\x20User\x20id='+_0x26747f);const _0x1896c9={};_0x1896c9[_0xf88169(0x237)]=()=>{},_0x1896c9[_0xf88169(0x269)]={},_0x1896c9['params'][_0xf88169(0x265)]=_0x51705e,_0x1896c9[_0xf88169(0x269)]['id']=_0x26747f,_0x1896c9[_0xf88169(0x296)]={},_0x1896c9[_0xf88169(0x296)][_0xf88169(0x27a)]=_0x51705e?'/'+_0x51705e+'/Users/'+_0x26747f:'/Users/'+_0x26747f,_0x1896c9['request']['body']=_0x1e1f47;try{await _0x31290f['replaceUsrGrp'](_0x1896c9);}catch(_0x271d62){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x266)+_0x26747f+_0xf88169(0x1f1)+_0x271d62['message']),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}if(_0x1896c9[_0xf88169(0x22a)]&&(_0x1896c9['status']<0xc8||_0x1896c9[_0xf88169(0x22a)]>0x12b)){if(_0x1896c9[_0xf88169(0x1ff)]){if(_0x1896c9[_0xf88169(0x1ff)][_0xf88169(0x23c)]){let _0x384ff7=_0x1896c9[_0xf88169(0x1ff)]['detail'];_0x384ff7=_0x384ff7[_0xf88169(0x28c)](_0x31290f['gwName']+'['+_0x31290f[_0xf88169(0x283)]+']',''+_0x4efcda),_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](''+_0x384ff7);}else{if(_0x1896c9[_0xf88169(0x1ff)][_0xf88169(0x274)]&&Array[_0xf88169(0x224)](_0x1896c9['body'][_0xf88169(0x274)])&&_0x1896c9[_0xf88169(0x1ff)][_0xf88169(0x274)][_0xf88169(0x280)]>0x0){let _0x3e935a=_0x1896c9[_0xf88169(0x1ff)][_0xf88169(0x274)][0x0]['description'];_0x3e935a=_0x3e935a['replace'](_0x31290f[_0xf88169(0x22f)]+'['+_0x31290f[_0xf88169(0x283)]+']',''+_0x4efcda),_0x31290f[_0xf88169(0x259)]['error'](''+_0x3e935a);}}}}if(_0x24a4cf[_0xf88169(0x271)]){const [_0x1eaacb,_0x1030d8]=_0x31290f[_0xf88169(0x254)]({'Operations':_0x33ed57[_0xf88169(0x1f6)]});if(_0x1030d8){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x266)+_0x26747f+_0xf88169(0x1ee)+_0x1030d8[_0xf88169(0x291)]),_0x31290f['logger'][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}const _0x5b10b1=[];if(_0x1eaacb['roles']&&Array['isArray'](_0x1eaacb[_0xf88169(0x26c)]))for(let _0x43d715=0x0;_0x43d715<_0x1eaacb[_0xf88169(0x26c)][_0xf88169(0x280)];_0x43d715++){_0x1eaacb[_0xf88169(0x26c)][_0x43d715]['operation']&&_0x1eaacb['roles'][_0x43d715][_0xf88169(0x295)]===_0xf88169(0x1fc)&&_0x5b10b1[_0xf88169(0x2a5)](_0x1eaacb['roles'][_0x43d715]);}if(_0x5b10b1[_0xf88169(0x280)]>0x0)try{await _0x31290f[_0xf88169(0x249)](_0x51705e,_0x26747f,{'roles':_0x5b10b1});}catch(_0x195383){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x266)+_0x26747f+'\x20role\x20removal\x20error:\x20'+_0x195383[_0xf88169(0x291)]);}const _0x301912=[];if(_0x1eaacb[_0xf88169(0x275)]&&Array[_0xf88169(0x224)](_0x1eaacb[_0xf88169(0x275)]))for(let _0x2f25dd=0x0;_0x2f25dd<_0x1eaacb[_0xf88169(0x275)][_0xf88169(0x280)];_0x2f25dd++){_0x1eaacb[_0xf88169(0x275)][_0x2f25dd][_0xf88169(0x295)]&&_0x1eaacb[_0xf88169(0x275)][_0x2f25dd]['operation']==='delete'&&_0x301912['push'](_0x1eaacb[_0xf88169(0x275)][_0x2f25dd]);}if(_0x301912[_0xf88169(0x280)]>0x0)for(let _0x396053=0x0;_0x396053<_0x301912['length'];_0x396053++){try{await _0x31290f[_0xf88169(0x204)](_0x51705e,_0x301912[_0x396053]['id'],{'members':[{'operation':_0xf88169(0x1fc),'value':_0x26747f}]});}catch(_0x15a696){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x4efcda+_0xf88169(0x266)+_0x26747f+_0xf88169(0x22c)+_0x15a696[_0xf88169(0x291)]);}}}if(_0x24a4cf[_0xf88169(0x2af)]&&_0x33ed57[_0xf88169(0x23f)]===_0xf88169(0x249)){if(_0x1e1f47[_0xf88169(0x275)]&&Array[_0xf88169(0x224)](_0x1e1f47[_0xf88169(0x275)])&&_0x1e1f47[_0xf88169(0x275)][_0xf88169(0x280)]===0x0){if(_0x1e1f47[_0xf88169(0x26c)]&&Array[_0xf88169(0x224)](_0x1e1f47[_0xf88169(0x26c)])&&_0x1e1f47[_0xf88169(0x26c)]['length']===0x0){if(_0x33ed57[_0xf88169(0x1f6)]&&Array['isArray'](_0x33ed57[_0xf88169(0x1f6)])&&_0x33ed57[_0xf88169(0x1f6)]['length']>0x0){let _0x583b27=![];for(let _0x428e7e=0x0;_0x428e7e<_0x33ed57[_0xf88169(0x1f6)][_0xf88169(0x280)];_0x428e7e++){const _0x2b9392=_0x33ed57[_0xf88169(0x1f6)][_0x428e7e];if(_0x2b9392['op']===_0xf88169(0x263)){if(_0x2b9392['path']){if(_0x2b9392[_0xf88169(0x218)][_0xf88169(0x1fe)]('roles')&&_0x2b9392[_0xf88169(0x2b1)]){_0x583b27=!![];break;}else{if(_0x2b9392[_0xf88169(0x218)]===_0xf88169(0x275)){_0x583b27=!![];break;}}}}}if(_0x583b27){_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x26b)+_0x26747f);try{await _0x31290f[_0xf88169(0x278)](_0x51705e,_0x26747f);}catch(_0x247788){_0x31290f['logger'][_0xf88169(0x205)](_0x4efcda+'\x20Delete\x20User\x20id='+_0x26747f+_0xf88169(0x1f1)+_0x247788[_0xf88169(0x291)]+'}'),_0x31290f[_0xf88169(0x259)][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);return;}}}}}}}}_0x31290f['logger'][_0xf88169(0x240)](_0x4efcda+_0xf88169(0x1e9)+_0x429c50);}catch(_0x37075a){_0x31290f[_0xf88169(0x259)][_0xf88169(0x205)](_0x31290f['gwName']+'['+_0x31290f[_0xf88169(0x283)]+_0xf88169(0x2a7)+_0x51705e+']['+_0x258328+']\x20error:\x20'+_0x37075a[_0xf88169(0x291)]+_0xf88169(0x21b)+_0x429c50);}},_0x3dafb7=nats[_0x20cb03(0x239)](),_0x2b30ae=_0x1266da[_0x20cb03(0x238)](),_0x18a1b9=(_0x20cb03(0x281)+_0x31290f[_0x20cb03(0x283)]+'_'+_0x51705e)['replaceAll']('*','#')['replaceAll']('>','##')['replaceAll']('.','_');let _0x10788e;const _0x38885d=async()=>{const _0x116fa7=_0x20cb03;try{const _0x312f4b=''+_0x24a4cf['nats'][_0x116fa7(0x1fd)],_0xcd2fde=await _0x1266da[_0x116fa7(0x299)](),_0x72c609=async()=>{const _0x52a0f8=_0x116fa7;let _0x27f1c2;try{_0x27f1c2=await _0x2b30ae['consumers'][_0x52a0f8(0x26a)](_0x312f4b,_0x18a1b9);}catch(_0x442dd2){await _0xcd2fde['consumers'][_0x52a0f8(0x231)](_0x312f4b,{'durable_name':_0x18a1b9,'ack_policy':nats[_0x52a0f8(0x213)]['Explicit'],'deliver_policy':nats[_0x52a0f8(0x28b)][_0x52a0f8(0x273)],'deliver_group':_0x24a4cf?.[_0x52a0f8(0x267)]?.['queueGroup']||null,'filter_subject':_0x258328}),_0x27f1c2=await _0x2b30ae[_0x52a0f8(0x22d)][_0x52a0f8(0x26a)](_0x312f4b,_0x18a1b9);}(_0x258328!==_0x27f1c2?.[_0x52a0f8(0x20e)]?.['config']?.[_0x52a0f8(0x1e0)]||_0x24a4cf?.[_0x52a0f8(0x267)]?.['queueGroup']!==_0x27f1c2?.[_0x52a0f8(0x20e)]?.[_0x52a0f8(0x284)]?.[_0x52a0f8(0x26f)])&&(await _0xcd2fde['consumers'][_0x52a0f8(0x276)](_0x312f4b,_0x18a1b9,{'deliver_group':_0x24a4cf?.[_0x52a0f8(0x267)]?.['queueGroup']||null,'filter_subject':_0x258328}),_0x27f1c2=await _0x2b30ae[_0x52a0f8(0x22d)]['get'](_0x312f4b,_0x18a1b9)),_0x10788e=await _0x27f1c2[_0x52a0f8(0x212)]({'max_messages':0x64});};await _0x72c609();const _0x547785=async()=>{const _0x2e8782=_0x116fa7;for await(const _0x443d0a of await _0x10788e[_0x2e8782(0x22a)]()){switch(_0x443d0a[_0x2e8782(0x217)]){case nats['ConsumerEvents'][_0x2e8782(0x25b)]:if(_0x443d0a['data']===0x1)_0x31290f[_0x2e8782(0x259)][_0x2e8782(0x251)](_0x31290f['gwName']+'['+_0x31290f[_0x2e8782(0x283)]+_0x2e8782(0x2a7)+_0x51705e+']['+_0x258328+_0x2e8782(0x2a6)+_0x443d0a[_0x2e8782(0x217)]),_0x72c609();else _0x443d0a[_0x2e8782(0x28e)]%0xa===0x0&&_0x31290f[_0x2e8782(0x259)][_0x2e8782(0x205)](_0x31290f[_0x2e8782(0x22f)]+'['+_0x31290f[_0x2e8782(0x283)]+_0x2e8782(0x2a7)+_0x51705e+']['+_0x258328+_0x2e8782(0x20a)+_0x443d0a[_0x2e8782(0x217)]+'\x20count='+_0x443d0a[_0x2e8782(0x28e)]);break;}}};_0x547785();for await(const _0x30f5aa of _0x10788e){if(!_0x30f5aa[_0x116fa7(0x1f9)]||!_0x30f5aa[_0x116fa7(0x1f9)][_0x116fa7(0x26a)](_0x116fa7(0x20f))){_0x30f5aa[_0x116fa7(0x28d)]();continue;}const _0x44095c=_0x31290f[_0x116fa7(0x22f)]+'['+_0x31290f['pluginName']+_0x116fa7(0x2a7)+_0x51705e+']['+_0x30f5aa['subject']+']['+_0x10788e[_0x116fa7(0x246)]()+']['+(_0x30f5aa[_0x116fa7(0x1f9)]?_0x30f5aa[_0x116fa7(0x1f9)][_0x116fa7(0x26a)]('Msg-Id'):'')+']',_0x244fba=_0x3dafb7[_0x116fa7(0x1e7)](_0x30f5aa[_0x116fa7(0x28e)]);await _0x4f4f80(_0x44095c,_0x244fba),_0x30f5aa['ack']();}}catch(_0x1dac28){_0x31290f[_0x116fa7(0x259)][_0x116fa7(0x205)](_0x31290f[_0x116fa7(0x22f)]+'['+_0x31290f['pluginName']+_0x116fa7(0x2a7)+_0x51705e+']['+_0x258328+_0x116fa7(0x1f7)+_0x1dac28['message']);}};_0x38885d();const _0x345736=async()=>{const _0x731d29=_0x20cb03;let _0x221f54=0x0;for await(const _0x24bd1f of _0x1266da[_0x731d29(0x22a)]()){switch(_0x24bd1f[_0x731d29(0x217)]){case nats[_0x731d29(0x209)]['Disconnect']:_0x31290f[_0x731d29(0x259)]['error'](_0x31290f[_0x731d29(0x22f)]+'['+_0x31290f[_0x731d29(0x283)]+_0x731d29(0x2a7)+_0x51705e+']['+_0x258328+_0x731d29(0x2b0)+_0x24bd1f['data']+_0x731d29(0x27d)),_0x221f54=0x0;break;case nats['Events'][_0x731d29(0x1df)]:_0x31290f[_0x731d29(0x259)]['info'](_0x31290f[_0x731d29(0x22f)]+'['+_0x31290f['pluginName']+_0x731d29(0x2a7)+_0x51705e+']['+_0x258328+_0x731d29(0x2ad)+_0x24bd1f['data']);try{if(_0x10788e['consumerInfo'])await _0x10788e[_0x731d29(0x242)]();}catch(_0x3f08fe){if(_0x10788e['unsubscribe'])_0x10788e[_0x731d29(0x262)]();}break;case nats[_0x731d29(0x209)]['Error']:_0x31290f[_0x731d29(0x259)][_0x731d29(0x205)](_0x31290f[_0x731d29(0x22f)]+'['+_0x31290f[_0x731d29(0x283)]+']\x20subscriber['+_0x51705e+']['+_0x258328+_0x731d29(0x250)+_0x24bd1f[_0x731d29(0x28e)]);break;case nats[_0x731d29(0x26d)][_0x731d29(0x255)]:_0x221f54+=0x1;_0x221f54%0x1e===0x0&&_0x31290f[_0x731d29(0x259)][_0x731d29(0x240)](_0x31290f[_0x731d29(0x22f)]+'['+_0x31290f[_0x731d29(0x283)]+_0x731d29(0x2a7)+_0x51705e+']['+_0x258328+']\x20client\x20is\x20attempting\x20to\x20reconnect\x20'+_0x24bd1f[_0x731d29(0x28e)]+_0x731d29(0x228)+_0x221f54+')');break;case nats[_0x731d29(0x26d)][_0x731d29(0x200)]:_0x31290f[_0x731d29(0x259)][_0x731d29(0x240)](_0x31290f[_0x731d29(0x22f)]+'['+_0x31290f[_0x731d29(0x283)]+']\x20subscriber['+_0x51705e+']['+_0x258328+_0x731d29(0x226)+_0x24bd1f['data']);break;}}};_0x345736(),process['on'](_0x20cb03(0x27e),async()=>{const _0x326904=_0x20cb03;_0x1266da&&await _0x1266da[_0x326904(0x1e4)]();}),process['on'](_0x20cb03(0x232),async()=>{const _0x3a7ef2=_0x20cb03;_0x1266da&&await _0x1266da[_0x3a7ef2(0x1e4)]();});};const _0x232e97=async(_0x41c62c,_0x41b7c4)=>{const _0x28ea8a=_0x5e4129,_0xec9984={'attribute':_0x41c62c,'operator':'eq','value':_0x41b7c4,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0x43dd50=[_0x41c62c];if(_0x41c62c!=='id')_0x43dd50[_0x28ea8a(0x2a5)]('id');try{const _0x38786c=await _0x31290f[_0x28ea8a(0x1e6)](_0x51705e,_0xec9984,_0x43dd50);if(!_0x38786c||!_0x38786c['Resources']||!Array[_0x28ea8a(0x224)](_0x38786c[_0x28ea8a(0x236)]))throw new Error(_0x28ea8a(0x229)+JSON['stringify'](_0xec9984)+_0x28ea8a(0x24b));if(_0x38786c['Resources'][_0x28ea8a(0x280)]===0x0)return null;else{if(_0x38786c[_0x28ea8a(0x236)][_0x28ea8a(0x280)]>0x2)throw new Error(_0x28ea8a(0x229)+JSON['stringify'](_0xec9984)+_0x28ea8a(0x258));else{const _0x108243=_0x38786c[_0x28ea8a(0x236)][0x0];if(!_0x108243['id'])throw new Error('getUsers()\x20getObj='+JSON['stringify'](_0xec9984)+_0x28ea8a(0x223)+JSON[_0x28ea8a(0x23b)](_0x108243)+_0x28ea8a(0x206));return decodeURIComponent(_0x108243['id']);}}}catch(_0x285011){throw new Error(_0x28ea8a(0x229)+JSON['stringify'](_0xec9984)+'\x20error:\x20'+_0x285011[_0x28ea8a(0x291)]+'}');}},_0x42d99f=_0x5c0590=>{const _0x1ac6ba=_0x5e4129;if(!_0x5c0590||typeof _0x5c0590!==_0x1ac6ba(0x225))return[null,null];_0x5c0590=_0x5c0590['trim']();const _0x48ff6f=_0x5c0590[_0x1ac6ba(0x245)]('(');if(_0x48ff6f<0x1)return[null,null];if(_0x5c0590['substring'](_0x5c0590['length']-0x1)!==')')return[null,null];if(_0x5d71b4(_0x5c0590,'(')!==_0x5d71b4(_0x5c0590,')'))return[null,null];const _0x4a3ea2=_0x5c0590[_0x1ac6ba(0x252)](0x0,_0x48ff6f),_0x299ee3=_0x5c0590['substring'](_0x48ff6f+0x1,_0x5c0590[_0x1ac6ba(0x280)]-0x1);let _0x536f09=[];const _0x563185=_0x299ee3['split'](',');let _0xa588f4='';for(let _0x27d854=0x0;_0x27d854<_0x563185[_0x1ac6ba(0x280)];_0x27d854++){const _0x2fe8d4=_0xa588f4?_0xa588f4+','+_0x563185[_0x27d854]:_0x563185[_0x27d854],_0x29ee95=_0x5d71b4(_0x2fe8d4,'('),_0x23cbdf=_0x5d71b4(_0x2fe8d4,')');if(_0x29ee95===_0x23cbdf)_0x536f09[_0x1ac6ba(0x2a5)](_0x343cfa(_0x2fe8d4,'\x22')),_0xa588f4='';else{if(_0xa588f4)_0xa588f4+=','+_0x563185[_0x27d854];else _0xa588f4+=_0x563185[_0x27d854];}}if(_0x536f09[_0x1ac6ba(0x280)]===0x0)_0x536f09=null;return[_0x4a3ea2,_0x536f09];};function _0x5d71b4(_0x30fe47,_0x5d3faa){const _0xf8aa7a=_0x5e4129;let _0x4e3053=0x0;for(let _0x5ee553=0x0;_0x5ee553<_0x30fe47[_0xf8aa7a(0x280)];_0x5ee553++){_0x30fe47[_0xf8aa7a(0x2a3)](_0x5ee553)===_0x5d3faa&&(_0x4e3053+=0x1);}return _0x4e3053;}const _0x343cfa=(_0x396924,_0x49dd11)=>{const _0x15f980=_0x5e4129;if(typeof _0x396924!==_0x15f980(0x225)||typeof _0x49dd11!==_0x15f980(0x225))return _0x396924;if(_0x396924['length']===0x1)return _0x396924;if(_0x49dd11[_0x15f980(0x280)]!==0x1)return _0x396924;return _0x396924=_0x396924[_0x15f980(0x277)](),_0x396924[_0x15f980(0x252)](0x0,0x1)===_0x49dd11&&(_0x396924=_0x396924['substring'](0x1)),_0x396924[_0x15f980(0x252)](_0x396924['length']-0x1)===_0x49dd11&&(_0x396924=_0x396924[_0x15f980(0x252)](0x0,_0x396924['length']-0x1)),_0x396924;},_0x482484=async(_0x54f1e6,_0x18831e,_0x1833ba)=>{const _0x226b3c=_0x5e4129;if(!_0x54f1e6||!_0x18831e||!_0x1833ba)return null;const [_0x5f1885,_0x437507]=_0x42d99f(_0x1833ba);if(!_0x5f1885||!_0x437507){const _0x5bc0ea=_0x1833ba[_0x226b3c(0x290)]('(');if(_0x5bc0ea[_0x226b3c(0x280)]>0x1){const _0x29cef2=['lowercase','uppercase','firstn','elementnumber','join',_0x226b3c(0x28c),_0x226b3c(0x234),_0x226b3c(0x268),_0x226b3c(0x253)],_0x1831f7=_0x5bc0ea[0x0][_0x226b3c(0x21f)]();if(_0x29cef2['includes'](_0x1831f7))return null;}return _0x1833ba;}for(let _0x2dbf51=0x0;_0x2dbf51<_0x437507[_0x226b3c(0x280)];_0x2dbf51++){if(_0x437507[_0x2dbf51][_0x226b3c(0x252)](0x0,0x1)==='['){const _0x42fcfa=_0x437507[_0x2dbf51][_0x226b3c(0x245)](']');if(_0x42fcfa<0x0)return null;const _0x466c02=_0x437507[_0x2dbf51]['substring'](0x1,_0x42fcfa),_0xb181af=_0x466c02[_0x226b3c(0x290)]('.');let _0x39aa08;for(let _0x568eb3=0x0;_0x568eb3<_0xb181af[_0x226b3c(0x280)];_0x568eb3++){if(_0x568eb3===0x0)_0x39aa08=_0x54f1e6[_0xb181af[_0x568eb3]];else{if(!_0x39aa08)return null;_0x39aa08=_0x39aa08[_0xb181af[_0x568eb3]];}}if(!_0x39aa08)return null;_0x437507[_0x2dbf51]=_0x39aa08;}}for(let _0x10684a=0x0;_0x10684a<_0x437507['length'];_0x10684a++){const [_0xb518f3]=_0x42d99f(_0x437507[_0x10684a]);_0xb518f3&&(_0x437507[_0x10684a]=await _0x482484(_0x54f1e6,_0x18831e,_0x437507[_0x10684a]));}if(_0x437507[0x0]===null)return null;switch(_0x5f1885[_0x226b3c(0x21f)]()){case _0x226b3c(0x1f8):{if(_0x437507[_0x226b3c(0x280)]!==0x1)return null;const [_0x424a41]=_0x42d99f(_0x437507[0x0]);if(_0x424a41)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x424a41);if(_0x437507[0x0]===null)return null;return _0x437507[0x0]['toLowerCase']();}case _0x226b3c(0x20d):{if(_0x437507[_0x226b3c(0x280)]!==0x1)return null;const [_0x298c11]=_0x42d99f(_0x437507[0x0]);if(_0x298c11)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x298c11);if(_0x437507[0x0]===null)return null;return _0x437507[0x0][_0x226b3c(0x211)]();}case _0x226b3c(0x202):{if(_0x437507[_0x226b3c(0x280)]!==0x2)return null;const [_0x239820]=_0x42d99f(_0x437507[0x0]);if(_0x239820)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x239820);if(_0x437507[0x0]===null)return null;if(isNaN(_0x437507[0x1]))return null;return _0x437507[0x0][_0x226b3c(0x252)](0x0,_0x437507[0x1]);}case _0x226b3c(0x2ab):{const [_0x53eae3]=_0x42d99f(_0x437507[0x0]);if(_0x437507[_0x226b3c(0x280)]<0x2)return null;if(_0x53eae3)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x53eae3);if(_0x437507[0x0]===null)return null;const _0x552e86=_0x437507[0x1];if(isNaN(_0x552e86))return null;let _0x349266;if(_0x437507['length']===0x3)_0x349266=_0x437507[0x0][_0x226b3c(0x290)](_0x437507[0x2]);else _0x349266=_0x349266=_0x437507[0x0][_0x226b3c(0x290)]('\x20');if(_0x552e86<=_0x349266[_0x226b3c(0x280)])return _0x349266[_0x552e86-0x1];else return'';}case _0x226b3c(0x28c):{const [_0xc56ee2]=_0x42d99f(_0x437507[0x0]);if(_0xc56ee2)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0xc56ee2);if(_0x437507[0x0]===null)return null;if(_0x437507[_0x226b3c(0x280)]!==0x3)return null;return _0x437507[0x0][_0x226b3c(0x2a1)](_0x437507[0x1],_0x437507[0x2]);}case _0x226b3c(0x234):{if(_0x437507['length']!==0x1)return null;const [_0x9fbd70]=_0x42d99f(_0x437507[0x0]);if(_0x9fbd70)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x9fbd70);if(_0x437507[0x0]===null)return null;return ascii127[_0x226b3c(0x201)](_0x437507[0x0]);}case _0x226b3c(0x288):{let _0x5f3a1b='';for(let _0x4b5b72=0x0;_0x4b5b72<_0x437507[_0x226b3c(0x280)];_0x4b5b72++){const [_0x58cb75]=_0x42d99f(_0x437507[_0x4b5b72]);if(_0x58cb75)_0x437507[_0x4b5b72]=await _0x482484(_0x54f1e6,_0x18831e,_0x58cb75);if(_0x437507[_0x4b5b72]===null)return null;_0x5f3a1b+=_0x437507[_0x4b5b72];}return _0x5f3a1b;}case _0x226b3c(0x268):{if(_0x437507['length']>0x2)return null;const [_0x48bb93]=_0x42d99f(_0x437507[0x0]);if(_0x48bb93)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x48bb93);if(_0x437507[0x0]===null)return null;const _0x28206c=parseInt(_0x437507[0x0]);if(isNaN(_0x28206c))return null;let _0x3fa323=_0x226b3c(0x270);_0x3fa323+=','+_0x437507[0x0];if(_0x437507['length']===0x2&&_0x437507[0x1][_0x226b3c(0x21f)]()===_0x226b3c(0x1e8))_0x3fa323+=_0x226b3c(0x297);else _0x3fa323+=_0x226b3c(0x1e1);return _0x3fa323+='##',_0x3fa323;}case _0x226b3c(0x253):{if(_0x437507['length']!==0x1)return null;const [_0x3680e9]=_0x42d99f(_0x437507[0x0]);if(_0x3680e9)_0x437507[0x0]=await _0x482484(_0x54f1e6,_0x18831e,_0x3680e9);if(_0x437507[0x0]===null)return null;let _0x163755,_0x51f51c=![],_0x40ace9='';const _0x1c840d=_0x437507[0x0][_0x226b3c(0x290)]('##');if(_0x1c840d[_0x226b3c(0x280)]>0x2)for(let _0x3630de=0x0;_0x3630de<_0x1c840d[_0x226b3c(0x280)];_0x3630de++){if(_0x1c840d[_0x3630de][_0x226b3c(0x1fe)]('doIncrement')){const _0x374dbe=_0x1c840d[_0x3630de][_0x226b3c(0x290)](',');if(_0x374dbe[_0x226b3c(0x280)]<0x2)return null;const _0x466314=parseInt(_0x374dbe[0x1]);if(isNaN(_0x466314))return null;_0x40ace9='##'+_0x1c840d[_0x3630de]+'##',_0x163755=_0x374dbe[0x1],_0x374dbe[_0x226b3c(0x280)]>0x2&&(_0x51f51c=_0x374dbe[0x2][_0x226b3c(0x21f)]()==='true');}}let _0x1e30a4,_0xf3d579=0x0,_0x567d88=0x0;if(_0x163755){_0x567d88=_0x163755['length'],_0xf3d579=0xa;for(let _0x5df902=0x1;_0x5df902<_0x567d88;_0x5df902++){_0xf3d579*=0xa;}_0xf3d579-=0x1,_0x1e30a4=parseInt(_0x163755);if(isNaN(_0x1e30a4))return null;_0x1e30a4-=0x1;}else _0x1e30a4=0x0;do{_0x1e30a4+=0x1;let _0x555e37=_0x437507[0x0];if(_0x163755!==undefined&&_0x40ace9){let _0x230b98=_0x1e30a4[_0x226b3c(0x25f)]();while(_0x230b98[_0x226b3c(0x280)]<_0x567d88){_0x230b98='0'+_0x230b98;}_0x51f51c?_0x555e37=_0x555e37['replace'](_0x40ace9,_0x230b98):(_0x555e37=_0x555e37['replace'](_0x40ace9,''),_0x51f51c=!![],_0x1e30a4-=0x1);}try{const _0x804a9=await _0x232e97(_0x18831e,_0x555e37);if(!_0x804a9)return _0x555e37;}catch(_0x5aa613){return _0x31290f[_0x226b3c(0x259)][_0x226b3c(0x205)](_0x31290f[_0x226b3c(0x22f)]+'['+_0x31290f[_0x226b3c(0x283)]+']\x20'+_0x5f1885+_0x226b3c(0x21d)+_0x5aa613['message']),null;}}while(_0x1e30a4<_0xf3d579);return null;}default:}return null;},_0x51aadb=async _0x3464b4=>{const _0x21d9d1=_0x5e4129;for(const _0x105927 in _0x3464b4){const _0x6be27f=_0x3464b4[_0x105927],[_0x6a4c5a,_0x8ab459]=_0x42d99f(_0x6be27f);if(_0x6a4c5a){const _0x4e5d03=''+_0x105927,_0x1d1d99=_0x6a4c5a+'('+_0x8ab459[_0x21d9d1(0x288)](',')+')',_0x4bb400=await _0x482484(_0x3464b4,_0x4e5d03,_0x1d1d99);if(_0x4bb400===null)delete _0x3464b4[_0x105927];else _0x3464b4[_0x105927]=_0x4bb400;}for(const _0x2d95f7 in _0x6be27f){const _0x493b9e=_0x6be27f[_0x2d95f7],[_0x33deb9,_0x20659d]=_0x42d99f(_0x493b9e);if(_0x33deb9){const _0x18638c=_0x105927+'.'+_0x2d95f7,_0x599d0d=_0x33deb9+'('+_0x20659d[_0x21d9d1(0x288)](',')+')',_0x41bb18=await _0x482484(_0x3464b4,_0x18638c,_0x599d0d);if(_0x41bb18===null)delete _0x6be27f[_0x2d95f7];else _0x6be27f[_0x2d95f7]=_0x41bb18;}}}return _0x3464b4;};},module[a0_0x4938eb(0x230)][a0_0x4938eb(0x24a)]=async(_0x48f0ea,_0x12757e,_0x56a930,_0x2aadbc)=>{const _0xc3f8f0=a0_0x4938eb,_0x496103=_0xc3f8f0(0x24a),_0xb14446=_0x48f0ea;_0xb14446['logger'][_0xc3f8f0(0x240)](_0xb14446['gwName']+'['+_0xb14446['pluginName']+_0xc3f8f0(0x1ef)+_0x496103+'\x22');try{if(!fs['existsSync'](_0xb14446[_0xc3f8f0(0x292)]+_0xc3f8f0(0x1ea)))fs['mkdirSync'](_0xb14446['configDir']+_0xc3f8f0(0x1ea));}catch(_0x1926db){}const _0x35ac73=path['join'](''+_0xb14446['configDir'],'approles',_0xc3f8f0(0x248)+_0xb14446[_0xc3f8f0(0x283)]+_0xc3f8f0(0x2ae)),_0x458d3f={};utils[_0xc3f8f0(0x20b)](_0x35ac73)&&fs['readFileSync'](_0x35ac73,_0xc3f8f0(0x2a0))[_0xc3f8f0(0x290)](/\r?\n/)[_0xc3f8f0(0x29f)](_0x3d2842=>{const _0x34d309=_0xc3f8f0,_0x1233ea=_0x3d2842['split']('\x20');_0x1233ea[_0x34d309(0x280)]===0x2&&(_0x458d3f[_0x1233ea[0x0]]=_0x1233ea[0x1]);});const _0x42d37e=fs[_0xc3f8f0(0x256)](_0x35ac73,{'flags':'w','encoding':_0xc3f8f0(0x1e2),'mode':0x1b6,'autoClose':!![]}),_0x544153=[],_0x288dd9=await _0xb14446[_0xc3f8f0(0x1ec)](_0x12757e,{'attribute':undefined,'operator':undefined,'value':undefined},['id','displayName']);return _0x288dd9[_0xc3f8f0(0x236)]['forEach'](_0x3b379b=>{const _0xd4c35e=_0xc3f8f0;if(_0x3b379b['id']){let _0x552cb1=crypto[_0xd4c35e(0x207)]();if(_0x458d3f[_0x3b379b['id']])_0x552cb1=_0x458d3f[_0x3b379b['id']];const _0x452090={'allowedMemberTypes':['User'],'description':'SCIM\x20Stream\x20-\x20Autogenerated','displayName':_0x3b379b[_0xd4c35e(0x25e)]||_0x3b379b['id'],'id':_0x552cb1,'isEnabled':!![],'lang':null,'origin':_0xd4c35e(0x257),'value':decodeURIComponent(_0x3b379b['id'])};_0x544153[_0xd4c35e(0x2a5)](_0x452090),_0x42d37e[_0xd4c35e(0x25a)](_0x3b379b['id']+'\x20'+_0x552cb1+'\x0a');}}),_0x42d37e[_0xc3f8f0(0x1f3)](),_0xb14446['logger']['debug'](_0xb14446['gwName']+'['+_0xb14446['pluginName']+_0xc3f8f0(0x26e)+_0x35ac73),{'Resources':[{'appRoles':_0x544153}]};};