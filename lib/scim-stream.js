// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          Gateway publishing to SCIM Stream having other gateways as subscribers handling requests
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: scim-stream.js is part of the licensed SCIM Stream which is a prerequisite for message Pub/Sub
//       for details see: https://elshaug.xyz/docs/scim-stream
//
// ================================================================
'use strict';const a0_0x5c3ee8=a0_0x3d9f;(function(_0x4cadf1,_0x4c5a5d){const _0x117678=a0_0x3d9f,_0x411dc3=_0x4cadf1();while(!![]){try{const _0x19cf0a=-parseInt(_0x117678(0x18c))/0x1+-parseInt(_0x117678(0x1e9))/0x2+-parseInt(_0x117678(0x1d3))/0x3+-parseInt(_0x117678(0x278))/0x4*(-parseInt(_0x117678(0x262))/0x5)+parseInt(_0x117678(0x218))/0x6*(parseInt(_0x117678(0x20c))/0x7)+-parseInt(_0x117678(0x1d1))/0x8*(parseInt(_0x117678(0x195))/0x9)+-parseInt(_0x117678(0x26b))/0xa*(-parseInt(_0x117678(0x1c8))/0xb);if(_0x19cf0a===_0x4c5a5d)break;else _0x411dc3['push'](_0x411dc3['shift']());}catch(_0x4172cd){_0x411dc3['push'](_0x411dc3['shift']());}}}(a0_0x54fa,0x9c3c2));function a0_0x3d9f(_0x1eb1d7,_0x545967){const _0x54facf=a0_0x54fa();return a0_0x3d9f=function(_0x3d9f18,_0x21d076){_0x3d9f18=_0x3d9f18-0x184;let _0x532f14=_0x54facf[_0x3d9f18];return _0x532f14;},a0_0x3d9f(_0x1eb1d7,_0x545967);}function a0_0x54fa(){const _0x132740=['Msg-Id','subscriber\x20message\x20error:\x20message\x20baseEntity=','crypto','indexOf','prototype','level','\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true','\x20message\x20json\x20parsing\x20error:\x20','operation','getGroups','utf8','call','typeId','Reconnect','replaceAll','getuniquevalue','\x20Create\x20userName=','reconnect','constructor','1414qXwuuA',',\x20id=','config','set','/certs/','path',',\x20obj=','copyObj','\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration','\x20group\x20removal\x20error:\x20',']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls','then','14196xLZFwX','replace','transports','deleteApi','isArray','closed','add','publisher[','deleteUserOnLastGroupRoleRemoval','\x20missing\x20user\x20object\x20in\x20message:\x20','string','trim','\x20convertedScim20\x20error:\x20','replaceDomains','getUsers()\x20getObj=','usePutSoftSync','\x20message\x20response:\x20','description','toUpperCase',']\x20client\x20has\x20a\x20stale\x20connection\x20','displayName','All',',\x20attributes=','server_name','get','sub','waitOnFirstConnect','Resources','SIGTERM','jwtAuthenticator','false','maxPingOut','publish','\x20Delete\x20User\x20id=','{\x22error\x22:\x22','subscriber\x20message\x20error:\x20message\x20missing\x20handle','firstn','Error','\x20roles\x20converted\x20to\x20groups:\x20','createWriteStream','Explicit','file','exports','groups','\x20-\x20','message','getApi','DeliverPolicy','authenticator','ECONNREFUSED','all','doIncrement','SCIM\x20Stream',']\x20connect\x20error:\x20','publisher\x20response\x20error:\x20','/approles','join','\x20not\x20equal\x20subscriber\x20configured\x20baseEntity=','\x20error:\x20missing\x20id}','update','info','utf-8','jwt','toLowerCase','errName','remove','ETIMEDOUT','UnableConnectingHost','active',']\x20client\x20reconnected\x20','503','configDir','activityOperation','status','124990ayLfdg','type','\x20error:\x20','patchApi','nats','replaceUsrGrp','baseEntity','\x20role\x20removal\x20error:\x20',']\x20approle\x20uuid\x20file\x20created:\x20','10pQWTMS','approles_',']\x20initialization\x20error:\x20missing\x20certificate\x20configuration','putApi','roles',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject','passThrough','length','maxReconnectAttempts','debug','pingInterval','Application','drain','96EDrCsU',']\x20closed\x20with\x20error:\x20',']\x20initialization\x20error:\x20missing\x20configuration\x20nats','baseUrls','normalize','\x20result=','\x20Replace\x20User\x20id=','includes',']\x20error:\x20','\x20message\x20handled:\x20','decode','randomUUID','tenant','detail','\x20=>\x20subscriber\x20not\x20activated','true','undefined','readFileSync',',true','deleteGroup','error','\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20','modifyGroup','getProcessed','gwName','secret','Reconnecting','mkdirSync','stringify',']\x20publisher[','fold-to-ascii','createUser','pluginName','from','\x20getUserId()\x20error:\x20','modifyUser','872367SfzPiR','jetstream',']\x20client\x20is\x20attempting\x20to\x20reconnect\x20','forEach','split','internal\x20stream\x20policy\x20have\x20been\x20changed\x20-\x20central\x20SCIM\x20Stream\x20must\x20be\x20stopped\x20and\x20corresponding\x20./jetstream\x20folder\x20deleted\x20before\x20startup\x20allowing\x20new\x20policy','subject','rejectUnauthorized',']\x20initialization\x20certificate\x20error:\x20','7812LBirEo','parse','\x22,\x22errName\x22:\x22','timeout','\x20Create\x20User\x20userName=','consumers','close','data','delete','\x20message:\x20user\x20does\x20not\x20exist','substring','ConsumerNotFound','request','\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available','\x20error:\x20missing\x20result','\x20Delete\x20User\x20userName=','startsWith',']\x20client\x20disconnected\x20','approles',']\x20client\x20error\x20','Disconnect','getAppRoles','query','_info','respond','getUsers','\x20done','modifyOnly',']\x20initialization\x20error:\x20nats.subject\x20root\x20topic\x20must\x20be\x20\x27GW\x27,\x20nats.subject\x20example:\x20GW.APP1','elementnumber','password','ENOTFOUND','isClosed','/Users/','connect',']\x20error:\x20message\x20must\x20be\x20JSON\x20formatted','ack','Operations','charAt','\x20createUser()\x20obj=',']\x20subscriber\x20stopped\x20error:\x20','file-not-configured','\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true','lowercase','User','deleteUser','Errors','publisher\x20error:\x20none\x20JSON\x20formatted\x20response:\x20','body',']\x20error:\x20no\x20subscribers/responders\x20to\x20subject\x20','handle','29245271gUCjRq','name','userName','createRandomPassword','certificate','encode','headers','DebugEvents','skipConvertRolesToGroups','10176MgDUrc','\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}','1198167FcKhVb','fsExistsSync','durable_','increment','StringCodec','SIGINT','tls','createGroup','\x20message:\x20','postApi','display','params',']\x20subscriber[',']\x20connected\x20','subscriber\x20message\x20error:\x20handle\x20\x27',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant','getServer','value','Events','ctxPassThrough','UnableConnectingService','reconnectTimeWait','1441510qBKTht','SCIM\x20Stream\x20-\x20Autogenerated','attributes','uppercase','ConsumerEvents','obj','\x20message\x20error\x20response:\x20','generateUserPassword','originalUrl','##doIncrement','user','write','push','onCreate','logger','schemas'];a0_0x54fa=function(){return _0x132740;};return a0_0x54fa();}const nats=require(a0_0x5c3ee8(0x266)),ascii127=require(a0_0x5c3ee8(0x186)),fs=require('fs'),utils=require('../lib/utils'),path=require(a0_0x5c3ee8(0x211)),crypto=require(a0_0x5c3ee8(0x1fb));module[a0_0x5c3ee8(0x242)]['Subscriber']=function(_0x550464){const _0x13eeb0=a0_0x5c3ee8,_0x537f3d=_0x550464,_0x44009d={};let _0x110bca='';for(let _0x1e6d9c=0x0;_0x1e6d9c<_0x537f3d[_0x13eeb0(0x1f7)][_0x13eeb0(0x21a)]['length'];_0x1e6d9c++){if(_0x537f3d[_0x13eeb0(0x1f7)][_0x13eeb0(0x21a)][_0x1e6d9c][_0x13eeb0(0x1c9)]===_0x13eeb0(0x241)){_0x110bca=_0x537f3d[_0x13eeb0(0x1f7)]['transports'][_0x1e6d9c][_0x13eeb0(0x1fe)];break;}}const _0x31d159=''+(_0x110bca==='debug'?'\x0a':''),_0x5a6c87=async(_0x290985,_0x3dd63d)=>{const _0x5c57c9=_0x13eeb0,_0x49172f=_0x44009d[_0x290985]['config']?.['nats']?.[_0x5c57c9(0x192)];let _0xdccf83;try{_0xdccf83=await nats[_0x5c57c9(0x1b7)](_0x3dd63d);if(_0xdccf83['info']['server_name']!==_0x5c57c9(0x24c)){_0xdccf83['close']();return;}_0x44009d[_0x290985]['nc']=_0xdccf83,_0x540ef0(_0x290985,_0xdccf83),_0x3d378e(_0x290985,_0xdccf83);}catch(_0x106aee){_0x537f3d[_0x5c57c9(0x1f7)][_0x5c57c9(0x28c)](_0x537f3d[_0x5c57c9(0x290)]+'['+_0x537f3d['pluginName']+_0x5c57c9(0x1df)+_0x290985+']['+_0x49172f+_0x5c57c9(0x24d)+_0x106aee[_0x5c57c9(0x245)]+'\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration'),_0x3dd63d['waitOnFirstConnect']=!![];try{_0xdccf83=await nats[_0x5c57c9(0x1b7)](_0x3dd63d);if(_0xdccf83['info'][_0x5c57c9(0x22f)]!==_0x5c57c9(0x24c)){_0xdccf83[_0x5c57c9(0x19b)]();return;}_0x44009d[_0x290985]['nc']=_0xdccf83,_0x540ef0(_0x290985,_0xdccf83),_0x3d378e(_0x290985,_0xdccf83);}catch(_0x121e2b){_0x537f3d[_0x5c57c9(0x1f7)][_0x5c57c9(0x28c)](_0x537f3d[_0x5c57c9(0x290)]+'['+_0x537f3d[_0x5c57c9(0x188)]+']\x20subscriber['+_0x290985+']['+_0x49172f+_0x5c57c9(0x24d)+_0x121e2b[_0x5c57c9(0x245)]);return;}}_0x537f3d[_0x5c57c9(0x1f7)][_0x5c57c9(0x274)](_0x537f3d[_0x5c57c9(0x290)]+'['+_0x537f3d[_0x5c57c9(0x188)]+_0x5c57c9(0x1df)+_0x290985+']['+_0x49172f+_0x5c57c9(0x1e0)+(_0x3dd63d[_0x5c57c9(0x1d9)]['ca']?_0x5c57c9(0x1d9):'')+'\x20'+_0xdccf83[_0x5c57c9(0x1e3)]()),_0xdccf83[_0x5c57c9(0x21d)]()[_0x5c57c9(0x217)](_0xbae580=>{const _0x5f1c8c=_0x5c57c9;_0xbae580&&_0x537f3d[_0x5f1c8c(0x1f7)][_0x5f1c8c(0x28c)](_0x537f3d['gwName']+'['+_0x537f3d[_0x5f1c8c(0x188)]+_0x5f1c8c(0x1df)+_0x290985+']['+_0x49172f+_0x5f1c8c(0x279)+_0xbae580[_0x5f1c8c(0x245)]);});};this[_0x13eeb0(0x21e)]=async(_0x44bd13,_0x4a7ce8)=>{const _0x2e0d87=_0x13eeb0;if(!_0x4a7ce8?.['nats']){_0x537f3d[_0x2e0d87(0x1f7)][_0x2e0d87(0x28c)](_0x537f3d[_0x2e0d87(0x290)]+'['+_0x537f3d[_0x2e0d87(0x188)]+_0x2e0d87(0x1df)+_0x44bd13+_0x2e0d87(0x27a));return;}if(!_0x4a7ce8?.[_0x2e0d87(0x266)]?.[_0x2e0d87(0x284)]){_0x537f3d[_0x2e0d87(0x1f7)][_0x2e0d87(0x28c)](_0x537f3d[_0x2e0d87(0x290)]+'['+_0x537f3d[_0x2e0d87(0x188)]+_0x2e0d87(0x1df)+_0x44bd13+_0x2e0d87(0x1e2));return;}if(!_0x4a7ce8?.[_0x2e0d87(0x266)]?.['subject']){_0x537f3d[_0x2e0d87(0x1f7)][_0x2e0d87(0x28c)](_0x537f3d['gwName']+'['+_0x537f3d[_0x2e0d87(0x188)]+']\x20subscriber['+_0x44bd13+_0x2e0d87(0x270));return;}if(!_0x4a7ce8?.['certificate']?.['ca']){_0x537f3d[_0x2e0d87(0x1f7)][_0x2e0d87(0x28c)](_0x537f3d[_0x2e0d87(0x290)]+'['+_0x537f3d['pluginName']+']\x20subscriber['+_0x44bd13+_0x2e0d87(0x26d));return;}if(!_0x4a7ce8['baseUrls']||!Array[_0x2e0d87(0x21c)](_0x4a7ce8[_0x2e0d87(0x27b)])||_0x4a7ce8['baseUrls'][_0x2e0d87(0x272)]<0x1){_0x537f3d[_0x2e0d87(0x1f7)][_0x2e0d87(0x28c)](_0x537f3d[_0x2e0d87(0x290)]+'['+_0x537f3d['pluginName']+']\x20subscriber['+_0x44bd13+_0x2e0d87(0x216));return;}if(!_0x4a7ce8[_0x2e0d87(0x227)]){const _0x3dd9df=_0x4a7ce8?.[_0x2e0d87(0x266)]?.[_0x2e0d87(0x192)][_0x2e0d87(0x22a)]();if(_0x3dd9df[_0x2e0d87(0x1a5)]('HR.'))_0x4a7ce8[_0x2e0d87(0x227)]=!![];}const _0x56eb1f={};try{let _0x47bc46=path[_0x2e0d87(0x250)](_0x537f3d[_0x2e0d87(0x25f)],_0x2e0d87(0x210),_0x4a7ce8?.['certificate']?.['ca']||_0x2e0d87(0x1be));(_0x4a7ce8?.[_0x2e0d87(0x1cc)]?.['ca']?.[_0x2e0d87(0x1a5)]('/')||_0x4a7ce8?.[_0x2e0d87(0x1cc)]?.['ca']?.[_0x2e0d87(0x27f)]('\x5c'))&&(_0x47bc46=_0x4a7ce8[_0x2e0d87(0x1cc)]['ca']),_0x56eb1f['ca']=[fs[_0x2e0d87(0x289)](_0x47bc46)],_0x56eb1f[_0x2e0d87(0x193)]=!![];}catch(_0x12800b){_0x537f3d[_0x2e0d87(0x1f7)][_0x2e0d87(0x28c)](_0x537f3d[_0x2e0d87(0x290)]+'['+_0x537f3d[_0x2e0d87(0x188)]+_0x2e0d87(0x1df)+_0x44bd13+_0x2e0d87(0x194)+_0x12800b[_0x2e0d87(0x245)]);return;}const _0x21f906={},_0x93b8cf=new TextEncoder()[_0x2e0d87(0x1cd)](_0x4a7ce8?.[_0x2e0d87(0x266)]?.[_0x2e0d87(0x291)]),_0x14d988=_0x4a7ce8?.[_0x2e0d87(0x266)]?.['jwt'];_0x21f906[_0x2e0d87(0x248)]=nats[_0x2e0d87(0x235)](_0x14d988,_0x93b8cf),_0x21f906['servers']=_0x4a7ce8[_0x2e0d87(0x27b)],_0x21f906[_0x2e0d87(0x1d9)]=_0x56eb1f,_0x21f906[_0x2e0d87(0x232)]=![],_0x21f906['reconnect']=!![],_0x21f906[_0x2e0d87(0x1e8)]=0x3e8*0xa,_0x21f906['maxReconnectAttempts']=-0x1,_0x21f906[_0x2e0d87(0x275)]=0x2*0x3c*0x3e8,_0x21f906[_0x2e0d87(0x237)]=0x5,_0x21f906['debug']=![],_0x44009d[_0x44bd13]={},_0x44009d[_0x44bd13]['config']=_0x4a7ce8,_0x44009d[_0x44bd13]['nc']=undefined,_0x44009d[_0x44bd13][_0x2e0d87(0x231)]=undefined,_0x5a6c87(_0x44bd13,_0x21f906);};const _0x3d378e=async(_0x480445,_0x729267)=>{const _0x400a3e=_0x13eeb0,_0x7053b2=_0x44009d[_0x480445][_0x400a3e(0x20e)],_0x244d41=_0x7053b2?.[_0x400a3e(0x266)]?.[_0x400a3e(0x192)];if(!_0x729267){_0x537f3d['logger'][_0x400a3e(0x28c)](_0x537f3d[_0x400a3e(0x290)]+'['+_0x537f3d[_0x400a3e(0x188)]+']\x20subscriber['+_0x480445+']['+_0x244d41+']\x20error:\x20client\x20have\x20not\x20been\x20initialized');return;}const _0x364445=async(_0x4130aa,_0x41a4e0)=>{const _0x25cd43=_0x400a3e;try{_0x537f3d[_0x25cd43(0x1f7)]['info'](_0x4130aa+'\x20handling\x20message:\x20'+_0x41a4e0);let _0x2cb762;try{if(_0x7053b2['replaceDomains']&&Array[_0x25cd43(0x21c)](_0x7053b2[_0x25cd43(0x225)]))for(let _0x21ea8f=0x0;_0x21ea8f<_0x7053b2[_0x25cd43(0x225)][_0x25cd43(0x272)];_0x21ea8f++){const _0x2e7ec7=_0x7053b2[_0x25cd43(0x225)][_0x21ea8f];if(!_0x2e7ec7['from']||!_0x2e7ec7[_0x25cd43(0x189)][_0x25cd43(0x27f)]('.')||!_0x2e7ec7['to']||!_0x2e7ec7['to']['includes']('.'))continue;const _0x356f4e=new RegExp('@'+_0x2e7ec7[_0x25cd43(0x189)]+'\x22','gi');_0x41a4e0=_0x41a4e0[_0x25cd43(0x219)](_0x356f4e,'@'+_0x2e7ec7['to']+'\x22');}_0x2cb762=JSON[_0x25cd43(0x196)](_0x41a4e0);}catch(_0x180ed1){_0x537f3d['logger']['error'](_0x4130aa+_0x25cd43(0x200)+_0x180ed1['message']+_0x25cd43(0x1db)+_0x41a4e0),_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}const _0x336996=_0x2cb762[_0x25cd43(0x1f3)];if(!_0x336996){_0x537f3d[_0x25cd43(0x1f7)]['error'](_0x4130aa+_0x25cd43(0x221)+JSON[_0x25cd43(0x184)](_0x2cb762)),_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+'\x20done'+_0x31d159);return;}if(!_0x336996[_0x25cd43(0x1ca)]){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](_0x4130aa+_0x25cd43(0x28d)+JSON[_0x25cd43(0x184)](_0x2cb762)),_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}delete _0x336996[_0x25cd43(0x1f8)];let _0x2d3fc6;_0x336996['id']&&(_0x2d3fc6=_0x336996['id'],delete _0x336996['id']);let _0x5daa3e;_0x336996[_0x25cd43(0x1f6)]&&(_0x5daa3e=utils[_0x25cd43(0x213)](_0x336996[_0x25cd43(0x1f6)]),delete _0x336996['onCreate']);await _0x330646(_0x480445,_0x336996);const _0x42db6b=_0x336996[_0x25cd43(0x1ca)];let _0x55f236,_0x3832d3;try{_0x55f236=await _0x541b8d(_0x480445,_0x25cd43(0x1ca),_0x42db6b);}catch(_0xd8f1eb){_0x537f3d[_0x25cd43(0x1f7)]['error'](_0x4130aa+_0x25cd43(0x18a)+_0xd8f1eb[_0x25cd43(0x245)]),_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);const _0x2cf8f3=[_0x25cd43(0x25b),_0x25cd43(0x1e7),_0x25cd43(0x249),_0x25cd43(0x1b4),_0x25cd43(0x25a),_0x25cd43(0x198)];for(const _0x4bbccd in _0x2cf8f3){if(_0xd8f1eb[_0x25cd43(0x245)][_0x25cd43(0x27f)](_0x4bbccd))return!![];}return;}if(!_0x7053b2[_0x25cd43(0x1d0)]){let _0x449e21=![];if(_0x2cb762[_0x25cd43(0x1ba)]&&Array[_0x25cd43(0x21c)](_0x2cb762['Operations']))for(let _0x575ae6=0x0;_0x575ae6<_0x2cb762['Operations'][_0x25cd43(0x272)];_0x575ae6++){const _0x4ff6ad=_0x2cb762[_0x25cd43(0x1ba)][_0x575ae6];_0x4ff6ad[_0x25cd43(0x211)][_0x25cd43(0x1a5)](_0x25cd43(0x26f))&&(_0x4ff6ad[_0x25cd43(0x211)]=_0x25cd43(0x243),Array['isArray'](_0x4ff6ad[_0x25cd43(0x1e4)])?(_0x4ff6ad[_0x25cd43(0x1e4)][0x0]['id']=_0x4ff6ad[_0x25cd43(0x1e4)][0x0]['value'],_0x4ff6ad['value'][0x0][_0x25cd43(0x1dd)]=_0x4ff6ad[_0x25cd43(0x1e4)][0x0][_0x25cd43(0x263)]+_0x25cd43(0x244)+_0x4ff6ad['value'][0x0][_0x25cd43(0x1e4)],delete _0x4ff6ad['value'][0x0][_0x25cd43(0x1e4)],delete _0x4ff6ad[_0x25cd43(0x1e4)][0x0][_0x25cd43(0x263)]):_0x4ff6ad['value']=[{'id':_0x4ff6ad[_0x25cd43(0x1e4)],'display':_0x4ff6ad['value']}],delete _0x4ff6ad[_0x25cd43(0x205)],_0x449e21=!![]);}if(_0x336996[_0x25cd43(0x26f)]&&Array[_0x25cd43(0x21c)](_0x336996[_0x25cd43(0x26f)])&&_0x336996[_0x25cd43(0x26f)][_0x25cd43(0x272)]>0x0){if(!_0x336996[_0x25cd43(0x243)])_0x336996[_0x25cd43(0x243)]=[];if(!Array[_0x25cd43(0x21c)](_0x336996[_0x25cd43(0x243)]))_0x336996[_0x25cd43(0x243)]=[];for(let _0x3626cc=0x0;_0x3626cc<_0x336996['roles'][_0x25cd43(0x272)];_0x3626cc++){const _0x6818b2={},_0x27aa8a=_0x336996['roles'][_0x3626cc];_0x6818b2['value']=_0x27aa8a[_0x25cd43(0x1e4)],_0x6818b2[_0x25cd43(0x1dd)]=_0x27aa8a[_0x25cd43(0x263)]+_0x25cd43(0x244)+_0x27aa8a[_0x25cd43(0x1dd)],_0x336996[_0x25cd43(0x243)][_0x25cd43(0x1f5)](_0x6818b2);}delete _0x336996[_0x25cd43(0x26f)],_0x449e21=!![];}if(_0x449e21)_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x23e)+JSON[_0x25cd43(0x184)](_0x2cb762));}if(!_0x55f236){if(_0x2cb762['activityOperation']===_0x25cd43(0x1c2)){_0x537f3d['logger'][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1a4)+_0x42db6b+_0x25cd43(0x19e)),_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+'\x20done'+_0x31d159);return;}if(_0x7053b2[_0x25cd43(0x1b0)]&&_0x7053b2['modifyOnly']===!![]){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+'\x20Create\x20userName='+_0x42db6b+_0x25cd43(0x1ff)),_0x537f3d['logger']['debug'](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}if(Object[_0x25cd43(0x1fd)]['hasOwnProperty'][_0x25cd43(0x204)](_0x336996,_0x25cd43(0x25c))){if(typeof _0x336996[_0x25cd43(0x25c)]===_0x25cd43(0x222)){const _0x1bea6c=_0x336996['active'][_0x25cd43(0x257)]();if(_0x1bea6c==='true')_0x336996[_0x25cd43(0x25c)]=!![];else{if(_0x1bea6c===_0x25cd43(0x236))_0x336996[_0x25cd43(0x25c)]=![];}}if(_0x336996[_0x25cd43(0x25c)]===![]){_0x537f3d['logger'][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x209)+_0x42db6b+'\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false'),_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}}_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+_0x25cd43(0x199)+_0x42db6b);const _0x5427cc=utils[_0x25cd43(0x213)](_0x336996);try{delete _0x5427cc['groups'];!_0x5427cc[_0x25cd43(0x1b3)]&&_0x7053b2['generateUserPassword']&&_0x7053b2[_0x25cd43(0x1f0)]===!![]&&(_0x5427cc['password']=utils[_0x25cd43(0x1cb)](0xf));if(_0x5daa3e||_0x2d3fc6){if(_0x5daa3e)for(const _0x5c8713 in _0x5daa3e){_0x5427cc[_0x5c8713]=_0x5daa3e[_0x5c8713];}if(_0x2d3fc6)_0x5427cc['id']=_0x2d3fc6;await _0x330646(_0x480445,_0x5427cc);}await _0x537f3d[_0x25cd43(0x187)](_0x480445,_0x5427cc),_0x336996[_0x25cd43(0x243)]&&Array['isArray'](_0x336996[_0x25cd43(0x243)])&&_0x336996['groups'][_0x25cd43(0x272)]>0x0&&(_0x3832d3=await _0x541b8d(_0x480445,_0x25cd43(0x1ca),_0x42db6b));}catch(_0x51a9ad){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](_0x4130aa+_0x25cd43(0x1bc)+JSON[_0x25cd43(0x184)](_0x5427cc)+_0x25cd43(0x264)+_0x51a9ad['message']+'}'),_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}}if(_0x55f236||_0x3832d3){if(_0x2cb762[_0x25cd43(0x260)]===_0x25cd43(0x1c2)){if(_0x7053b2['modifyOnly']&&_0x7053b2[_0x25cd43(0x1b0)]===!![]){_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+'\x20Delete\x20User\x20id='+_0x55f236+_0x25cd43(0x1bf)),_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}_0x537f3d['logger'][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x239)+_0x55f236);try{await _0x537f3d[_0x25cd43(0x1c2)](_0x480445,_0x55f236);}catch(_0x387e80){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](_0x4130aa+'\x20Delete\x20User\x20id='+_0x55f236+'\x20error:\x20'+_0x387e80['message']+'}'),_0x537f3d['logger'][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}}else{if(_0x3832d3)_0x55f236=_0x3832d3;_0x537f3d['logger'][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x27e)+_0x55f236);const _0x521932={};_0x521932[_0x25cd43(0x20f)]=()=>{},_0x521932[_0x25cd43(0x1de)]={},_0x521932[_0x25cd43(0x1de)][_0x25cd43(0x268)]=_0x480445,_0x521932[_0x25cd43(0x1de)]['id']=_0x55f236,_0x521932[_0x25cd43(0x1a1)]={},_0x521932[_0x25cd43(0x1a1)][_0x25cd43(0x1f1)]=_0x480445?'/'+_0x480445+_0x25cd43(0x1b6)+_0x55f236:_0x25cd43(0x1b6)+_0x55f236,_0x521932[_0x25cd43(0x1a1)]['body']=_0x336996;try{await _0x537f3d[_0x25cd43(0x267)](_0x521932,_0x7053b2[_0x25cd43(0x227)]);}catch(_0x238276){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](_0x4130aa+_0x25cd43(0x27e)+_0x55f236+_0x25cd43(0x264)+_0x238276[_0x25cd43(0x245)]),_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}if(_0x521932['status']&&(_0x521932[_0x25cd43(0x261)]<0xc8||_0x521932[_0x25cd43(0x261)]>0x12b)){if(_0x521932['body']){if(_0x521932['body'][_0x25cd43(0x285)]){let _0x310d3f=_0x521932[_0x25cd43(0x1c5)]['detail'];_0x310d3f=_0x310d3f[_0x25cd43(0x219)](_0x537f3d[_0x25cd43(0x290)]+'['+_0x537f3d['pluginName']+']',''+_0x4130aa),_0x537f3d[_0x25cd43(0x1f7)]['error'](''+_0x310d3f);}else{if(_0x521932[_0x25cd43(0x1c5)][_0x25cd43(0x1c3)]&&Array[_0x25cd43(0x21c)](_0x521932[_0x25cd43(0x1c5)]['Errors'])&&_0x521932[_0x25cd43(0x1c5)][_0x25cd43(0x1c3)][_0x25cd43(0x272)]>0x0){let _0x1fd207=_0x521932['body'][_0x25cd43(0x1c3)][0x0][_0x25cd43(0x229)];_0x1fd207=_0x1fd207['replace'](_0x537f3d[_0x25cd43(0x290)]+'['+_0x537f3d[_0x25cd43(0x188)]+']',''+_0x4130aa),_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](''+_0x1fd207);}}}}if(_0x7053b2['usePutSoftSync']){const [_0x442687,_0x41004f]=_0x537f3d['convertedScim20']({'Operations':_0x2cb762[_0x25cd43(0x1ba)]});if(_0x41004f){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](_0x4130aa+_0x25cd43(0x27e)+_0x55f236+_0x25cd43(0x224)+_0x41004f[_0x25cd43(0x245)]),_0x537f3d['logger'][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);return;}const _0x4bb594=[];if(_0x442687[_0x25cd43(0x26f)]&&Array[_0x25cd43(0x21c)](_0x442687[_0x25cd43(0x26f)]))for(let _0xace4a5=0x0;_0xace4a5<_0x442687['roles'][_0x25cd43(0x272)];_0xace4a5++){_0x442687[_0x25cd43(0x26f)][_0xace4a5][_0x25cd43(0x201)]&&_0x442687['roles'][_0xace4a5][_0x25cd43(0x201)]==='delete'&&_0x4bb594[_0x25cd43(0x1f5)](_0x442687['roles'][_0xace4a5]);}if(_0x4bb594[_0x25cd43(0x272)]>0x0)try{await _0x537f3d[_0x25cd43(0x18b)](_0x480445,_0x55f236,{'roles':_0x4bb594});}catch(_0x43a649){_0x537f3d[_0x25cd43(0x1f7)]['error'](_0x4130aa+_0x25cd43(0x27e)+_0x55f236+_0x25cd43(0x269)+_0x43a649[_0x25cd43(0x245)]);}const _0x206239=[];if(_0x442687[_0x25cd43(0x243)]&&Array[_0x25cd43(0x21c)](_0x442687[_0x25cd43(0x243)]))for(let _0xe3a872=0x0;_0xe3a872<_0x442687[_0x25cd43(0x243)][_0x25cd43(0x272)];_0xe3a872++){_0x442687['groups'][_0xe3a872][_0x25cd43(0x201)]&&_0x442687[_0x25cd43(0x243)][_0xe3a872][_0x25cd43(0x201)]===_0x25cd43(0x19d)&&_0x206239[_0x25cd43(0x1f5)](_0x442687[_0x25cd43(0x243)][_0xe3a872]);}if(_0x206239[_0x25cd43(0x272)]>0x0)for(let _0x4eecdc=0x0;_0x4eecdc<_0x206239[_0x25cd43(0x272)];_0x4eecdc++){try{await _0x537f3d[_0x25cd43(0x28e)](_0x480445,_0x206239[_0x4eecdc]['id'],{'members':[{'operation':_0x25cd43(0x19d),'value':_0x55f236}]});}catch(_0x1cd8f1){_0x537f3d['logger'][_0x25cd43(0x28c)](_0x4130aa+_0x25cd43(0x27e)+_0x55f236+_0x25cd43(0x215)+_0x1cd8f1[_0x25cd43(0x245)]);}}}if(_0x7053b2[_0x25cd43(0x220)]&&_0x2cb762[_0x25cd43(0x260)]==='modifyUser'){if(_0x336996[_0x25cd43(0x243)]&&Array[_0x25cd43(0x21c)](_0x336996[_0x25cd43(0x243)])&&_0x336996[_0x25cd43(0x243)][_0x25cd43(0x272)]===0x0){if(_0x336996[_0x25cd43(0x26f)]&&Array[_0x25cd43(0x21c)](_0x336996[_0x25cd43(0x26f)])&&_0x336996[_0x25cd43(0x26f)]['length']===0x0){if(_0x2cb762[_0x25cd43(0x1ba)]&&Array[_0x25cd43(0x21c)](_0x2cb762[_0x25cd43(0x1ba)])&&_0x2cb762[_0x25cd43(0x1ba)][_0x25cd43(0x272)]>0x0){let _0x2ebd5d=![];for(let _0x480744=0x0;_0x480744<_0x2cb762[_0x25cd43(0x1ba)][_0x25cd43(0x272)];_0x480744++){const _0x444c03=_0x2cb762[_0x25cd43(0x1ba)][_0x480744];if(_0x444c03['op']===_0x25cd43(0x259)){if(_0x444c03[_0x25cd43(0x211)]){if(_0x444c03[_0x25cd43(0x211)][_0x25cd43(0x1a5)](_0x25cd43(0x26f))&&_0x444c03['typeId']){_0x2ebd5d=!![];break;}else{if(_0x444c03[_0x25cd43(0x211)]==='groups'){_0x2ebd5d=!![];break;}}}}}if(_0x2ebd5d){_0x537f3d['logger']['debug'](_0x4130aa+'\x20Delete\x20User\x20id='+_0x55f236);try{await _0x537f3d[_0x25cd43(0x1c2)](_0x480445,_0x55f236);}catch(_0x5ecbdd){_0x537f3d['logger']['error'](_0x4130aa+_0x25cd43(0x239)+_0x55f236+_0x25cd43(0x264)+_0x5ecbdd[_0x25cd43(0x245)]+'}'),_0x537f3d[_0x25cd43(0x1f7)]['debug'](_0x4130aa+'\x20done'+_0x31d159);return;}}}}}}}}_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x274)](_0x4130aa+_0x25cd43(0x1af)+_0x31d159);}catch(_0x4a503b){_0x537f3d[_0x25cd43(0x1f7)][_0x25cd43(0x28c)](_0x537f3d[_0x25cd43(0x290)]+'['+_0x537f3d[_0x25cd43(0x188)]+_0x25cd43(0x1df)+_0x480445+']['+_0x244d41+_0x25cd43(0x280)+_0x4a503b[_0x25cd43(0x245)]+_0x25cd43(0x286)+_0x31d159);}},_0x21bf38=nats[_0x400a3e(0x1d7)](),_0x4d7e36=_0x729267[_0x400a3e(0x18d)](),_0x244b53=(_0x400a3e(0x1d5)+_0x537f3d['pluginName']+'_'+_0x480445)[_0x400a3e(0x207)]('*','#')[_0x400a3e(0x207)]('>','##')[_0x400a3e(0x207)]('.','_'),_0x4e6303=_0x244d41[_0x400a3e(0x190)]('.')[0x0][_0x400a3e(0x22a)]()==='GW',_0x4daff8=async()=>{const _0x50092a=_0x400a3e;try{let _0xe069dc;const _0x57589b=''+_0x7053b2?.[_0x50092a(0x266)]?.[_0x50092a(0x284)],_0x4b30e4=await _0x729267['jetstreamManager'](),_0x2c0120=async()=>{const _0x3e7d96=_0x50092a;let _0x231409;try{_0x231409=await _0x4d7e36['consumers'][_0x3e7d96(0x230)](_0x57589b,_0x244b53);}catch(_0x3d6881){const _0x212d9d={'durable_name':_0x244b53,'deliver_policy':nats[_0x3e7d96(0x247)][_0x3e7d96(0x22d)],'ack_policy':nats['AckPolicy'][_0x3e7d96(0x240)],'filter_subject':_0x244d41};await _0x4b30e4[_0x3e7d96(0x19a)][_0x3e7d96(0x21e)](_0x57589b,_0x212d9d),_0x231409=await _0x4d7e36[_0x3e7d96(0x19a)][_0x3e7d96(0x230)](_0x57589b,_0x244b53);}if(_0x231409?.[_0x3e7d96(0x1ac)]?.[_0x3e7d96(0x20e)]?.['deliver_policy']!==_0x3e7d96(0x24a))throw new Error(_0x3e7d96(0x191));_0x231409?.[_0x3e7d96(0x1ac)]?.[_0x3e7d96(0x20e)]?.['filter_subject']!==_0x244d41&&(await _0x4b30e4['consumers'][_0x3e7d96(0x253)](_0x57589b,_0x244b53,{'filter_subject':_0x244d41}),_0x231409=await _0x4d7e36['consumers'][_0x3e7d96(0x230)](_0x57589b,_0x244b53)),_0xe069dc=await _0x231409['consume']({'max_messages':0x64}),_0x4bcd1f(_0xe069dc);},_0x4bcd1f=async _0x30c6f6=>{const _0x426f00=_0x50092a;for await(const _0x27a8ba of await _0x30c6f6[_0x426f00(0x261)]()){switch(_0x27a8ba[_0x426f00(0x263)]){case nats[_0x426f00(0x1ed)][_0x426f00(0x1a0)]:_0x537f3d[_0x426f00(0x1f7)][_0x426f00(0x254)](_0x537f3d['gwName']+'['+_0x537f3d[_0x426f00(0x188)]+_0x426f00(0x1df)+_0x480445+']['+_0x244d41+']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20'+_0x27a8ba['type']),_0x2c0120();return;}}};await _0x2c0120();let _0x394909=-0x1;do{for await(const _0x44ad3b of _0xe069dc){if(!_0x44ad3b[_0x50092a(0x1ce)]||!_0x44ad3b[_0x50092a(0x1ce)][_0x50092a(0x230)]('Msg-Id')){_0x44ad3b['ack']();continue;}_0x394909=_0xe069dc[_0x50092a(0x28f)]();const _0x304abb=_0x537f3d[_0x50092a(0x290)]+'['+_0x537f3d['pluginName']+']\x20subscriber['+_0x480445+']['+_0x44ad3b[_0x50092a(0x192)]+']['+_0x394909+']['+(_0x44ad3b[_0x50092a(0x1ce)]?_0x44ad3b['headers'][_0x50092a(0x230)](_0x50092a(0x1f9)):'')+']',_0x2808b3=_0x21bf38[_0x50092a(0x282)](_0x44ad3b['data']),_0x563c25=await _0x364445(_0x304abb,_0x2808b3);if(!_0x563c25||_0x563c25!==!![])_0x44ad3b[_0x50092a(0x1b9)]();else _0x537f3d[_0x50092a(0x1f7)][_0x50092a(0x28c)](_0x304abb+'\x20subscriber\x20error:\x20scimgateway\x20endpoint\x20connect\x20problem\x20-\x20will\x20do\x20auto\x20retry\x20until\x20connected');if(_0x394909<0x1)break;}}while(_0x394909===0x0);}catch(_0x36a4ad){_0x537f3d[_0x50092a(0x1f7)][_0x50092a(0x28c)](_0x537f3d[_0x50092a(0x290)]+'['+_0x537f3d[_0x50092a(0x188)]+_0x50092a(0x1df)+_0x480445+']['+_0x244d41+_0x50092a(0x1bd)+_0x36a4ad[_0x50092a(0x245)]);}},_0x4ed049=async()=>{const _0x1db6ce=_0x400a3e,_0x43df81=_0x729267['subscribe'](_0x244d41,{'max':0x64});for await(const _0x20e581 of _0x43df81){if(!_0x20e581['headers']||!_0x20e581[_0x1db6ce(0x1ce)][_0x1db6ce(0x230)](_0x1db6ce(0x1f9)))continue;let _0x529a55,_0x503e5f;try{try{_0x529a55=JSON[_0x1db6ce(0x196)](_0x20e581[_0x1db6ce(0x222)]());}catch(_0x566396){const _0x4f7b1f='subscriber\x20message\x20error:\x20message\x20not\x20JSON\x20formatted';_0x537f3d[_0x1db6ce(0x1f7)]['error'](_0x537f3d[_0x1db6ce(0x290)]+'['+_0x537f3d[_0x1db6ce(0x188)]+_0x1db6ce(0x1df)+_0x480445+']['+_0x244d41+']\x20'+_0x4f7b1f+':\x20'+_0x20e581[_0x1db6ce(0x222)]());throw new Error(_0x4f7b1f);}if(!_0x529a55||!_0x529a55['handle']){const _0x4bdbeb=_0x1db6ce(0x23b);_0x537f3d[_0x1db6ce(0x1f7)][_0x1db6ce(0x28c)](_0x537f3d[_0x1db6ce(0x290)]+'['+_0x537f3d[_0x1db6ce(0x188)]+_0x1db6ce(0x1df)+_0x480445+']['+_0x244d41+']\x20'+_0x4bdbeb+':\x20'+_0x529a55);throw new Error(_0x4bdbeb);}!Object['prototype']['hasOwnProperty']['call'](_0x529a55,'baseEntity')&&(_0x529a55['baseEntity']='undefined');if(_0x529a55['baseEntity']!==_0x480445){const _0x1bc4b0=_0x1db6ce(0x1fa)+_0x529a55['baseEntity']+_0x1db6ce(0x251)+_0x480445;_0x537f3d[_0x1db6ce(0x1f7)][_0x1db6ce(0x28c)](_0x537f3d[_0x1db6ce(0x290)]+'['+_0x537f3d['pluginName']+_0x1db6ce(0x1df)+_0x480445+']['+_0x244d41+']\x20'+_0x1bc4b0);throw new Error(_0x1bc4b0);}_0x503e5f=_0x537f3d['gwName']+'['+_0x537f3d['pluginName']+_0x1db6ce(0x1df)+_0x480445+']['+_0x20e581[_0x1db6ce(0x192)]+']['+(_0x20e581[_0x1db6ce(0x1ce)]?_0x20e581[_0x1db6ce(0x1ce)]['get']('Msg-Id'):'')+']',_0x537f3d['logger'][_0x1db6ce(0x274)](_0x503e5f+'\x20processing\x20incoming\x20message');const _0x2494df={};let _0x8efe46,_0x2a5573;switch(_0x529a55['handle']){case _0x1db6ce(0x1ae):_0x8efe46=await _0x537f3d[_0x529a55['handle']](_0x480445,_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1eb)],_0x529a55['ctxPassThrough']);if(Array[_0x1db6ce(0x21c)](_0x8efe46?.[_0x1db6ce(0x233)])){if(_0x529a55?.['attributes']?.[_0x1db6ce(0x272)]===0x0||_0x529a55?.[_0x1db6ce(0x1eb)]?.[_0x1db6ce(0x27f)](_0x1db6ce(0x243)))for(let _0x447865=0x0;_0x447865<_0x8efe46[_0x1db6ce(0x233)][_0x1db6ce(0x272)];_0x447865++){const _0x377eb8=_0x8efe46[_0x1db6ce(0x233)][_0x447865];if(!_0x377eb8['id'])break;if(_0x377eb8[_0x1db6ce(0x243)])break;_0x377eb8[_0x1db6ce(0x243)]=await _0x537f3d['getMemberOf'](_0x480445,_0x377eb8['id'],_0x1db6ce(0x202),_0x529a55[_0x1db6ce(0x1e6)]);}}break;case'getGroups':_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1eb)],_0x529a55['ctxPassThrough']);break;case _0x1db6ce(0x187):_0x8efe46=await _0x537f3d[_0x529a55['handle']](_0x480445,_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1e6)]);break;case _0x1db6ce(0x1da):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1e6)]);break;case'deleteUser':_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['id'],_0x529a55['ctxPassThrough']);break;case _0x1db6ce(0x28b):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['id'],_0x529a55[_0x1db6ce(0x1e6)]);break;case _0x1db6ce(0x18b):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['id'],_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1e6)]);break;case _0x1db6ce(0x28e):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['id'],_0x529a55['obj'],_0x529a55[_0x1db6ce(0x1e6)]);break;case _0x1db6ce(0x267):_0x2494df[_0x1db6ce(0x20f)]=()=>{},_0x2494df['params']={},_0x2494df[_0x1db6ce(0x1de)][_0x1db6ce(0x268)]=_0x480445,_0x2494df[_0x1db6ce(0x1de)]['id']=_0x529a55['id'],_0x2494df['request']={},_0x2494df[_0x1db6ce(0x1a1)]['originalUrl']=_0x529a55[_0x1db6ce(0x1f1)],_0x2494df['request']['body']=_0x529a55['obj'],_0x2494df[_0x1db6ce(0x271)]=_0x529a55['ctxPassThrough'],_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x2494df);break;case _0x1db6ce(0x1dc):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['obj'],_0x529a55['ctxPassThrough']);break;case _0x1db6ce(0x26e):_0x8efe46=await _0x537f3d[_0x529a55['handle']](_0x480445,_0x529a55['id'],_0x529a55[_0x1db6ce(0x1ee)],_0x529a55['ctxPassThrough']);break;case _0x1db6ce(0x265):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['id'],_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1e6)]);break;case _0x1db6ce(0x246):_0x8efe46=await _0x537f3d[_0x529a55[_0x1db6ce(0x1c7)]](_0x480445,_0x529a55['id'],_0x529a55[_0x1db6ce(0x1ab)],_0x529a55[_0x1db6ce(0x1ee)],_0x529a55[_0x1db6ce(0x1e6)]);break;case _0x1db6ce(0x21b):_0x8efe46=await _0x537f3d[_0x529a55['handle']](_0x480445,_0x529a55['id'],_0x529a55[_0x1db6ce(0x1e6)]);break;default:_0x2a5573=_0x1db6ce(0x1e1)+_0x529a55['handle']+'\x27\x20not\x20supported',_0x537f3d['logger'][_0x1db6ce(0x28c)](_0x537f3d[_0x1db6ce(0x290)]+'['+_0x537f3d[_0x1db6ce(0x188)]+_0x1db6ce(0x1df)+_0x480445+']['+_0x244d41+']\x20'+_0x2a5573);throw new Error(_0x2a5573);}if(!_0x8efe46)_0x8efe46=null;const _0x578aaa=JSON[_0x1db6ce(0x184)](_0x8efe46);_0x20e581[_0x1db6ce(0x1ad)](_0x578aaa),_0x537f3d[_0x1db6ce(0x1f7)][_0x1db6ce(0x254)](_0x503e5f+_0x1db6ce(0x281)+_0x529a55[_0x1db6ce(0x1c7)]+_0x1db6ce(0x212)+(_0x529a55[_0x1db6ce(0x1ee)]?JSON[_0x1db6ce(0x184)](_0x529a55[_0x1db6ce(0x1ee)]):'')+_0x1db6ce(0x20d)+(_0x529a55['id']?_0x529a55['id']:'')+',\x20attributes='+(_0x529a55[_0x1db6ce(0x1eb)]?_0x529a55[_0x1db6ce(0x1eb)]:'')+_0x1db6ce(0x228)+_0x578aaa+_0x31d159);}catch(_0x249f0f){const _0x30a010=_0x1db6ce(0x23a)+_0x249f0f[_0x1db6ce(0x245)]+_0x1db6ce(0x197)+_0x249f0f[_0x1db6ce(0x1c9)]+'\x22}';_0x20e581[_0x1db6ce(0x1ad)](_0x30a010),_0x537f3d[_0x1db6ce(0x1f7)][_0x1db6ce(0x254)]((_0x503e5f||'')+'\x20message\x20handled:\x20'+_0x529a55[_0x1db6ce(0x1c7)]+_0x1db6ce(0x212)+(_0x529a55[_0x1db6ce(0x1ee)]?JSON[_0x1db6ce(0x184)](_0x529a55['obj']):'')+_0x1db6ce(0x20d)+(_0x529a55['id']?_0x529a55['id']:'')+_0x1db6ce(0x22e)+(_0x529a55[_0x1db6ce(0x1eb)]?_0x529a55[_0x1db6ce(0x1eb)]:'')+_0x1db6ce(0x1ef)+_0x30a010+_0x31d159);}}};if(_0x4e6303)_0x4ed049();else _0x4daff8();},_0x540ef0=async(_0x57c085,_0x4da78a)=>{const _0x11c1d7=_0x13eeb0,_0x5e98e8=_0x44009d[_0x57c085][_0x11c1d7(0x20e)]?.['nats']?.['subject'];let _0x3bfd6d=0x0;for await(const _0x4a539c of _0x4da78a[_0x11c1d7(0x261)]()){switch(_0x4a539c[_0x11c1d7(0x263)]){case nats[_0x11c1d7(0x1e5)][_0x11c1d7(0x1a9)]:_0x537f3d[_0x11c1d7(0x1f7)][_0x11c1d7(0x28c)](_0x537f3d[_0x11c1d7(0x290)]+'['+_0x537f3d[_0x11c1d7(0x188)]+_0x11c1d7(0x1df)+_0x57c085+']['+_0x5e98e8+_0x11c1d7(0x1a6)+_0x4a539c['data']+_0x11c1d7(0x1a2)),_0x3bfd6d=0x0;break;case nats[_0x11c1d7(0x1e5)][_0x11c1d7(0x206)]:_0x537f3d[_0x11c1d7(0x1f7)][_0x11c1d7(0x254)](_0x537f3d[_0x11c1d7(0x290)]+'['+_0x537f3d['pluginName']+_0x11c1d7(0x1df)+_0x57c085+']['+_0x5e98e8+_0x11c1d7(0x25d)+_0x4a539c[_0x11c1d7(0x19c)]);break;case nats['Events'][_0x11c1d7(0x23d)]:_0x537f3d[_0x11c1d7(0x1f7)][_0x11c1d7(0x28c)](_0x537f3d[_0x11c1d7(0x290)]+'['+_0x537f3d[_0x11c1d7(0x188)]+_0x11c1d7(0x1df)+_0x57c085+']['+_0x5e98e8+_0x11c1d7(0x1a8)+_0x4a539c[_0x11c1d7(0x19c)]);break;case nats[_0x11c1d7(0x1cf)][_0x11c1d7(0x292)]:_0x3bfd6d+=0x1;_0x3bfd6d%0x1e===0x0&&_0x537f3d[_0x11c1d7(0x1f7)][_0x11c1d7(0x274)](_0x537f3d[_0x11c1d7(0x290)]+'['+_0x537f3d[_0x11c1d7(0x188)]+']\x20subscriber['+_0x57c085+']['+_0x5e98e8+']\x20client\x20is\x20attempting\x20to\x20reconnect\x20'+_0x4a539c['data']+'\x20(count='+_0x3bfd6d+')');break;case nats[_0x11c1d7(0x1cf)]['StaleConnection']:_0x537f3d[_0x11c1d7(0x1f7)][_0x11c1d7(0x274)](_0x537f3d[_0x11c1d7(0x290)]+'['+_0x537f3d[_0x11c1d7(0x188)]+_0x11c1d7(0x1df)+_0x57c085+']['+_0x5e98e8+']\x20client\x20has\x20a\x20stale\x20connection\x20'+_0x4a539c[_0x11c1d7(0x19c)]);break;}}};process['on'](_0x13eeb0(0x234),async()=>{const _0x5a8ada=_0x13eeb0;for(const _0x2dec12 in _0x44009d){_0x44009d[_0x2dec12]['nc']&&!_0x44009d[_0x2dec12]['nc']['isClosed']()&&await _0x44009d[_0x2dec12]['nc'][_0x5a8ada(0x277)]();}}),process['on'](_0x13eeb0(0x1d8),async()=>{const _0x3dc5bf=_0x13eeb0;for(const _0x449a12 in _0x44009d){_0x44009d[_0x449a12]['nc']&&!_0x44009d[_0x449a12]['nc'][_0x3dc5bf(0x1b5)]()&&await _0x44009d[_0x449a12]['nc'][_0x3dc5bf(0x277)]();}});const _0x541b8d=async(_0x2080a4,_0x3a3831,_0x2cacb8)=>{const _0x587c09=_0x13eeb0,_0x1b746d={'attribute':_0x3a3831,'operator':'eq','value':_0x2cacb8,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0x5bdf5c=[_0x3a3831];if(_0x3a3831!=='id')_0x5bdf5c[_0x587c09(0x1f5)]('id');try{const _0xdaf98f=await _0x537f3d[_0x587c09(0x1ae)](_0x2080a4,_0x1b746d,_0x5bdf5c);if(!_0xdaf98f||!_0xdaf98f[_0x587c09(0x233)]||!Array[_0x587c09(0x21c)](_0xdaf98f[_0x587c09(0x233)]))throw new Error(_0x587c09(0x226)+JSON['stringify'](_0x1b746d)+_0x587c09(0x1a3));if(_0xdaf98f[_0x587c09(0x233)][_0x587c09(0x272)]===0x0)return null;else{if(_0xdaf98f[_0x587c09(0x233)]['length']>0x2)throw new Error(_0x587c09(0x226)+JSON[_0x587c09(0x184)](_0x1b746d)+_0x587c09(0x1d2));else{const _0x311311=_0xdaf98f[_0x587c09(0x233)][0x0];if(!_0x311311['id'])throw new Error(_0x587c09(0x226)+JSON['stringify'](_0x1b746d)+_0x587c09(0x27d)+JSON['stringify'](_0x311311)+_0x587c09(0x252));return decodeURIComponent(_0x311311['id']);}}}catch(_0x10e3c0){throw new Error(_0x587c09(0x226)+JSON['stringify'](_0x1b746d)+_0x587c09(0x264)+_0x10e3c0[_0x587c09(0x245)]+'}');}},_0x2c4b42=_0xafda40=>{const _0x13ac20=_0x13eeb0;if(!_0xafda40||typeof _0xafda40!==_0x13ac20(0x222))return[null,null];_0xafda40=_0xafda40['trim']();const _0x2c8497=_0xafda40[_0x13ac20(0x1fc)]('(');if(_0x2c8497<0x1)return[null,null];if(_0xafda40[_0x13ac20(0x19f)](_0xafda40[_0x13ac20(0x272)]-0x1)!==')')return[null,null];if(_0x299645(_0xafda40,'(')!==_0x299645(_0xafda40,')'))return[null,null];const _0x30d5d1=_0xafda40['substring'](0x0,_0x2c8497),_0x12027=_0xafda40[_0x13ac20(0x19f)](_0x2c8497+0x1,_0xafda40[_0x13ac20(0x272)]-0x1);let _0x5e0a7c=[];const _0x4a67b5=_0x12027[_0x13ac20(0x190)](',');let _0x49ed15='';for(let _0x200dce=0x0;_0x200dce<_0x4a67b5[_0x13ac20(0x272)];_0x200dce++){const _0x1b1228=_0x49ed15?_0x49ed15+','+_0x4a67b5[_0x200dce]:_0x4a67b5[_0x200dce],_0xeada22=_0x299645(_0x1b1228,'('),_0x5a5e44=_0x299645(_0x1b1228,')');if(_0xeada22===_0x5a5e44)_0x5e0a7c[_0x13ac20(0x1f5)](_0x16001b(_0x1b1228,'\x22')),_0x49ed15='';else{if(_0x49ed15)_0x49ed15+=','+_0x4a67b5[_0x200dce];else _0x49ed15+=_0x4a67b5[_0x200dce];}}if(_0x5e0a7c[_0x13ac20(0x272)]===0x0)_0x5e0a7c=null;return[_0x30d5d1,_0x5e0a7c];};function _0x299645(_0x19ecca,_0x5e461c){const _0x2cf078=_0x13eeb0;let _0x34817c=0x0;for(let _0x1002c7=0x0;_0x1002c7<_0x19ecca[_0x2cf078(0x272)];_0x1002c7++){_0x19ecca[_0x2cf078(0x1bb)](_0x1002c7)===_0x5e461c&&(_0x34817c+=0x1);}return _0x34817c;}const _0x16001b=(_0x12c093,_0x497878)=>{const _0x3f4921=_0x13eeb0;if(typeof _0x12c093!=='string'||typeof _0x497878!==_0x3f4921(0x222))return _0x12c093;if(_0x12c093[_0x3f4921(0x272)]===0x1)return _0x12c093;if(_0x497878['length']!==0x1)return _0x12c093;return _0x12c093=_0x12c093[_0x3f4921(0x223)](),_0x12c093[_0x3f4921(0x19f)](0x0,0x1)===_0x497878&&(_0x12c093=_0x12c093[_0x3f4921(0x19f)](0x1)),_0x12c093['substring'](_0x12c093[_0x3f4921(0x272)]-0x1)===_0x497878&&(_0x12c093=_0x12c093['substring'](0x0,_0x12c093[_0x3f4921(0x272)]-0x1)),_0x12c093;},_0x3cf708=async(_0x54f015,_0x1ecdc2,_0x5afd27,_0x4d46d7)=>{const _0x4af554=_0x13eeb0;if(!_0x1ecdc2||!_0x5afd27||!_0x4d46d7)return null;const [_0x254fa3,_0x1f07df]=_0x2c4b42(_0x4d46d7);if(!_0x254fa3||!_0x1f07df){const _0x361e0b=_0x4d46d7[_0x4af554(0x190)]('(');if(_0x361e0b[_0x4af554(0x272)]>0x1){const _0x172ac7=[_0x4af554(0x1c0),'uppercase',_0x4af554(0x23c),'elementnumber',_0x4af554(0x250),_0x4af554(0x219),_0x4af554(0x27c),_0x4af554(0x1d6),'getuniquevalue'],_0x48db35=_0x361e0b[0x0][_0x4af554(0x257)]();if(_0x172ac7[_0x4af554(0x27f)](_0x48db35))return null;}return _0x4d46d7;}for(let _0x5dca60=0x0;_0x5dca60<_0x1f07df['length'];_0x5dca60++){if(_0x1f07df[_0x5dca60]['substring'](0x0,0x1)==='['){const _0x4192ca=_0x1f07df[_0x5dca60]['indexOf'](']');if(_0x4192ca<0x0)return null;const _0x513362=_0x1f07df[_0x5dca60][_0x4af554(0x19f)](0x1,_0x4192ca),_0x543823=_0x513362[_0x4af554(0x190)]('.');let _0x782b7d;for(let _0xa7f1c8=0x0;_0xa7f1c8<_0x543823[_0x4af554(0x272)];_0xa7f1c8++){if(_0xa7f1c8===0x0)_0x782b7d=_0x1ecdc2[_0x543823[_0xa7f1c8]];else{if(!_0x782b7d)return null;_0x782b7d=_0x782b7d[_0x543823[_0xa7f1c8]];}}if(!_0x782b7d)return null;_0x1f07df[_0x5dca60]=_0x782b7d;}}for(let _0x165c3b=0x0;_0x165c3b<_0x1f07df['length'];_0x165c3b++){const [_0x15e6e8]=_0x2c4b42(_0x1f07df[_0x165c3b]);_0x15e6e8&&(_0x1f07df[_0x165c3b]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x1f07df[_0x165c3b]));}if(_0x1f07df[0x0]===null)return null;switch(_0x254fa3[_0x4af554(0x257)]()){case'lowercase':{if(_0x1f07df['length']!==0x1)return null;const [_0x1d5199]=_0x2c4b42(_0x1f07df[0x0]);if(_0x1d5199)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x1d5199);if(_0x1f07df[0x0]===null)return null;return _0x1f07df[0x0][_0x4af554(0x257)]();}case _0x4af554(0x1ec):{if(_0x1f07df[_0x4af554(0x272)]!==0x1)return null;const [_0xc0c41b]=_0x2c4b42(_0x1f07df[0x0]);if(_0xc0c41b)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0xc0c41b);if(_0x1f07df[0x0]===null)return null;return _0x1f07df[0x0]['toUpperCase']();}case _0x4af554(0x23c):{if(_0x1f07df[_0x4af554(0x272)]!==0x2)return null;const [_0x1d5b70]=_0x2c4b42(_0x1f07df[0x0]);if(_0x1d5b70)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x1d5b70);if(_0x1f07df[0x0]===null)return null;if(isNaN(_0x1f07df[0x1]))return null;return _0x1f07df[0x0][_0x4af554(0x19f)](0x0,_0x1f07df[0x1]);}case _0x4af554(0x1b2):{const [_0x14f4d3]=_0x2c4b42(_0x1f07df[0x0]);if(_0x1f07df['length']<0x2)return null;if(_0x14f4d3)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x14f4d3);if(_0x1f07df[0x0]===null)return null;const _0x2d3729=_0x1f07df[0x1];if(isNaN(_0x2d3729))return null;let _0x74ad8e;if(_0x1f07df[_0x4af554(0x272)]===0x3)_0x74ad8e=_0x1f07df[0x0][_0x4af554(0x190)](_0x1f07df[0x2]);else _0x74ad8e=_0x74ad8e=_0x1f07df[0x0][_0x4af554(0x190)]('\x20');if(_0x2d3729<=_0x74ad8e['length'])return _0x74ad8e[_0x2d3729-0x1];else return'';}case _0x4af554(0x219):{const [_0x50ddfb]=_0x2c4b42(_0x1f07df[0x0]);if(_0x50ddfb)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x50ddfb);if(_0x1f07df[0x0]===null)return null;if(_0x1f07df[_0x4af554(0x272)]!==0x3)return null;return _0x1f07df[0x0][_0x4af554(0x207)](_0x1f07df[0x1],_0x1f07df[0x2]);}case _0x4af554(0x27c):{if(_0x1f07df[_0x4af554(0x272)]!==0x1)return null;const [_0x434611]=_0x2c4b42(_0x1f07df[0x0]);if(_0x434611)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x434611);if(_0x1f07df[0x0]===null)return null;return ascii127['foldReplacing'](_0x1f07df[0x0]);}case _0x4af554(0x250):{let _0x1603a3='';for(let _0x37dc30=0x0;_0x37dc30<_0x1f07df['length'];_0x37dc30++){const [_0x8482b5]=_0x2c4b42(_0x1f07df[_0x37dc30]);if(_0x8482b5)_0x1f07df[_0x37dc30]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x8482b5);if(_0x1f07df[_0x37dc30]===null)return null;_0x1603a3+=_0x1f07df[_0x37dc30];}return _0x1603a3;}case _0x4af554(0x1d6):{if(_0x1f07df[_0x4af554(0x272)]>0x2)return null;const [_0x1ea8a6]=_0x2c4b42(_0x1f07df[0x0]);if(_0x1ea8a6)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x1ea8a6);if(_0x1f07df[0x0]===null)return null;const _0x32dba7=parseInt(_0x1f07df[0x0]);if(isNaN(_0x32dba7))return null;let _0x5c69d9=_0x4af554(0x1f2);_0x5c69d9+=','+_0x1f07df[0x0];if(_0x1f07df[_0x4af554(0x272)]===0x2&&_0x1f07df[0x1]['toLowerCase']()===_0x4af554(0x287))_0x5c69d9+=_0x4af554(0x28a);else _0x5c69d9+=',false';return _0x5c69d9+='##',_0x5c69d9;}case _0x4af554(0x208):{if(_0x1f07df[_0x4af554(0x272)]!==0x1)return null;const [_0x169336]=_0x2c4b42(_0x1f07df[0x0]);if(_0x169336)_0x1f07df[0x0]=await _0x3cf708(_0x54f015,_0x1ecdc2,_0x5afd27,_0x169336);if(_0x1f07df[0x0]===null)return null;let _0x1c6efc,_0x3c3a2d=![],_0x31826c='';const _0x477b50=_0x1f07df[0x0][_0x4af554(0x190)]('##');if(_0x477b50[_0x4af554(0x272)]>0x2)for(let _0x1871b0=0x0;_0x1871b0<_0x477b50['length'];_0x1871b0++){if(_0x477b50[_0x1871b0][_0x4af554(0x1a5)](_0x4af554(0x24b))){const _0x8720d8=_0x477b50[_0x1871b0]['split'](',');if(_0x8720d8[_0x4af554(0x272)]<0x2)return null;const _0x2ed7d9=parseInt(_0x8720d8[0x1]);if(isNaN(_0x2ed7d9))return null;_0x31826c='##'+_0x477b50[_0x1871b0]+'##',_0x1c6efc=_0x8720d8[0x1],_0x8720d8[_0x4af554(0x272)]>0x2&&(_0x3c3a2d=_0x8720d8[0x2]['toLowerCase']()===_0x4af554(0x287));}}let _0x47d29b,_0x59c889=0x0,_0x5b4b05=0x0;if(_0x1c6efc){_0x5b4b05=_0x1c6efc[_0x4af554(0x272)],_0x59c889=0xa;for(let _0x1253a1=0x1;_0x1253a1<_0x5b4b05;_0x1253a1++){_0x59c889*=0xa;}_0x59c889-=0x1,_0x47d29b=parseInt(_0x1c6efc);if(isNaN(_0x47d29b))return null;_0x47d29b-=0x1;}else _0x47d29b=0x0;do{_0x47d29b+=0x1;let _0x33a268=_0x1f07df[0x0];if(_0x1c6efc!==undefined&&_0x31826c){let _0x5076ad=_0x47d29b['toString']();while(_0x5076ad[_0x4af554(0x272)]<_0x5b4b05){_0x5076ad='0'+_0x5076ad;}_0x3c3a2d?_0x33a268=_0x33a268['replace'](_0x31826c,_0x5076ad):(_0x33a268=_0x33a268[_0x4af554(0x219)](_0x31826c,''),_0x3c3a2d=!![],_0x47d29b-=0x1);}try{const _0x2342ff=await _0x541b8d(_0x54f015,_0x5afd27,_0x33a268);if(!_0x2342ff)return _0x33a268;}catch(_0x520149){return _0x537f3d[_0x4af554(0x1f7)]['error'](_0x537f3d[_0x4af554(0x290)]+'['+_0x537f3d['pluginName']+']\x20'+_0x254fa3+'\x20getUserId()\x20error:\x20'+_0x520149[_0x4af554(0x245)]),null;}}while(_0x47d29b<_0x59c889);return null;}default:}return null;},_0x330646=async(_0xa5e1b7,_0x554e45)=>{const _0x1a407f=_0x13eeb0;for(const _0x3ec0d3 in _0x554e45){const _0x2880b0=_0x554e45[_0x3ec0d3],[_0x5f4543,_0x47b698]=_0x2c4b42(_0x2880b0);if(_0x5f4543){const _0x13a402=''+_0x3ec0d3,_0x2dfe30=_0x5f4543+'('+_0x47b698[_0x1a407f(0x250)](',')+')',_0x5316ec=await _0x3cf708(_0xa5e1b7,_0x554e45,_0x13a402,_0x2dfe30);if(_0x5316ec===null)delete _0x554e45[_0x3ec0d3];else _0x554e45[_0x3ec0d3]=_0x5316ec;}for(const _0x4c6d5a in _0x2880b0){const _0x193680=_0x2880b0[_0x4c6d5a],[_0x2cd189,_0x190104]=_0x2c4b42(_0x193680);if(_0x2cd189){const _0x471e63=_0x3ec0d3+'.'+_0x4c6d5a,_0x2d9202=_0x2cd189+'('+_0x190104[_0x1a407f(0x250)](',')+')',_0x11a267=await _0x3cf708(_0xa5e1b7,_0x554e45,_0x471e63,_0x2d9202);if(_0x11a267===null)delete _0x2880b0[_0x4c6d5a];else _0x2880b0[_0x4c6d5a]=_0x11a267;}}}return _0x554e45;};},module['exports']['Publisher']=function(_0x55daab){const _0x4fd49a=a0_0x5c3ee8,_0x4b6b32=_0x55daab,_0x41e4ea={},_0x1f0565=async(_0xa59676,_0x3332fe)=>{const _0x4aac05=a0_0x3d9f,_0x37c0ba=_0x41e4ea[_0xa59676]['config']?.['nats']?.[_0x4aac05(0x192)];let _0x1d8120=0x0;for await(const _0x2b19b3 of _0x3332fe[_0x4aac05(0x261)]()){switch(_0x2b19b3['type']){case nats[_0x4aac05(0x1e5)][_0x4aac05(0x1a9)]:_0x4b6b32[_0x4aac05(0x1f7)]['error'](_0x4b6b32['gwName']+'['+_0x4b6b32[_0x4aac05(0x188)]+']\x20publisher['+_0xa59676+']['+_0x37c0ba+']\x20client\x20disconnected\x20'+_0x2b19b3['data']+_0x4aac05(0x1a2)),_0x1d8120=0x0;break;case nats['Events'][_0x4aac05(0x206)]:_0x4b6b32[_0x4aac05(0x1f7)][_0x4aac05(0x254)](_0x4b6b32[_0x4aac05(0x290)]+'['+_0x4b6b32[_0x4aac05(0x188)]+']\x20publisher['+_0xa59676+']['+_0x37c0ba+_0x4aac05(0x25d)+_0x2b19b3[_0x4aac05(0x19c)]);break;case nats[_0x4aac05(0x1e5)]['Error']:_0x4b6b32['logger']['error'](_0x4b6b32[_0x4aac05(0x290)]+'['+_0x4b6b32[_0x4aac05(0x188)]+_0x4aac05(0x185)+_0xa59676+']['+_0x37c0ba+']\x20client\x20error\x20'+_0x2b19b3['data']);break;case nats[_0x4aac05(0x1cf)][_0x4aac05(0x292)]:_0x1d8120+=0x1;_0x1d8120%0x1e===0x0&&_0x4b6b32[_0x4aac05(0x1f7)][_0x4aac05(0x274)](_0x4b6b32[_0x4aac05(0x290)]+'['+_0x4b6b32['pluginName']+_0x4aac05(0x185)+_0xa59676+']['+_0x37c0ba+_0x4aac05(0x18e)+_0x2b19b3[_0x4aac05(0x19c)]+'\x20(count='+_0x1d8120+')');break;case nats['DebugEvents']['StaleConnection']:_0x4b6b32[_0x4aac05(0x1f7)][_0x4aac05(0x274)](_0x4b6b32[_0x4aac05(0x290)]+'['+_0x4b6b32['pluginName']+']\x20publisher['+_0xa59676+']['+_0x37c0ba+_0x4aac05(0x22b)+_0x2b19b3['data']);break;}}},_0x11968e=async(_0x13ccc5,_0xaa5fa3)=>{const _0x5c4223=a0_0x3d9f,_0x3c0c6f=_0x41e4ea[_0x13ccc5][_0x5c4223(0x20e)]?.[_0x5c4223(0x266)]?.[_0x5c4223(0x192)];let _0x5212e8;try{_0x5212e8=await nats[_0x5c4223(0x1b7)](_0xaa5fa3);if(_0x5212e8[_0x5c4223(0x254)][_0x5c4223(0x22f)]!==_0x5c4223(0x24c)){_0x5212e8[_0x5c4223(0x19b)]();return;}_0x41e4ea[_0x13ccc5]['nc']=_0x5212e8,_0x1f0565(_0x13ccc5,_0x5212e8);}catch(_0x11fd8e){_0x4b6b32[_0x5c4223(0x1f7)][_0x5c4223(0x28c)](_0x4b6b32[_0x5c4223(0x290)]+'['+_0x4b6b32['pluginName']+_0x5c4223(0x185)+_0x13ccc5+']['+_0x3c0c6f+_0x5c4223(0x24d)+_0x11fd8e['message']+_0x5c4223(0x214)),_0xaa5fa3[_0x5c4223(0x232)]=!![];try{_0x5212e8=await nats[_0x5c4223(0x1b7)](_0xaa5fa3);if(_0x5212e8[_0x5c4223(0x254)][_0x5c4223(0x22f)]!==_0x5c4223(0x24c)){_0x5212e8[_0x5c4223(0x19b)]();return;}_0x41e4ea[_0x13ccc5]['nc']=_0x5212e8,_0x1f0565(_0x13ccc5,_0x5212e8);}catch(_0x55096b){_0x4b6b32['logger'][_0x5c4223(0x28c)](_0x4b6b32['gwName']+'['+_0x4b6b32[_0x5c4223(0x188)]+']\x20publisher['+_0x13ccc5+']['+_0x3c0c6f+_0x5c4223(0x24d)+_0x55096b[_0x5c4223(0x245)]);return;}}_0x4b6b32[_0x5c4223(0x1f7)][_0x5c4223(0x274)](_0x4b6b32[_0x5c4223(0x290)]+'['+_0x4b6b32['pluginName']+_0x5c4223(0x185)+_0x13ccc5+']['+_0x3c0c6f+']\x20connected\x20'+(_0xaa5fa3[_0x5c4223(0x1d9)]['ca']?_0x5c4223(0x1d9):'')+'\x20'+_0x5212e8[_0x5c4223(0x1e3)]()),_0x5212e8[_0x5c4223(0x21d)]()[_0x5c4223(0x217)](_0x1ab671=>{const _0x38e9e3=_0x5c4223;_0x1ab671&&_0x4b6b32[_0x38e9e3(0x1f7)]['error'](_0x4b6b32[_0x38e9e3(0x290)]+'['+_0x4b6b32['pluginName']+_0x38e9e3(0x185)+_0x13ccc5+']['+_0x3c0c6f+']\x20closed\x20with\x20error:\x20'+_0x1ab671[_0x38e9e3(0x245)]);});};this[_0x4fd49a(0x21e)]=async(_0x3feca1,_0x1e0d46)=>{const _0x664731=_0x4fd49a;if(!_0x1e0d46?.[_0x664731(0x266)]){_0x4b6b32[_0x664731(0x1f7)][_0x664731(0x28c)](_0x4b6b32[_0x664731(0x290)]+'['+_0x4b6b32['pluginName']+_0x664731(0x185)+_0x3feca1+_0x664731(0x27a));return;}if(!_0x1e0d46?.[_0x664731(0x266)]?.[_0x664731(0x284)]){_0x4b6b32[_0x664731(0x1f7)]['error'](_0x4b6b32['gwName']+'['+_0x4b6b32[_0x664731(0x188)]+']\x20publisher['+_0x3feca1+_0x664731(0x1e2));return;}if(!_0x1e0d46?.[_0x664731(0x266)]?.[_0x664731(0x192)]){_0x4b6b32[_0x664731(0x1f7)]['error'](_0x4b6b32['gwName']+'['+_0x4b6b32[_0x664731(0x188)]+_0x664731(0x185)+_0x3feca1+_0x664731(0x270));return;}if(!_0x1e0d46?.[_0x664731(0x266)]?.[_0x664731(0x192)][_0x664731(0x1a5)]('GW.')){_0x4b6b32['logger'][_0x664731(0x28c)](_0x4b6b32[_0x664731(0x290)]+'['+_0x4b6b32[_0x664731(0x188)]+_0x664731(0x185)+_0x3feca1+_0x664731(0x1b1));return;}if(!_0x1e0d46['baseUrls']||!Array['isArray'](_0x1e0d46[_0x664731(0x27b)])||_0x1e0d46[_0x664731(0x27b)][_0x664731(0x272)]<0x1){_0x4b6b32['logger'][_0x664731(0x28c)](_0x4b6b32[_0x664731(0x290)]+'['+_0x4b6b32[_0x664731(0x188)]+_0x664731(0x185)+_0x3feca1+']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls');return;}if(!_0x1e0d46?.[_0x664731(0x1cc)]?.['ca']){_0x4b6b32[_0x664731(0x1f7)]['error'](_0x4b6b32[_0x664731(0x290)]+'['+_0x4b6b32[_0x664731(0x188)]+_0x664731(0x185)+_0x3feca1+_0x664731(0x26d));return;}const _0x150e2f={};try{let _0x4dae74=path[_0x664731(0x250)](_0x4b6b32[_0x664731(0x25f)],_0x664731(0x210),_0x1e0d46?.[_0x664731(0x1cc)]?.['ca']||_0x664731(0x1be));(_0x1e0d46?.[_0x664731(0x1cc)]?.['ca']?.[_0x664731(0x1a5)]('/')||_0x1e0d46?.[_0x664731(0x1cc)]?.['ca']?.[_0x664731(0x27f)]('\x5c'))&&(_0x4dae74=_0x1e0d46[_0x664731(0x1cc)]['ca']),_0x150e2f['ca']=[fs[_0x664731(0x289)](_0x4dae74)],_0x150e2f[_0x664731(0x193)]=!![];}catch(_0x14f918){_0x4b6b32[_0x664731(0x1f7)]['error'](_0x4b6b32[_0x664731(0x290)]+'['+_0x4b6b32[_0x664731(0x188)]+_0x664731(0x185)+_0x3feca1+']\x20initialization\x20certificate\x20error:\x20'+_0x14f918[_0x664731(0x245)]);return;}const _0x5020d5={},_0x164d73=new TextEncoder()[_0x664731(0x1cd)](_0x1e0d46?.['nats']?.['secret']),_0x1e9e74=_0x1e0d46?.['nats']?.[_0x664731(0x256)];_0x5020d5[_0x664731(0x248)]=nats[_0x664731(0x235)](_0x1e9e74,_0x164d73),_0x5020d5['servers']=_0x1e0d46['baseUrls'],_0x5020d5[_0x664731(0x1d9)]=_0x150e2f,_0x5020d5['waitOnFirstConnect']=![],_0x5020d5[_0x664731(0x20a)]=!![],_0x5020d5[_0x664731(0x1e8)]=0x3e8*0xa,_0x5020d5[_0x664731(0x273)]=-0x1,_0x5020d5[_0x664731(0x275)]=0x2*0x3c*0x3e8,_0x5020d5[_0x664731(0x237)]=0x5,_0x5020d5[_0x664731(0x274)]=![],_0x41e4ea[_0x3feca1]={},_0x41e4ea[_0x3feca1][_0x664731(0x20e)]=_0x1e0d46,_0x41e4ea[_0x3feca1]['nc']=undefined,_0x11968e(_0x3feca1,_0x5020d5);};const _0x454ea6=nats[_0x4fd49a(0x1d7)]();this[_0x4fd49a(0x238)]=async _0x2ae9ab=>{const _0x1f405a=_0x4fd49a;let _0x665ef6;try{if(_0x2ae9ab[_0x1f405a(0x20b)]===Object){_0x665ef6=_0x2ae9ab['baseEntity'];if(!_0x665ef6)_0x2ae9ab[_0x1f405a(0x268)]=_0x1f405a(0x288);_0x2ae9ab=JSON[_0x1f405a(0x184)](_0x2ae9ab);}else{const _0x4df1b9=JSON['parse'](_0x2ae9ab);_0x665ef6=_0x4df1b9[_0x1f405a(0x268)];}}catch(_0x2309ca){throw new Error('publisher['+_0x665ef6+_0x1f405a(0x1b8));}if(!_0x41e4ea[_0x665ef6])throw new Error(_0x1f405a(0x21f)+_0x665ef6+']\x20error:\x20missing\x20entity\x20configuration\x20for\x20baseEntity='+_0x665ef6);const _0x19be05=nats[_0x1f405a(0x1ce)]();_0x19be05['append']('Msg-Id',crypto[_0x1f405a(0x283)]());let _0x3c1ee5;try{if(!_0x41e4ea[_0x665ef6]['nc'])throw new Error('publisher\x20not\x20initialized/connected');_0x3c1ee5=await _0x41e4ea[_0x665ef6]['nc'][_0x1f405a(0x1a1)](_0x41e4ea[_0x665ef6][_0x1f405a(0x20e)]?.['nats']?.[_0x1f405a(0x192)],_0x454ea6['encode'](_0x2ae9ab),{'headers':_0x19be05});}catch(_0x2aab16){if(_0x2aab16['message']===_0x1f405a(0x25e))throw new Error(_0x1f405a(0x21f)+_0x665ef6+_0x1f405a(0x1c6)+_0x41e4ea[_0x665ef6][_0x1f405a(0x20e)]?.['nats']?.[_0x1f405a(0x192)]);else throw new Error('publisher['+_0x665ef6+_0x1f405a(0x280)+_0x2aab16[_0x1f405a(0x245)]);}let _0x1e39f7;try{_0x1e39f7=JSON[_0x1f405a(0x196)](_0x3c1ee5['string']());}catch(_0x124251){throw new Error(_0x1f405a(0x1c4)+_0x3c1ee5[_0x1f405a(0x222)]());}if(_0x1e39f7?.[_0x1f405a(0x28c)]){const _0x44a1f0=new Error(_0x1f405a(0x24e)+_0x1e39f7[_0x1f405a(0x28c)]);_0x44a1f0['name']=_0x1e39f7[_0x1f405a(0x258)];throw _0x44a1f0;}return _0x1e39f7;},process['on'](_0x4fd49a(0x234),async()=>{const _0x306bc0=_0x4fd49a;for(const _0x35d92c in _0x41e4ea){_0x41e4ea[_0x35d92c]['nc']&&!_0x41e4ea[_0x35d92c]['nc'][_0x306bc0(0x1b5)]()&&await _0x41e4ea[_0x35d92c]['nc'][_0x306bc0(0x277)]();}}),process['on'](_0x4fd49a(0x1d8),async()=>{const _0x477e33=_0x4fd49a;for(const _0x427ef0 in _0x41e4ea){_0x41e4ea[_0x427ef0]['nc']&&!_0x41e4ea[_0x427ef0]['nc'][_0x477e33(0x1b5)]()&&await _0x41e4ea[_0x427ef0]['nc'][_0x477e33(0x277)]();}});},module[a0_0x5c3ee8(0x242)]['getAppRoles']=async(_0xc0ca12,_0x49f1d1,_0x34d6bf,_0x4fd93e)=>{const _0x579090=a0_0x5c3ee8,_0x5568cf=_0x579090(0x1aa),_0x33eca6=_0xc0ca12;_0x33eca6[_0x579090(0x1f7)][_0x579090(0x274)](_0x33eca6[_0x579090(0x290)]+'['+_0x33eca6[_0x579090(0x188)]+']\x20handling\x20\x22'+_0x5568cf+'\x22');try{if(!fs['existsSync'](_0x33eca6[_0x579090(0x25f)]+'/approles'))fs[_0x579090(0x293)](_0x33eca6[_0x579090(0x25f)]+_0x579090(0x24f));}catch(_0x42a3e8){}const _0x4d3b6f=path[_0x579090(0x250)](''+_0x33eca6['configDir'],_0x579090(0x1a7),_0x579090(0x26c)+_0x33eca6[_0x579090(0x188)]+'_autogenerated.cfg'),_0x3c0845={};utils[_0x579090(0x1d4)](_0x4d3b6f)&&fs[_0x579090(0x289)](_0x4d3b6f,_0x579090(0x255))['split'](/\r?\n/)[_0x579090(0x18f)](_0x2070f0=>{const _0x1ce88f=_0x579090,_0x4a6b1a=_0x2070f0[_0x1ce88f(0x190)]('\x20');_0x4a6b1a[_0x1ce88f(0x272)]===0x2&&(_0x3c0845[_0x4a6b1a[0x0]]=_0x4a6b1a[0x1]);});const _0x4fc3e6=fs[_0x579090(0x23f)](_0x4d3b6f,{'flags':'w','encoding':_0x579090(0x203),'mode':0x1b6,'autoClose':!![]}),_0x3ad8d3=[],_0x44dfe4=await _0x33eca6[_0x579090(0x202)](_0x49f1d1,{'attribute':undefined,'operator':undefined,'value':undefined},['id',_0x579090(0x22c)]);return _0x44dfe4[_0x579090(0x233)][_0x579090(0x18f)](_0x142717=>{const _0x48c8e4=_0x579090;if(_0x142717['id']){let _0x3b8a32=crypto[_0x48c8e4(0x283)]();if(_0x3c0845[_0x142717['id']])_0x3b8a32=_0x3c0845[_0x142717['id']];const _0x30519d={'allowedMemberTypes':[_0x48c8e4(0x1c1)],'description':_0x48c8e4(0x1ea),'displayName':_0x142717[_0x48c8e4(0x22c)]||_0x142717['id'],'id':_0x3b8a32,'isEnabled':!![],'lang':null,'origin':_0x48c8e4(0x276),'value':decodeURIComponent(_0x142717['id'])};_0x3ad8d3['push'](_0x30519d),_0x4fc3e6[_0x48c8e4(0x1f4)](_0x142717['id']+'\x20'+_0x3b8a32+'\x0a');}}),_0x4fc3e6[_0x579090(0x19b)](),_0x33eca6[_0x579090(0x1f7)]['debug'](_0x33eca6[_0x579090(0x290)]+'['+_0x33eca6['pluginName']+_0x579090(0x26a)+_0x4d3b6f),{'Resources':[{'appRoles':_0x3ad8d3}]};};