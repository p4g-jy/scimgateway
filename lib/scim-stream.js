// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          Gateway publishing to SCIM Stream having other gateways as subscribers handling requests
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: scim-stream.js is part of the licensed SCIM Stream which is a prerequisite for message Pub/Sub
//       for details see: https://elshaug.xyz/docs/scim-stream
//
// ================================================================
'use strict';const a0_0x5a0f4d=a0_0xf886;(function(_0x36d8e5,_0x315713){const _0x517080=a0_0xf886,_0x576627=_0x36d8e5();while(!![]){try{const _0x519d96=-parseInt(_0x517080(0x190))/0x1+parseInt(_0x517080(0xf0))/0x2*(parseInt(_0x517080(0x1e0))/0x3)+parseInt(_0x517080(0x188))/0x4*(-parseInt(_0x517080(0xf9))/0x5)+parseInt(_0x517080(0x1ba))/0x6+-parseInt(_0x517080(0x1cd))/0x7+-parseInt(_0x517080(0x19a))/0x8*(parseInt(_0x517080(0x171))/0x9)+parseInt(_0x517080(0x163))/0xa*(parseInt(_0x517080(0xf3))/0xb);if(_0x519d96===_0x315713)break;else _0x576627['push'](_0x576627['shift']());}catch(_0x515151){_0x576627['push'](_0x576627['shift']());}}}(a0_0x2ea7,0x2aa45));function a0_0x2ea7(){const _0x159055=['All','\x20Delete\x20User\x20id=','append','replaceDomains','add','readFileSync',']\x20error:\x20','user','\x20Create\x20userName=','\x20message\x20error\x20response:\x20','Operations','1203918SjEuji','baseEntity','jetstreamManager','userName','usePutSoftSync','server_name','\x22,\x22errName\x22:\x22','undefined','DebugEvents','replace','ConsumerEvents','subscriber\x20message\x20error:\x20message\x20not\x20JSON\x20formatted','call',']\x20closed\x20with\x20error:\x20','passThrough','maxPingOut','drain','normalize','string','1900514reuHHc','startsWith','originalUrl','\x22\x20and\x20awaiting\x20result','apply','ETIMEDOUT','deleteGroup','tenant','handle','subscribe','Disconnect',']\x20client\x20has\x20a\x20stale\x20connection\x20','putApi','{\x22error\x22:\x22','body','ack','_autogenerated.cfg','createWriteStream','Errors','223089afYwXM','exports','delete','active','info','deleteUserOnLastGroupRoleRemoval',']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls','closed','convertedScim20','attributes','publisher\x20response\x20error:\x20','display','SCIM\x20Stream','\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true','\x20message\x20handled:\x20','path',',true','503','nats','configDir','firstn','authenticator','Resources','elementnumber','map',']\x20initialization\x20error:\x20nats.subject\x20root\x20topic\x20must\x20be\x20\x27GW\x27,\x20nats.subject\x20example:\x20GW.APP1','postApi','split','hasOwnProperty','Events','tls',']\x20client\x20disconnected\x20','publisher\x20not\x20initialized/connected','deliver_policy','subscriber\x20message\x20error:\x20handle\x20\x27','operator',']\x20client\x20error\x20','maxReconnectAttempts','\x20with\x20chunks\x20returned\x20errors:\x20','approles_','utf-8','getServer','\x20message\x20json\x20parsing\x20error:\x20','subject','groups','UnableConnectingService','2vSAeAM','uppercase','respond','2266GcgYVa','query','../lib/utils','\x20error:\x20','\x20calling\x20\x22','certificate','20980oVJCBM','status','secret','true','internal\x20stream\x20policy\x20have\x20been\x20changed\x20-\x20central\x20SCIM\x20Stream\x20must\x20be\x20stopped\x20and\x20corresponding\x20./jetstream\x20folder\x20deleted\x20before\x20startup\x20allowing\x20new\x20policy','\x20not\x20equal\x20subscriber\x20configured\x20baseEntity=','onCreate','\x20handling\x20message:\x20','activityOperation','stringify','createUser','rejected','displayName','skipConvertRolesToGroups','pluginName','Msg-Id','detail','deleteApi','increment','ENOTFOUND',']\x20handling\x20\x22','\x20result=','charAt','error','\x20error:\x20missing\x20result','reconnect','set','request',']\x20subscriber[','getGroups','parse','debug','Application','then','trim','Error','DeliverPolicy','rejectUnauthorized','decode','ctxPassThrough','subscriber\x20message\x20error:\x20message\x20missing\x20handle','ECONNREFUSED','subscriber\x20message\x20error:\x20message\x20baseEntity=','name','value','toString','file-not-configured','existsSync','replaceUsrGrp',',\x20attributes=','close','modifyOnly','fold-to-ascii','\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available','pingInterval','false',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject','length','\x20group\x20removal\x20error:\x20','\x20=>\x20subscriber\x20not\x20activated','baseUrls','params','publish','isArray',']\x20initialization\x20certificate\x20error:\x20',']\x20connect\x20error:\x20','modifyUser','roles','Publisher','\x20processing\x20incoming\x20message','randomUUID','transports','constructor','get','/certs/','\x20message:\x20user\x20does\x20not\x20exist','StaleConnection','replaceAll','\x20convertedScim20\x20error:\x20',']\x20error:\x20client\x20have\x20not\x20been\x20initialized',',\x20obj=','logger','durable_','\x20getUserId()\x20error:\x20','endsWith','HR.','getUsers()\x20getObj=','connect','publisher[','_info','gwName','jwtAuthenticator','SIGINT','\x20-\x20',']\x20initialization\x20error:\x20missing\x20certificate\x20configuration','Reconnecting','forEach','\x20role\x20removal\x20error:\x20','remove','attribute','message','createGroup','crypto','\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20','config','data','39460yfkXHm','\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}','lowercase',']\x20error:\x20message\x20must\x20be\x20JSON\x20formatted',']\x20error:\x20missing\x20entity\x20configuration\x20for\x20baseEntity=','\x20or\x20','modifyGroup','patchApi','from','publisher\x20error:\x20none\x20JSON\x20formatted\x20response:\x20','getAppRoles','join','push',']\x20client\x20reconnected\x20','9AhXfJs',']\x20subscriber\x20stopped\x20error:\x20','reconnectTimeWait','/Users/',',false','User','reason','typeId','description','\x20Replace\x20User\x20id=','GW.','update','getuniquevalue','mkdirSync',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant','createRandomPassword',',\x20id=','getProcessed','timeout','Subscriber','substring','operation','encode','68tkHkUo','StringCodec','Reconnect','consumers','deleteUser','jetstream','jwt','password','240866rxIDjD','copyObj','\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true','servers','generateUserPassword','errName','\x20done','prototype','obj','waitOnFirstConnect','2636248Lydkqp',']\x20initialization\x20error:\x20missing\x20configuration\x20nats','getApi','\x27\x20not\x20supported','SCIM\x20Stream\x20-\x20Autogenerated','isClosed','\x20missing\x20user\x20object\x20in\x20message:\x20','getUsers','filter','rawFilter','\x20(count=','includes','toLowerCase',']\x20publisher[','\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration','write',']\x20client\x20is\x20attempting\x20to\x20reconnect\x20','type','approles','headers','##doIncrement'];a0_0x2ea7=function(){return _0x159055;};return a0_0x2ea7();}function a0_0xf886(_0x2718ef,_0x33fc24){const _0x2ea70f=a0_0x2ea7();return a0_0xf886=function(_0xf88642,_0x419fa2){_0xf88642=_0xf88642-0xec;let _0x2b659e=_0x2ea70f[_0xf88642];return _0x2b659e;},a0_0xf886(_0x2718ef,_0x33fc24);}const nats=require('nats'),ascii127=require(a0_0x5a0f4d(0x12d)),fs=require('fs'),utils=require(a0_0x5a0f4d(0xf5)),path=require('path'),crypto=require(a0_0x5a0f4d(0x15f));module[a0_0x5a0f4d(0x1e1)][a0_0x5a0f4d(0x184)]=function(_0x2357df){const _0x4537e7=a0_0x5a0f4d,_0x5bf57b=_0x2357df,_0x40054e={};let _0x3bb6df='';for(let _0x4fde4e=0x0;_0x4fde4e<_0x5bf57b[_0x4537e7(0x14a)][_0x4537e7(0x140)][_0x4537e7(0x132)];_0x4fde4e++){if(_0x5bf57b[_0x4537e7(0x14a)]['transports'][_0x4fde4e][_0x4537e7(0x124)]==='file'){_0x3bb6df=_0x5bf57b[_0x4537e7(0x14a)]['transports'][_0x4fde4e]['level'];break;}}const _0x11f296=''+(_0x3bb6df==='debug'?'\x0a':''),_0x5f3577=async(_0x1fb09c,_0x44ec28)=>{const _0x3f9122=_0x4537e7,_0x250d75=_0x40054e[_0x1fb09c][_0x3f9122(0x161)]?.[_0x3f9122(0x1f2)]?.[_0x3f9122(0xed)];let _0x3292cf;try{_0x3292cf=await nats['connect'](_0x44ec28);if(_0x3292cf[_0x3f9122(0x1e4)][_0x3f9122(0x1bf)]!==_0x3f9122(0x1ec)){_0x3292cf['close']();return;}_0x40054e[_0x1fb09c]['nc']=_0x3292cf,_0x112135(_0x1fb09c,_0x3292cf),_0x51fe46(_0x1fb09c,_0x3292cf);}catch(_0x537c85){_0x5bf57b[_0x3f9122(0x14a)][_0x3f9122(0x110)](_0x5bf57b['gwName']+'['+_0x5bf57b[_0x3f9122(0x107)]+']\x20subscriber['+_0x1fb09c+']['+_0x250d75+_0x3f9122(0x13a)+_0x537c85[_0x3f9122(0x15d)]+_0x3f9122(0x1a8)),_0x44ec28[_0x3f9122(0x199)]=!![];try{_0x3292cf=await nats['connect'](_0x44ec28);if(_0x3292cf['info'][_0x3f9122(0x1bf)]!==_0x3f9122(0x1ec)){_0x3292cf[_0x3f9122(0x12b)]();return;}_0x40054e[_0x1fb09c]['nc']=_0x3292cf,_0x112135(_0x1fb09c,_0x3292cf),_0x51fe46(_0x1fb09c,_0x3292cf);}catch(_0x197d64){_0x5bf57b[_0x3f9122(0x14a)]['error'](_0x5bf57b[_0x3f9122(0x153)]+'['+_0x5bf57b['pluginName']+_0x3f9122(0x115)+_0x1fb09c+']['+_0x250d75+_0x3f9122(0x13a)+_0x197d64[_0x3f9122(0x15d)]);return;}}_0x5bf57b['logger'][_0x3f9122(0x118)](_0x5bf57b[_0x3f9122(0x153)]+'['+_0x5bf57b[_0x3f9122(0x107)]+']\x20subscriber['+_0x1fb09c+']['+_0x250d75+']\x20connected\x20'+(_0x44ec28[_0x3f9122(0x1fe)]['ca']?_0x3f9122(0x1fe):'')+'\x20'+_0x3292cf[_0x3f9122(0x209)]()),_0x3292cf['closed']()[_0x3f9122(0x11a)](_0x55bd2f=>{const _0x408af=_0x3f9122;_0x55bd2f&&_0x5bf57b[_0x408af(0x14a)]['error'](_0x5bf57b[_0x408af(0x153)]+'['+_0x5bf57b[_0x408af(0x107)]+_0x408af(0x115)+_0x1fb09c+']['+_0x250d75+_0x408af(0x1c7)+_0x55bd2f[_0x408af(0x15d)]);});};this[_0x4537e7(0x1b3)]=async(_0x2abce1,_0x461a85)=>{const _0x1e9db3=_0x4537e7;if(!_0x461a85?.[_0x1e9db3(0x1f2)]){_0x5bf57b[_0x1e9db3(0x14a)][_0x1e9db3(0x110)](_0x5bf57b[_0x1e9db3(0x153)]+'['+_0x5bf57b[_0x1e9db3(0x107)]+_0x1e9db3(0x115)+_0x2abce1+_0x1e9db3(0x19b));return;}if(!_0x461a85?.[_0x1e9db3(0x1f2)]?.[_0x1e9db3(0x1d4)]){_0x5bf57b[_0x1e9db3(0x14a)]['error'](_0x5bf57b[_0x1e9db3(0x153)]+'['+_0x5bf57b['pluginName']+']\x20subscriber['+_0x2abce1+_0x1e9db3(0x17f));return;}if(!_0x461a85?.[_0x1e9db3(0x1f2)]?.[_0x1e9db3(0xed)]){_0x5bf57b[_0x1e9db3(0x14a)][_0x1e9db3(0x110)](_0x5bf57b['gwName']+'['+_0x5bf57b['pluginName']+_0x1e9db3(0x115)+_0x2abce1+_0x1e9db3(0x131));return;}if(!_0x461a85?.[_0x1e9db3(0xf8)]?.['ca']){_0x5bf57b[_0x1e9db3(0x14a)][_0x1e9db3(0x110)](_0x5bf57b[_0x1e9db3(0x153)]+'['+_0x5bf57b[_0x1e9db3(0x107)]+']\x20subscriber['+_0x2abce1+_0x1e9db3(0x157));return;}if(!_0x461a85['baseUrls']||!Array[_0x1e9db3(0x138)](_0x461a85[_0x1e9db3(0x135)])||_0x461a85[_0x1e9db3(0x135)][_0x1e9db3(0x132)]<0x1){_0x5bf57b[_0x1e9db3(0x14a)][_0x1e9db3(0x110)](_0x5bf57b[_0x1e9db3(0x153)]+'['+_0x5bf57b[_0x1e9db3(0x107)]+_0x1e9db3(0x115)+_0x2abce1+_0x1e9db3(0x1e6));return;}if(!_0x461a85['usePutSoftSync']){const _0x326534=_0x461a85?.[_0x1e9db3(0x1f2)]?.[_0x1e9db3(0xed)]['toUpperCase']();if(_0x326534[_0x1e9db3(0x1ce)](_0x1e9db3(0x14e)))_0x461a85[_0x1e9db3(0x1be)]=!![];}const _0x11447d={};try{let _0x176b43=path[_0x1e9db3(0x16e)](_0x5bf57b[_0x1e9db3(0x1f3)],_0x1e9db3(0x143),_0x461a85?.[_0x1e9db3(0xf8)]?.['ca']||_0x1e9db3(0x127));(_0x461a85?.[_0x1e9db3(0xf8)]?.['ca']?.[_0x1e9db3(0x1ce)]('/')||_0x461a85?.[_0x1e9db3(0xf8)]?.['ca']?.['includes']('\x5c'))&&(_0x176b43=_0x461a85[_0x1e9db3(0xf8)]['ca']),_0x11447d['ca']=[fs[_0x1e9db3(0x1b4)](_0x176b43)],_0x11447d[_0x1e9db3(0x11e)]=!![];}catch(_0x25c270){_0x5bf57b['logger'][_0x1e9db3(0x110)](_0x5bf57b[_0x1e9db3(0x153)]+'['+_0x5bf57b[_0x1e9db3(0x107)]+_0x1e9db3(0x115)+_0x2abce1+_0x1e9db3(0x139)+_0x25c270[_0x1e9db3(0x15d)]);return;}const _0x5aa348={},_0x3ca3dc=new TextEncoder()['encode'](_0x461a85?.[_0x1e9db3(0x1f2)]?.['secret']),_0x5dc186=_0x461a85?.[_0x1e9db3(0x1f2)]?.[_0x1e9db3(0x18e)];_0x5aa348[_0x1e9db3(0x1f5)]=nats[_0x1e9db3(0x154)](_0x5dc186,_0x3ca3dc),_0x5aa348[_0x1e9db3(0x193)]=_0x461a85['baseUrls'],_0x5aa348[_0x1e9db3(0x1fe)]=_0x11447d,_0x5aa348['waitOnFirstConnect']=![],_0x5aa348['reconnect']=!![],_0x5aa348[_0x1e9db3(0x173)]=0x3e8*0xa,_0x5aa348[_0x1e9db3(0x205)]=-0x1,_0x5aa348[_0x1e9db3(0x12f)]=0x2*0x3c*0x3e8,_0x5aa348[_0x1e9db3(0x1c9)]=0x5,_0x5aa348['debug']=![],_0x40054e[_0x2abce1]={},_0x40054e[_0x2abce1][_0x1e9db3(0x161)]=_0x461a85,_0x40054e[_0x2abce1]['nc']=undefined,_0x40054e[_0x2abce1]['sub']=undefined,_0x5f3577(_0x2abce1,_0x5aa348);};const _0x51fe46=async(_0x286e17,_0x3cb206)=>{const _0x3fe557=_0x4537e7,_0x5ba07d=_0x40054e[_0x286e17][_0x3fe557(0x161)],_0xd917e0=_0x5ba07d?.[_0x3fe557(0x1f2)]?.['subject'];if(!_0x3cb206){_0x5bf57b[_0x3fe557(0x14a)][_0x3fe557(0x110)](_0x5bf57b[_0x3fe557(0x153)]+'['+_0x5bf57b[_0x3fe557(0x107)]+_0x3fe557(0x115)+_0x286e17+']['+_0xd917e0+_0x3fe557(0x148));return;}const _0x328a38=async(_0x2aa401,_0x1387a0)=>{const _0x3495fc=_0x3fe557;try{_0x5bf57b[_0x3495fc(0x14a)]['info'](_0x2aa401+_0x3495fc(0x100)+_0x1387a0);let _0x2a1073;try{if(_0x5ba07d[_0x3495fc(0x1b2)]&&Array[_0x3495fc(0x138)](_0x5ba07d['replaceDomains']))for(let _0x558ee9=0x0;_0x558ee9<_0x5ba07d[_0x3495fc(0x1b2)][_0x3495fc(0x132)];_0x558ee9++){const _0x26ceff=_0x5ba07d[_0x3495fc(0x1b2)][_0x558ee9];if(!_0x26ceff[_0x3495fc(0x16b)]||!_0x26ceff[_0x3495fc(0x16b)]['includes']('.')||!_0x26ceff['to']||!_0x26ceff['to'][_0x3495fc(0x1a5)]('.'))continue;const _0x2408b9=new RegExp('@'+_0x26ceff['from']+'\x22','gi');_0x1387a0=_0x1387a0['replace'](_0x2408b9,'@'+_0x26ceff['to']+'\x22');}_0x2a1073=JSON[_0x3495fc(0x117)](_0x1387a0);}catch(_0x5c2d8a){_0x5bf57b[_0x3495fc(0x14a)]['error'](_0x2aa401+_0x3495fc(0xec)+_0x5c2d8a[_0x3495fc(0x15d)]+'\x20message:\x20'+_0x1387a0),_0x5bf57b['logger']['debug'](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}const _0x4882d9=_0x2a1073[_0x3495fc(0x1b6)];if(!_0x4882d9){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+_0x3495fc(0x1a0)+JSON[_0x3495fc(0x102)](_0x2a1073)),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+'\x20done'+_0x11f296);return;}if(!_0x4882d9[_0x3495fc(0x1bd)]){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+_0x3495fc(0x160)+JSON['stringify'](_0x2a1073)),_0x5bf57b[_0x3495fc(0x14a)]['debug'](_0x2aa401+'\x20done'+_0x11f296);return;}delete _0x4882d9['schemas'];let _0x37329f;_0x4882d9['id']&&(_0x37329f=_0x4882d9['id'],delete _0x4882d9['id']);let _0x53ebf6;_0x4882d9[_0x3495fc(0xff)]&&(_0x53ebf6=utils[_0x3495fc(0x191)](_0x4882d9[_0x3495fc(0xff)]),delete _0x4882d9[_0x3495fc(0xff)]);await _0x560744(_0x286e17,_0x4882d9);const _0x3bf522=_0x4882d9[_0x3495fc(0x1bd)];let _0x4a1f48,_0x4a206d;try{_0x4a1f48=await _0x89d8a4(_0x286e17,_0x3495fc(0x1bd),_0x3bf522);}catch(_0x34fb04){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+_0x3495fc(0x14c)+_0x34fb04['message']),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x196)+_0x11f296);const _0x4603b6=['UnableConnectingHost',_0x3495fc(0xef),_0x3495fc(0x122),_0x3495fc(0x10c),_0x3495fc(0x1d2),_0x3495fc(0x183)];for(const _0x21024a in _0x4603b6){if(_0x34fb04[_0x3495fc(0x15d)][_0x3495fc(0x1a5)](_0x21024a))return!![];}return;}if(!_0x5ba07d[_0x3495fc(0x106)]){let _0x2d0da9=![];if(_0x2a1073[_0x3495fc(0x1b9)]&&Array[_0x3495fc(0x138)](_0x2a1073[_0x3495fc(0x1b9)]))for(let _0x3e40f7=0x0;_0x3e40f7<_0x2a1073[_0x3495fc(0x1b9)][_0x3495fc(0x132)];_0x3e40f7++){const _0x45ac2b=_0x2a1073[_0x3495fc(0x1b9)][_0x3e40f7];_0x45ac2b['path'][_0x3495fc(0x1ce)](_0x3495fc(0x13c))&&(_0x45ac2b[_0x3495fc(0x1ef)]='groups',Array[_0x3495fc(0x138)](_0x45ac2b[_0x3495fc(0x125)])?(_0x45ac2b[_0x3495fc(0x125)][0x0]['id']=_0x45ac2b[_0x3495fc(0x125)][0x0][_0x3495fc(0x125)],_0x45ac2b[_0x3495fc(0x125)][0x0][_0x3495fc(0x1eb)]=_0x45ac2b[_0x3495fc(0x125)][0x0][_0x3495fc(0x1ab)]+_0x3495fc(0x156)+_0x45ac2b[_0x3495fc(0x125)][0x0][_0x3495fc(0x125)],delete _0x45ac2b['value'][0x0]['value'],delete _0x45ac2b[_0x3495fc(0x125)][0x0][_0x3495fc(0x1ab)]):_0x45ac2b[_0x3495fc(0x125)]=[{'id':_0x45ac2b[_0x3495fc(0x125)],'display':_0x45ac2b['value']}],delete _0x45ac2b[_0x3495fc(0x178)],_0x2d0da9=!![]);}if(_0x4882d9['roles']&&Array[_0x3495fc(0x138)](_0x4882d9['roles'])&&_0x4882d9[_0x3495fc(0x13c)][_0x3495fc(0x132)]>0x0){if(!_0x4882d9['groups'])_0x4882d9[_0x3495fc(0xee)]=[];if(!Array[_0x3495fc(0x138)](_0x4882d9[_0x3495fc(0xee)]))_0x4882d9[_0x3495fc(0xee)]=[];for(let _0x120429=0x0;_0x120429<_0x4882d9[_0x3495fc(0x13c)][_0x3495fc(0x132)];_0x120429++){const _0x1b465f={},_0x1a819d=_0x4882d9['roles'][_0x120429];_0x1b465f[_0x3495fc(0x125)]=_0x1a819d[_0x3495fc(0x125)],_0x1b465f[_0x3495fc(0x1eb)]=_0x1a819d[_0x3495fc(0x1ab)]+_0x3495fc(0x156)+_0x1a819d['display'],_0x4882d9[_0x3495fc(0xee)][_0x3495fc(0x16f)](_0x1b465f);}delete _0x4882d9[_0x3495fc(0x13c)],_0x2d0da9=!![];}if(_0x2d0da9)_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+'\x20roles\x20converted\x20to\x20groups:\x20'+JSON[_0x3495fc(0x102)](_0x2a1073));}if(!_0x4a1f48){if(_0x2a1073[_0x3495fc(0x101)]===_0x3495fc(0x18c)){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+'\x20Delete\x20User\x20userName='+_0x3bf522+_0x3495fc(0x144)),_0x5bf57b['logger'][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}if(_0x5ba07d[_0x3495fc(0x12c)]&&_0x5ba07d['modifyOnly']===!![]){_0x5bf57b['logger'][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x1b7)+_0x3bf522+_0x3495fc(0x1ed)),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}if(Object[_0x3495fc(0x197)][_0x3495fc(0x1fc)][_0x3495fc(0x1c6)](_0x4882d9,_0x3495fc(0x1e3))){if(typeof _0x4882d9[_0x3495fc(0x1e3)]===_0x3495fc(0x1cc)){const _0x228c35=_0x4882d9['active'][_0x3495fc(0x1a6)]();if(_0x228c35==='true')_0x4882d9[_0x3495fc(0x1e3)]=!![];else{if(_0x228c35===_0x3495fc(0x130))_0x4882d9[_0x3495fc(0x1e3)]=![];}}if(_0x4882d9[_0x3495fc(0x1e3)]===![]){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+'\x20Create\x20userName='+_0x3bf522+'\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false'),_0x5bf57b['logger'][_0x3495fc(0x118)](_0x2aa401+'\x20done'+_0x11f296);return;}}_0x5bf57b['logger'][_0x3495fc(0x118)](_0x2aa401+'\x20Create\x20User\x20userName='+_0x3bf522);const _0x22a6a8=utils[_0x3495fc(0x191)](_0x4882d9);try{delete _0x22a6a8[_0x3495fc(0xee)];!_0x22a6a8[_0x3495fc(0x18f)]&&_0x5ba07d[_0x3495fc(0x194)]&&_0x5ba07d[_0x3495fc(0x194)]===!![]&&(_0x22a6a8['password']=utils[_0x3495fc(0x180)](0xf));if(_0x53ebf6||_0x37329f){if(_0x53ebf6)for(const _0x524797 in _0x53ebf6){_0x22a6a8[_0x524797]=_0x53ebf6[_0x524797];}if(_0x37329f)_0x22a6a8['id']=_0x37329f;await _0x560744(_0x286e17,_0x22a6a8);}await _0x5bf57b['createUser'](_0x286e17,_0x22a6a8),_0x4882d9['groups']&&Array[_0x3495fc(0x138)](_0x4882d9['groups'])&&_0x4882d9[_0x3495fc(0xee)][_0x3495fc(0x132)]>0x0&&(_0x4a206d=await _0x89d8a4(_0x286e17,_0x3495fc(0x1bd),_0x3bf522));}catch(_0x1417e0){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+'\x20createUser()\x20obj='+JSON[_0x3495fc(0x102)](_0x22a6a8)+_0x3495fc(0xf6)+_0x1417e0[_0x3495fc(0x15d)]+'}'),_0x5bf57b['logger'][_0x3495fc(0x118)](_0x2aa401+'\x20done'+_0x11f296);return;}}if(_0x4a1f48||_0x4a206d){if(_0x2a1073['activityOperation']===_0x3495fc(0x18c)){if(_0x5ba07d[_0x3495fc(0x12c)]&&_0x5ba07d[_0x3495fc(0x12c)]===!![]){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x1b0)+_0x4a1f48+_0x3495fc(0x192)),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+'\x20Delete\x20User\x20id='+_0x4a1f48);try{await _0x5bf57b[_0x3495fc(0x18c)](_0x286e17,_0x4a1f48);}catch(_0x4515de){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+_0x3495fc(0x1b0)+_0x4a1f48+_0x3495fc(0xf6)+_0x4515de[_0x3495fc(0x15d)]+'}'),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}}else{if(_0x4a206d)_0x4a1f48=_0x4a206d;_0x5bf57b['logger']['debug'](_0x2aa401+_0x3495fc(0x17a)+_0x4a1f48);const _0x464663={};_0x464663[_0x3495fc(0x113)]=()=>{},_0x464663['params']={},_0x464663[_0x3495fc(0x136)][_0x3495fc(0x1bb)]=_0x286e17,_0x464663['params']['id']=_0x4a1f48,_0x464663['request']={},_0x464663[_0x3495fc(0x114)][_0x3495fc(0x1cf)]=_0x286e17?'/'+_0x286e17+'/Users/'+_0x4a1f48:_0x3495fc(0x174)+_0x4a1f48,_0x464663[_0x3495fc(0x114)][_0x3495fc(0x1db)]=_0x4882d9;try{await _0x5bf57b[_0x3495fc(0x129)](_0x464663,_0x5ba07d['usePutSoftSync']);}catch(_0x2de395){_0x5bf57b[_0x3495fc(0x14a)]['error'](_0x2aa401+_0x3495fc(0x17a)+_0x4a1f48+_0x3495fc(0xf6)+_0x2de395[_0x3495fc(0x15d)]),_0x5bf57b[_0x3495fc(0x14a)]['debug'](_0x2aa401+'\x20done'+_0x11f296);return;}if(_0x464663[_0x3495fc(0xfa)]&&(_0x464663[_0x3495fc(0xfa)]<0xc8||_0x464663[_0x3495fc(0xfa)]>0x12b)){if(_0x464663[_0x3495fc(0x1db)]){if(_0x464663[_0x3495fc(0x1db)][_0x3495fc(0x109)]){let _0x227a3a=_0x464663[_0x3495fc(0x1db)]['detail'];_0x227a3a=_0x227a3a['replace'](_0x5bf57b[_0x3495fc(0x153)]+'['+_0x5bf57b[_0x3495fc(0x107)]+']',''+_0x2aa401),_0x5bf57b['logger'][_0x3495fc(0x110)](''+_0x227a3a);}else{if(_0x464663[_0x3495fc(0x1db)]['Errors']&&Array[_0x3495fc(0x138)](_0x464663[_0x3495fc(0x1db)][_0x3495fc(0x1df)])&&_0x464663[_0x3495fc(0x1db)][_0x3495fc(0x1df)]['length']>0x0){let _0x10598d=_0x464663['body'][_0x3495fc(0x1df)][0x0][_0x3495fc(0x179)];_0x10598d=_0x10598d['replace'](_0x5bf57b[_0x3495fc(0x153)]+'['+_0x5bf57b[_0x3495fc(0x107)]+']',''+_0x2aa401),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](''+_0x10598d);}}}}if(_0x5ba07d[_0x3495fc(0x1be)]){const [_0x241c66,_0x48c793]=_0x5bf57b[_0x3495fc(0x1e8)]({'Operations':_0x2a1073[_0x3495fc(0x1b9)]});if(_0x48c793){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+_0x3495fc(0x17a)+_0x4a1f48+_0x3495fc(0x147)+_0x48c793[_0x3495fc(0x15d)]),_0x5bf57b['logger']['debug'](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}const _0x4a0c4a=[];if(_0x241c66['roles']&&Array[_0x3495fc(0x138)](_0x241c66['roles']))for(let _0x36059c=0x0;_0x36059c<_0x241c66[_0x3495fc(0x13c)][_0x3495fc(0x132)];_0x36059c++){_0x241c66[_0x3495fc(0x13c)][_0x36059c][_0x3495fc(0x186)]&&_0x241c66[_0x3495fc(0x13c)][_0x36059c][_0x3495fc(0x186)]===_0x3495fc(0x1e2)&&_0x4a0c4a['push'](_0x241c66[_0x3495fc(0x13c)][_0x36059c]);}if(_0x4a0c4a[_0x3495fc(0x132)]>0x0)try{await _0x5bf57b[_0x3495fc(0x13b)](_0x286e17,_0x4a1f48,{'roles':_0x4a0c4a});}catch(_0x6ded45){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x2aa401+'\x20Replace\x20User\x20id='+_0x4a1f48+_0x3495fc(0x15a)+_0x6ded45[_0x3495fc(0x15d)]);}const _0x2aee50=[];if(_0x241c66[_0x3495fc(0xee)]&&Array[_0x3495fc(0x138)](_0x241c66['groups']))for(let _0x2a9254=0x0;_0x2a9254<_0x241c66['groups'][_0x3495fc(0x132)];_0x2a9254++){_0x241c66[_0x3495fc(0xee)][_0x2a9254]['operation']&&_0x241c66[_0x3495fc(0xee)][_0x2a9254][_0x3495fc(0x186)]==='delete'&&_0x2aee50[_0x3495fc(0x16f)](_0x241c66[_0x3495fc(0xee)][_0x2a9254]);}if(_0x2aee50[_0x3495fc(0x132)]>0x0)for(let _0x5cbd68=0x0;_0x5cbd68<_0x2aee50['length'];_0x5cbd68++){try{await _0x5bf57b[_0x3495fc(0x169)](_0x286e17,_0x2aee50[_0x5cbd68]['id'],{'members':[{'operation':_0x3495fc(0x1e2),'value':_0x4a1f48}]});}catch(_0x1c63a7){_0x5bf57b[_0x3495fc(0x14a)]['error'](_0x2aa401+_0x3495fc(0x17a)+_0x4a1f48+_0x3495fc(0x133)+_0x1c63a7[_0x3495fc(0x15d)]);}}}if(_0x5ba07d[_0x3495fc(0x1e5)]&&_0x2a1073[_0x3495fc(0x101)]===_0x3495fc(0x13b)){if(_0x4882d9[_0x3495fc(0xee)]&&Array[_0x3495fc(0x138)](_0x4882d9[_0x3495fc(0xee)])&&_0x4882d9['groups'][_0x3495fc(0x132)]===0x0){if(_0x4882d9['roles']&&Array[_0x3495fc(0x138)](_0x4882d9[_0x3495fc(0x13c)])&&_0x4882d9['roles'][_0x3495fc(0x132)]===0x0){if(_0x2a1073['Operations']&&Array[_0x3495fc(0x138)](_0x2a1073[_0x3495fc(0x1b9)])&&_0x2a1073['Operations'][_0x3495fc(0x132)]>0x0){let _0x423748=![];for(let _0x541bfb=0x0;_0x541bfb<_0x2a1073[_0x3495fc(0x1b9)][_0x3495fc(0x132)];_0x541bfb++){const _0x48c29a=_0x2a1073['Operations'][_0x541bfb];if(_0x48c29a['op']===_0x3495fc(0x15b)){if(_0x48c29a[_0x3495fc(0x1ef)]){if(_0x48c29a[_0x3495fc(0x1ef)]['startsWith'](_0x3495fc(0x13c))&&_0x48c29a[_0x3495fc(0x178)]){_0x423748=!![];break;}else{if(_0x48c29a[_0x3495fc(0x1ef)]===_0x3495fc(0xee)){_0x423748=!![];break;}}}}}if(_0x423748){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x1b0)+_0x4a1f48);try{await _0x5bf57b[_0x3495fc(0x18c)](_0x286e17,_0x4a1f48);}catch(_0x28dc31){_0x5bf57b[_0x3495fc(0x14a)]['error'](_0x2aa401+_0x3495fc(0x1b0)+_0x4a1f48+'\x20error:\x20'+_0x28dc31[_0x3495fc(0x15d)]+'}'),_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x118)](_0x2aa401+_0x3495fc(0x196)+_0x11f296);return;}}}}}}}}_0x5bf57b[_0x3495fc(0x14a)]['debug'](_0x2aa401+'\x20done'+_0x11f296);}catch(_0x5421db){_0x5bf57b[_0x3495fc(0x14a)][_0x3495fc(0x110)](_0x5bf57b[_0x3495fc(0x153)]+'['+_0x5bf57b[_0x3495fc(0x107)]+_0x3495fc(0x115)+_0x286e17+']['+_0xd917e0+_0x3495fc(0x1b5)+_0x5421db[_0x3495fc(0x15d)]+_0x3495fc(0x134)+_0x11f296);}},_0x17a87d=nats[_0x3fe557(0x189)](),_0x1ef045=_0x3cb206[_0x3fe557(0x18d)](),_0x83f669=(_0x3fe557(0x14b)+_0x5bf57b[_0x3fe557(0x107)]+'_'+_0x286e17)[_0x3fe557(0x146)]('*','#')[_0x3fe557(0x146)]('>','##')[_0x3fe557(0x146)]('.','_'),_0x2fd6b2=_0xd917e0[_0x3fe557(0x1fb)]('.')[0x0]['toUpperCase']()==='GW',_0x303a62=async()=>{const _0x46a2c6=_0x3fe557;try{let _0x577c96;const _0x827431=''+_0x5ba07d?.[_0x46a2c6(0x1f2)]?.[_0x46a2c6(0x1d4)],_0x5ca5c3=await _0x3cb206[_0x46a2c6(0x1bc)](),_0x36a32=async()=>{const _0x275678=_0x46a2c6;let _0x2fe416;try{_0x2fe416=await _0x1ef045[_0x275678(0x18b)][_0x275678(0x142)](_0x827431,_0x83f669);}catch(_0x39e24b){const _0x3073ea={'durable_name':_0x83f669,'deliver_policy':nats[_0x275678(0x11d)][_0x275678(0x1af)],'ack_policy':nats['AckPolicy']['Explicit'],'filter_subject':_0xd917e0};await _0x5ca5c3['consumers'][_0x275678(0x1b3)](_0x827431,_0x3073ea),_0x2fe416=await _0x1ef045[_0x275678(0x18b)][_0x275678(0x142)](_0x827431,_0x83f669);}if(_0x2fe416?.[_0x275678(0x152)]?.[_0x275678(0x161)]?.[_0x275678(0x201)]!=='all')throw new Error(_0x275678(0xfd));_0x2fe416?.['_info']?.[_0x275678(0x161)]?.['filter_subject']!==_0xd917e0&&(await _0x5ca5c3[_0x275678(0x18b)][_0x275678(0x17c)](_0x827431,_0x83f669,{'filter_subject':_0xd917e0}),_0x2fe416=await _0x1ef045[_0x275678(0x18b)]['get'](_0x827431,_0x83f669)),_0x577c96=await _0x2fe416['consume']({'max_messages':0x64}),_0x4514b4(_0x577c96);},_0x4514b4=async _0x1ae570=>{const _0x4d7a8b=_0x46a2c6;for await(const _0x3734a1 of await _0x1ae570[_0x4d7a8b(0xfa)]()){switch(_0x3734a1[_0x4d7a8b(0x1ab)]){case nats[_0x4d7a8b(0x1c4)]['ConsumerNotFound']:_0x5bf57b[_0x4d7a8b(0x14a)][_0x4d7a8b(0x1e4)](_0x5bf57b['gwName']+'['+_0x5bf57b[_0x4d7a8b(0x107)]+_0x4d7a8b(0x115)+_0x286e17+']['+_0xd917e0+']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20'+_0x3734a1[_0x4d7a8b(0x1ab)]),_0x36a32();return;}}};await _0x36a32();let _0x4b706e=-0x1;do{for await(const _0x2069df of _0x577c96){if(!_0x2069df[_0x46a2c6(0x1ad)]||!_0x2069df[_0x46a2c6(0x1ad)][_0x46a2c6(0x142)](_0x46a2c6(0x108))){_0x2069df[_0x46a2c6(0x1dc)]();continue;}_0x4b706e=_0x577c96[_0x46a2c6(0x182)]();const _0x59cefb=_0x5bf57b[_0x46a2c6(0x153)]+'['+_0x5bf57b[_0x46a2c6(0x107)]+_0x46a2c6(0x115)+_0x286e17+']['+_0x2069df[_0x46a2c6(0xed)]+']['+_0x4b706e+']['+(_0x2069df['headers']?_0x2069df[_0x46a2c6(0x1ad)]['get'](_0x46a2c6(0x108)):'')+']',_0x141bac=_0x17a87d[_0x46a2c6(0x11f)](_0x2069df[_0x46a2c6(0x162)]),_0x4091da=await _0x328a38(_0x59cefb,_0x141bac);if(!_0x4091da||_0x4091da!==!![])_0x2069df[_0x46a2c6(0x1dc)]();else _0x5bf57b[_0x46a2c6(0x14a)][_0x46a2c6(0x110)](_0x59cefb+'\x20subscriber\x20error:\x20scimgateway\x20endpoint\x20connect\x20problem\x20-\x20will\x20do\x20auto\x20retry\x20until\x20connected');if(_0x4b706e<0x1)break;}}while(_0x4b706e===0x0);}catch(_0x4b2438){_0x5bf57b[_0x46a2c6(0x14a)]['error'](_0x5bf57b[_0x46a2c6(0x153)]+'['+_0x5bf57b[_0x46a2c6(0x107)]+']\x20subscriber['+_0x286e17+']['+_0xd917e0+_0x46a2c6(0x172)+_0x4b2438[_0x46a2c6(0x15d)]);}},_0x3740fc=async()=>{const _0x274c6e=_0x3fe557,_0x26ca98=_0x3cb206[_0x274c6e(0x1d6)](_0xd917e0,{'max':0x64});for await(const _0x59fbd5 of _0x26ca98){if(!_0x59fbd5[_0x274c6e(0x1ad)]||!_0x59fbd5[_0x274c6e(0x1ad)][_0x274c6e(0x142)](_0x274c6e(0x108)))continue;let _0x170934,_0x131202;try{try{_0x170934=JSON[_0x274c6e(0x117)](_0x59fbd5[_0x274c6e(0x1cc)]());}catch(_0x2b2606){const _0x5b522e=_0x274c6e(0x1c5);_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x110)](_0x5bf57b[_0x274c6e(0x153)]+'['+_0x5bf57b['pluginName']+']\x20subscriber['+_0x286e17+']['+_0xd917e0+']\x20'+_0x5b522e+':\x20'+_0x59fbd5[_0x274c6e(0x1cc)]());throw new Error(_0x5b522e);}if(!_0x170934||!_0x170934[_0x274c6e(0x1d5)]){const _0x3bc4a9=_0x274c6e(0x121);_0x5bf57b['logger'][_0x274c6e(0x110)](_0x5bf57b[_0x274c6e(0x153)]+'['+_0x5bf57b['pluginName']+_0x274c6e(0x115)+_0x286e17+']['+_0xd917e0+']\x20'+_0x3bc4a9+':\x20'+_0x170934);throw new Error(_0x3bc4a9);}!Object[_0x274c6e(0x197)][_0x274c6e(0x1fc)][_0x274c6e(0x1c6)](_0x170934,_0x274c6e(0x1bb))&&(_0x170934[_0x274c6e(0x1bb)]='undefined');if(_0x170934[_0x274c6e(0x1bb)]!==_0x286e17){const _0x355989=_0x274c6e(0x123)+_0x170934[_0x274c6e(0x1bb)]+_0x274c6e(0xfe)+_0x286e17;_0x5bf57b['logger'][_0x274c6e(0x110)](_0x5bf57b[_0x274c6e(0x153)]+'['+_0x5bf57b[_0x274c6e(0x107)]+_0x274c6e(0x115)+_0x286e17+']['+_0xd917e0+']\x20'+_0x355989);throw new Error(_0x355989);}_0x131202=_0x5bf57b['gwName']+'['+_0x5bf57b[_0x274c6e(0x107)]+_0x274c6e(0x115)+_0x286e17+']['+_0x59fbd5[_0x274c6e(0xed)]+']['+(_0x59fbd5[_0x274c6e(0x1ad)]?_0x59fbd5[_0x274c6e(0x1ad)][_0x274c6e(0x142)](_0x274c6e(0x108)):'')+']',_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0x13e));const _0x14e561={};let _0x5d3fdc,_0x18cde6;switch(_0x170934[_0x274c6e(0x1d5)]){case _0x274c6e(0x1a1):if(!_0x170934[_0x274c6e(0x198)]['operator']&&_0x170934[_0x274c6e(0x198)][_0x274c6e(0x1a3)]&&_0x170934[_0x274c6e(0x198)][_0x274c6e(0x1a3)]['includes']('\x20or\x20')){const _0xe39fb=_0x170934['obj'][_0x274c6e(0x1a3)][_0x274c6e(0x1fb)](_0x274c6e(0x168));let _0x4ed6cc=[];for(let _0x422aea=0x0;_0x422aea<_0xe39fb['length'];_0x422aea++){_0xe39fb[_0x422aea]=_0xe39fb[_0x422aea][_0x274c6e(0x1c3)](/\(/g,'')[_0x274c6e(0x1c3)](/\)/g,'')['trim']();const _0x956d31=_0xe39fb[_0x422aea][_0x274c6e(0x1fb)]('\x20');if(_0x956d31[_0x274c6e(0x132)]===0x3||_0x956d31[_0x274c6e(0x132)]>0x2&&_0x956d31[0x2][_0x274c6e(0x1ce)]('\x22')&&_0x956d31[_0x956d31[_0x274c6e(0x132)]-0x1][_0x274c6e(0x14d)]('\x22')){const _0x1cec00={};_0x1cec00[_0x274c6e(0x15c)]=_0x956d31[0x0],_0x1cec00[_0x274c6e(0x203)]=_0x956d31[0x1][_0x274c6e(0x1a6)](),_0x1cec00[_0x274c6e(0x125)]=decodeURIComponent(_0x956d31['slice'](0x2)[_0x274c6e(0x16e)]('\x20')[_0x274c6e(0x1c3)](/"/g,'')),_0x4ed6cc[_0x274c6e(0x16f)](_0x1cec00);}else{_0x4ed6cc=[];break;}}if(_0x4ed6cc[_0x274c6e(0x132)]>0x0){const _0x2e9e4c=async _0x193900=>{const _0x1be146=_0x274c6e;return await _0x5bf57b[_0x170934[_0x1be146(0x1d5)]](_0x286e17,_0x193900,_0x170934[_0x1be146(0x1e9)],_0x170934[_0x1be146(0x1c8)]);},_0x3d942f=0x5,_0xa6eb1f=[];_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+'\x22\x20with\x20chunks\x20and\x20awaiting\x20result');do{const _0xeeb4ff=_0x4ed6cc['splice'](0x0,_0x3d942f),_0x30bd83=await Promise['allSettled'](_0xeeb4ff[_0x274c6e(0x1f8)](_0x5501b6=>_0x2e9e4c(_0x5501b6))),_0x4da9c9=_0x30bd83[_0x274c6e(0x1a2)](_0x5e97d6=>_0x5e97d6[_0x274c6e(0xfa)]===_0x274c6e(0x104))[_0x274c6e(0x1f8)](_0x4d9522=>_0x4d9522[_0x274c6e(0x177)][_0x274c6e(0x15d)]);if(_0x4da9c9[_0x274c6e(0x132)]>0x0){const _0x3c8a2e=_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x206)+_0x4da9c9['join'](',\x20');throw new Error(_0x3c8a2e);}const _0x5c502b=_0x30bd83[_0x274c6e(0x1f8)](_0x12aecd=>_0x12aecd?.[_0x274c6e(0x125)]?.[_0x274c6e(0x1f6)]);for(let _0xe7d1b=0x0;_0xe7d1b<_0x5c502b[_0x274c6e(0x132)];_0xe7d1b++){Array['prototype'][_0x274c6e(0x16f)][_0x274c6e(0x1d1)](_0xa6eb1f,_0x5c502b[_0xe7d1b]);}}while(_0x4ed6cc[_0x274c6e(0x132)]>0x0);_0x5d3fdc={'Resources':_0xa6eb1f};}}!_0x5d3fdc&&(_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934[_0x274c6e(0x198)],_0x170934[_0x274c6e(0x1e9)],_0x170934[_0x274c6e(0x120)]));if(Array[_0x274c6e(0x138)](_0x5d3fdc?.['Resources'])){if(_0x170934?.['attributes']?.[_0x274c6e(0x132)]===0x0||_0x170934?.[_0x274c6e(0x1e9)]?.[_0x274c6e(0x1a5)](_0x274c6e(0xee)))for(let _0x3aff77=0x0;_0x3aff77<_0x5d3fdc[_0x274c6e(0x1f6)][_0x274c6e(0x132)];_0x3aff77++){const _0x55441b=_0x5d3fdc[_0x274c6e(0x1f6)][_0x3aff77];if(!_0x55441b['id'])break;if(_0x55441b[_0x274c6e(0xee)])break;_0x55441b['groups']=await _0x5bf57b['getMemberOf'](_0x286e17,_0x55441b['id'],_0x274c6e(0x116),_0x170934[_0x274c6e(0x120)]);}}break;case _0x274c6e(0x116):_0x5bf57b['logger'][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934['handle']+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934[_0x274c6e(0x198)],_0x170934[_0x274c6e(0x1e9)],_0x170934[_0x274c6e(0x120)]);break;case _0x274c6e(0x103):_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934[_0x274c6e(0x198)],_0x170934['ctxPassThrough']);break;case _0x274c6e(0x15e):_0x5bf57b['logger'][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934['handle']](_0x286e17,_0x170934['obj'],_0x170934['ctxPassThrough']);break;case _0x274c6e(0x18c):_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934['handle']+'\x22\x20and\x20awaiting\x20result'),_0x5d3fdc=await _0x5bf57b[_0x170934['handle']](_0x286e17,_0x170934['id'],_0x170934['ctxPassThrough']);break;case _0x274c6e(0x1d3):_0x5bf57b['logger'][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934['handle']+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934['handle']](_0x286e17,_0x170934['id'],_0x170934[_0x274c6e(0x120)]);break;case'modifyUser':_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934['id'],_0x170934[_0x274c6e(0x198)],_0x170934['ctxPassThrough']);break;case _0x274c6e(0x169):_0x5bf57b['logger']['debug'](_0x131202+_0x274c6e(0xf7)+_0x170934['handle']+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934['id'],_0x170934[_0x274c6e(0x198)],_0x170934[_0x274c6e(0x120)]);break;case'replaceUsrGrp':_0x14e561[_0x274c6e(0x113)]=()=>{},_0x14e561[_0x274c6e(0x136)]={},_0x14e561[_0x274c6e(0x136)][_0x274c6e(0x1bb)]=_0x286e17,_0x14e561[_0x274c6e(0x136)]['id']=_0x170934['id'],_0x14e561[_0x274c6e(0x114)]={},_0x14e561[_0x274c6e(0x114)][_0x274c6e(0x1cf)]=_0x170934['originalUrl'],_0x14e561[_0x274c6e(0x114)][_0x274c6e(0x1db)]=_0x170934['obj'],_0x14e561[_0x274c6e(0x1c8)]=_0x170934[_0x274c6e(0x120)],_0x5bf57b['logger'][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934['handle']+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x14e561);break;case _0x274c6e(0x1fa):_0x5bf57b[_0x274c6e(0x14a)]['debug'](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934['handle']](_0x286e17,_0x170934[_0x274c6e(0x198)],_0x170934['ctxPassThrough']);break;case _0x274c6e(0x1d9):_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934['id'],_0x170934[_0x274c6e(0x198)],_0x170934[_0x274c6e(0x120)]);break;case _0x274c6e(0x16a):_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+'\x20calling\x20\x22'+_0x170934['handle']+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934[_0x274c6e(0x1d5)]](_0x286e17,_0x170934['id'],_0x170934[_0x274c6e(0x198)],_0x170934[_0x274c6e(0x120)]);break;case _0x274c6e(0x19c):_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x1d0)),_0x5d3fdc=await _0x5bf57b[_0x170934['handle']](_0x286e17,_0x170934['id'],_0x170934[_0x274c6e(0xf4)],_0x170934[_0x274c6e(0x198)],_0x170934['ctxPassThrough']);break;case _0x274c6e(0x10a):_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x118)](_0x131202+_0x274c6e(0xf7)+_0x170934[_0x274c6e(0x1d5)]+'\x22\x20and\x20awaiting\x20result'),_0x5d3fdc=await _0x5bf57b[_0x170934['handle']](_0x286e17,_0x170934['id'],_0x170934['ctxPassThrough']);break;default:_0x18cde6=_0x274c6e(0x202)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x19d),_0x5bf57b[_0x274c6e(0x14a)][_0x274c6e(0x110)](_0x131202+'\x20'+_0x18cde6);throw new Error(_0x18cde6);}if(!_0x5d3fdc)_0x5d3fdc=null;const _0x49aa35=JSON[_0x274c6e(0x102)](_0x5d3fdc);_0x59fbd5[_0x274c6e(0xf2)](_0x49aa35),_0x5bf57b['logger']['info'](_0x131202+_0x274c6e(0x1ee)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x149)+(_0x170934[_0x274c6e(0x198)]?JSON[_0x274c6e(0x102)](_0x170934[_0x274c6e(0x198)]):'')+_0x274c6e(0x181)+(_0x170934['id']?_0x170934['id']:'')+_0x274c6e(0x12a)+(_0x170934[_0x274c6e(0x1e9)]?_0x170934['attributes']:'')+'\x20message\x20response:\x20'+_0x49aa35+_0x11f296);}catch(_0x3d8519){const _0x5362a0=_0x274c6e(0x1da)+_0x3d8519['message']+_0x274c6e(0x1c0)+_0x3d8519['name']+'\x22}';_0x59fbd5[_0x274c6e(0xf2)](_0x5362a0),_0x5bf57b['logger'][_0x274c6e(0x1e4)]((_0x131202||'')+_0x274c6e(0x1ee)+_0x170934[_0x274c6e(0x1d5)]+_0x274c6e(0x149)+(_0x170934['obj']?JSON[_0x274c6e(0x102)](_0x170934[_0x274c6e(0x198)]):'')+',\x20id='+(_0x170934['id']?_0x170934['id']:'')+_0x274c6e(0x12a)+(_0x170934[_0x274c6e(0x1e9)]?_0x170934[_0x274c6e(0x1e9)]:'')+_0x274c6e(0x1b8)+_0x5362a0+_0x11f296);}}};if(_0x2fd6b2)_0x3740fc();else _0x303a62();},_0x112135=async(_0x137231,_0x724401)=>{const _0x46bfc5=_0x4537e7,_0xe7ea09=_0x40054e[_0x137231][_0x46bfc5(0x161)]?.[_0x46bfc5(0x1f2)]?.['subject'];let _0x249474=0x0;for await(const _0x3056a8 of _0x724401[_0x46bfc5(0xfa)]()){switch(_0x3056a8[_0x46bfc5(0x1ab)]){case nats[_0x46bfc5(0x1fd)][_0x46bfc5(0x1d7)]:_0x5bf57b[_0x46bfc5(0x14a)][_0x46bfc5(0x110)](_0x5bf57b[_0x46bfc5(0x153)]+'['+_0x5bf57b[_0x46bfc5(0x107)]+_0x46bfc5(0x115)+_0x137231+']['+_0xe7ea09+']\x20client\x20disconnected\x20'+_0x3056a8[_0x46bfc5(0x162)]+_0x46bfc5(0x12e)),_0x249474=0x0;break;case nats[_0x46bfc5(0x1fd)]['Reconnect']:_0x5bf57b[_0x46bfc5(0x14a)]['info'](_0x5bf57b[_0x46bfc5(0x153)]+'['+_0x5bf57b['pluginName']+']\x20subscriber['+_0x137231+']['+_0xe7ea09+_0x46bfc5(0x170)+_0x3056a8[_0x46bfc5(0x162)]);break;case nats['Events']['Error']:_0x5bf57b[_0x46bfc5(0x14a)][_0x46bfc5(0x110)](_0x5bf57b['gwName']+'['+_0x5bf57b[_0x46bfc5(0x107)]+']\x20subscriber['+_0x137231+']['+_0xe7ea09+_0x46bfc5(0x204)+_0x3056a8[_0x46bfc5(0x162)]);break;case nats['DebugEvents'][_0x46bfc5(0x158)]:_0x249474+=0x1;_0x249474%0x1e===0x0&&_0x5bf57b[_0x46bfc5(0x14a)][_0x46bfc5(0x118)](_0x5bf57b[_0x46bfc5(0x153)]+'['+_0x5bf57b[_0x46bfc5(0x107)]+_0x46bfc5(0x115)+_0x137231+']['+_0xe7ea09+_0x46bfc5(0x1aa)+_0x3056a8['data']+'\x20(count='+_0x249474+')');break;case nats[_0x46bfc5(0x1c2)][_0x46bfc5(0x145)]:_0x5bf57b[_0x46bfc5(0x14a)]['debug'](_0x5bf57b['gwName']+'['+_0x5bf57b[_0x46bfc5(0x107)]+']\x20subscriber['+_0x137231+']['+_0xe7ea09+']\x20client\x20has\x20a\x20stale\x20connection\x20'+_0x3056a8['data']);break;}}};process['on']('SIGTERM',async()=>{const _0x3e18d3=_0x4537e7;for(const _0x53ea14 in _0x40054e){_0x40054e[_0x53ea14]['nc']&&!_0x40054e[_0x53ea14]['nc'][_0x3e18d3(0x19f)]()&&await _0x40054e[_0x53ea14]['nc'][_0x3e18d3(0x1ca)]();}}),process['on'](_0x4537e7(0x155),async()=>{const _0x3e58fc=_0x4537e7;for(const _0x32bc3e in _0x40054e){_0x40054e[_0x32bc3e]['nc']&&!_0x40054e[_0x32bc3e]['nc'][_0x3e58fc(0x19f)]()&&await _0x40054e[_0x32bc3e]['nc'][_0x3e58fc(0x1ca)]();}});const _0x89d8a4=async(_0x14a244,_0x3898b2,_0x386e4d)=>{const _0x4b49b0=_0x4537e7,_0x295ac0={'attribute':_0x3898b2,'operator':'eq','value':_0x386e4d,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0x17d0b7=[_0x3898b2];if(_0x3898b2!=='id')_0x17d0b7[_0x4b49b0(0x16f)]('id');try{const _0x4f265a=await _0x5bf57b[_0x4b49b0(0x1a1)](_0x14a244,_0x295ac0,_0x17d0b7);if(!_0x4f265a||!_0x4f265a[_0x4b49b0(0x1f6)]||!Array['isArray'](_0x4f265a[_0x4b49b0(0x1f6)]))throw new Error(_0x4b49b0(0x14f)+JSON[_0x4b49b0(0x102)](_0x295ac0)+_0x4b49b0(0x111));if(_0x4f265a['Resources'][_0x4b49b0(0x132)]===0x0)return null;else{if(_0x4f265a[_0x4b49b0(0x1f6)]['length']>0x2)throw new Error(_0x4b49b0(0x14f)+JSON[_0x4b49b0(0x102)](_0x295ac0)+_0x4b49b0(0x164));else{const _0x502bc9=_0x4f265a[_0x4b49b0(0x1f6)][0x0];if(!_0x502bc9['id'])throw new Error(_0x4b49b0(0x14f)+JSON[_0x4b49b0(0x102)](_0x295ac0)+_0x4b49b0(0x10e)+JSON[_0x4b49b0(0x102)](_0x502bc9)+'\x20error:\x20missing\x20id}');return decodeURIComponent(_0x502bc9['id']);}}}catch(_0x3fb72f){throw new Error(_0x4b49b0(0x14f)+JSON[_0x4b49b0(0x102)](_0x295ac0)+_0x4b49b0(0xf6)+_0x3fb72f[_0x4b49b0(0x15d)]+'}');}},_0x2b2a20=_0x23f1e5=>{const _0x472703=_0x4537e7;if(!_0x23f1e5||typeof _0x23f1e5!==_0x472703(0x1cc))return[null,null];_0x23f1e5=_0x23f1e5[_0x472703(0x11b)]();const _0x4208fa=_0x23f1e5['indexOf']('(');if(_0x4208fa<0x1)return[null,null];if(_0x23f1e5[_0x472703(0x185)](_0x23f1e5[_0x472703(0x132)]-0x1)!==')')return[null,null];if(_0x12e39b(_0x23f1e5,'(')!==_0x12e39b(_0x23f1e5,')'))return[null,null];const _0x254104=_0x23f1e5[_0x472703(0x185)](0x0,_0x4208fa),_0xeab944=_0x23f1e5['substring'](_0x4208fa+0x1,_0x23f1e5[_0x472703(0x132)]-0x1);let _0x56849b=[];const _0x1552f2=_0xeab944['split'](',');let _0x40b0f9='';for(let _0x5653ec=0x0;_0x5653ec<_0x1552f2[_0x472703(0x132)];_0x5653ec++){const _0x555099=_0x40b0f9?_0x40b0f9+','+_0x1552f2[_0x5653ec]:_0x1552f2[_0x5653ec],_0x4990ea=_0x12e39b(_0x555099,'('),_0x16d700=_0x12e39b(_0x555099,')');if(_0x4990ea===_0x16d700)_0x56849b['push'](_0x3449fd(_0x555099,'\x22')),_0x40b0f9='';else{if(_0x40b0f9)_0x40b0f9+=','+_0x1552f2[_0x5653ec];else _0x40b0f9+=_0x1552f2[_0x5653ec];}}if(_0x56849b[_0x472703(0x132)]===0x0)_0x56849b=null;return[_0x254104,_0x56849b];};function _0x12e39b(_0x3ffd38,_0x1e5d08){const _0x1ae9a7=_0x4537e7;let _0x479fcc=0x0;for(let _0x20990b=0x0;_0x20990b<_0x3ffd38[_0x1ae9a7(0x132)];_0x20990b++){_0x3ffd38[_0x1ae9a7(0x10f)](_0x20990b)===_0x1e5d08&&(_0x479fcc+=0x1);}return _0x479fcc;}const _0x3449fd=(_0x5c4654,_0xff9bad)=>{const _0x4d1052=_0x4537e7;if(typeof _0x5c4654!==_0x4d1052(0x1cc)||typeof _0xff9bad!=='string')return _0x5c4654;if(_0x5c4654[_0x4d1052(0x132)]===0x1)return _0x5c4654;if(_0xff9bad['length']!==0x1)return _0x5c4654;return _0x5c4654=_0x5c4654[_0x4d1052(0x11b)](),_0x5c4654[_0x4d1052(0x185)](0x0,0x1)===_0xff9bad&&(_0x5c4654=_0x5c4654[_0x4d1052(0x185)](0x1)),_0x5c4654['substring'](_0x5c4654['length']-0x1)===_0xff9bad&&(_0x5c4654=_0x5c4654[_0x4d1052(0x185)](0x0,_0x5c4654['length']-0x1)),_0x5c4654;},_0x43152a=async(_0x15e727,_0x10bf9b,_0x36415f,_0x5903c0)=>{const _0x1f0449=_0x4537e7;if(!_0x10bf9b||!_0x36415f||!_0x5903c0)return null;const [_0x44779b,_0x512123]=_0x2b2a20(_0x5903c0);if(!_0x44779b||!_0x512123){const _0x3c283b=_0x5903c0[_0x1f0449(0x1fb)]('(');if(_0x3c283b[_0x1f0449(0x132)]>0x1){const _0x1c20cb=['lowercase',_0x1f0449(0xf1),_0x1f0449(0x1f4),'elementnumber',_0x1f0449(0x16e),_0x1f0449(0x1c3),_0x1f0449(0x1cb),_0x1f0449(0x10b),_0x1f0449(0x17d)],_0x52d4ea=_0x3c283b[0x0][_0x1f0449(0x1a6)]();if(_0x1c20cb[_0x1f0449(0x1a5)](_0x52d4ea))return null;}return _0x5903c0;}for(let _0x2dca47=0x0;_0x2dca47<_0x512123[_0x1f0449(0x132)];_0x2dca47++){if(_0x512123[_0x2dca47]['substring'](0x0,0x1)==='['){const _0x4df2cc=_0x512123[_0x2dca47]['indexOf'](']');if(_0x4df2cc<0x0)return null;const _0xe8c7cc=_0x512123[_0x2dca47][_0x1f0449(0x185)](0x1,_0x4df2cc),_0x34750a=_0xe8c7cc[_0x1f0449(0x1fb)]('.');let _0x35e33f;for(let _0xa1299d=0x0;_0xa1299d<_0x34750a[_0x1f0449(0x132)];_0xa1299d++){if(_0xa1299d===0x0)_0x35e33f=_0x10bf9b[_0x34750a[_0xa1299d]];else{if(!_0x35e33f)return null;_0x35e33f=_0x35e33f[_0x34750a[_0xa1299d]];}}if(!_0x35e33f)return null;_0x512123[_0x2dca47]=_0x35e33f;}}for(let _0x4369ce=0x0;_0x4369ce<_0x512123['length'];_0x4369ce++){const [_0x4213ce]=_0x2b2a20(_0x512123[_0x4369ce]);_0x4213ce&&(_0x512123[_0x4369ce]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x512123[_0x4369ce]));}if(_0x512123[0x0]===null)return null;switch(_0x44779b[_0x1f0449(0x1a6)]()){case _0x1f0449(0x165):{if(_0x512123[_0x1f0449(0x132)]!==0x1)return null;const [_0x34b599]=_0x2b2a20(_0x512123[0x0]);if(_0x34b599)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x34b599);if(_0x512123[0x0]===null)return null;return _0x512123[0x0][_0x1f0449(0x1a6)]();}case _0x1f0449(0xf1):{if(_0x512123[_0x1f0449(0x132)]!==0x1)return null;const [_0x49c64a]=_0x2b2a20(_0x512123[0x0]);if(_0x49c64a)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x49c64a);if(_0x512123[0x0]===null)return null;return _0x512123[0x0]['toUpperCase']();}case'firstn':{if(_0x512123[_0x1f0449(0x132)]!==0x2)return null;const [_0x478be0]=_0x2b2a20(_0x512123[0x0]);if(_0x478be0)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x478be0);if(_0x512123[0x0]===null)return null;if(isNaN(_0x512123[0x1]))return null;return _0x512123[0x0][_0x1f0449(0x185)](0x0,_0x512123[0x1]);}case _0x1f0449(0x1f7):{const [_0xccb497]=_0x2b2a20(_0x512123[0x0]);if(_0x512123[_0x1f0449(0x132)]<0x2)return null;if(_0xccb497)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0xccb497);if(_0x512123[0x0]===null)return null;const _0x2c1e6d=_0x512123[0x1];if(isNaN(_0x2c1e6d))return null;let _0x30faea;if(_0x512123[_0x1f0449(0x132)]===0x3)_0x30faea=_0x512123[0x0][_0x1f0449(0x1fb)](_0x512123[0x2]);else _0x30faea=_0x30faea=_0x512123[0x0]['split']('\x20');if(_0x2c1e6d<=_0x30faea[_0x1f0449(0x132)])return _0x30faea[_0x2c1e6d-0x1];else return'';}case _0x1f0449(0x1c3):{const [_0x3d3a8c]=_0x2b2a20(_0x512123[0x0]);if(_0x3d3a8c)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x3d3a8c);if(_0x512123[0x0]===null)return null;if(_0x512123[_0x1f0449(0x132)]!==0x3)return null;return _0x512123[0x0][_0x1f0449(0x146)](_0x512123[0x1],_0x512123[0x2]);}case'normalize':{if(_0x512123[_0x1f0449(0x132)]!==0x1)return null;const [_0x5070c2]=_0x2b2a20(_0x512123[0x0]);if(_0x5070c2)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x5070c2);if(_0x512123[0x0]===null)return null;return ascii127['foldReplacing'](_0x512123[0x0]);}case _0x1f0449(0x16e):{let _0x22d705='';for(let _0x12c98e=0x0;_0x12c98e<_0x512123[_0x1f0449(0x132)];_0x12c98e++){const [_0x59226d]=_0x2b2a20(_0x512123[_0x12c98e]);if(_0x59226d)_0x512123[_0x12c98e]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x59226d);if(_0x512123[_0x12c98e]===null)return null;_0x22d705+=_0x512123[_0x12c98e];}return _0x22d705;}case _0x1f0449(0x10b):{if(_0x512123[_0x1f0449(0x132)]>0x2)return null;const [_0x5267f9]=_0x2b2a20(_0x512123[0x0]);if(_0x5267f9)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x5267f9);if(_0x512123[0x0]===null)return null;const _0x57fae9=parseInt(_0x512123[0x0]);if(isNaN(_0x57fae9))return null;let _0x504fb5=_0x1f0449(0x1ae);_0x504fb5+=','+_0x512123[0x0];if(_0x512123[_0x1f0449(0x132)]===0x2&&_0x512123[0x1][_0x1f0449(0x1a6)]()===_0x1f0449(0xfc))_0x504fb5+=_0x1f0449(0x1f0);else _0x504fb5+=_0x1f0449(0x175);return _0x504fb5+='##',_0x504fb5;}case'getuniquevalue':{if(_0x512123[_0x1f0449(0x132)]!==0x1)return null;const [_0x211e4c]=_0x2b2a20(_0x512123[0x0]);if(_0x211e4c)_0x512123[0x0]=await _0x43152a(_0x15e727,_0x10bf9b,_0x36415f,_0x211e4c);if(_0x512123[0x0]===null)return null;let _0x37449c,_0x18f1e3=![],_0x4a05a8='';const _0xe3a122=_0x512123[0x0][_0x1f0449(0x1fb)]('##');if(_0xe3a122[_0x1f0449(0x132)]>0x2)for(let _0x35c7a2=0x0;_0x35c7a2<_0xe3a122[_0x1f0449(0x132)];_0x35c7a2++){if(_0xe3a122[_0x35c7a2]['startsWith']('doIncrement')){const _0x1dc9a7=_0xe3a122[_0x35c7a2]['split'](',');if(_0x1dc9a7[_0x1f0449(0x132)]<0x2)return null;const _0x2110e5=parseInt(_0x1dc9a7[0x1]);if(isNaN(_0x2110e5))return null;_0x4a05a8='##'+_0xe3a122[_0x35c7a2]+'##',_0x37449c=_0x1dc9a7[0x1],_0x1dc9a7[_0x1f0449(0x132)]>0x2&&(_0x18f1e3=_0x1dc9a7[0x2][_0x1f0449(0x1a6)]()==='true');}}let _0x469b83,_0x43591b=0x0,_0xd9e08f=0x0;if(_0x37449c){_0xd9e08f=_0x37449c['length'],_0x43591b=0xa;for(let _0x51521b=0x1;_0x51521b<_0xd9e08f;_0x51521b++){_0x43591b*=0xa;}_0x43591b-=0x1,_0x469b83=parseInt(_0x37449c);if(isNaN(_0x469b83))return null;_0x469b83-=0x1;}else _0x469b83=0x0;do{_0x469b83+=0x1;let _0x5e7786=_0x512123[0x0];if(_0x37449c!==undefined&&_0x4a05a8){let _0x2838f5=_0x469b83[_0x1f0449(0x126)]();while(_0x2838f5[_0x1f0449(0x132)]<_0xd9e08f){_0x2838f5='0'+_0x2838f5;}_0x18f1e3?_0x5e7786=_0x5e7786[_0x1f0449(0x1c3)](_0x4a05a8,_0x2838f5):(_0x5e7786=_0x5e7786[_0x1f0449(0x1c3)](_0x4a05a8,''),_0x18f1e3=!![],_0x469b83-=0x1);}try{const _0x43bc7f=await _0x89d8a4(_0x15e727,_0x36415f,_0x5e7786);if(!_0x43bc7f)return _0x5e7786;}catch(_0xbe7821){return _0x5bf57b['logger'][_0x1f0449(0x110)](_0x5bf57b[_0x1f0449(0x153)]+'['+_0x5bf57b[_0x1f0449(0x107)]+']\x20'+_0x44779b+_0x1f0449(0x14c)+_0xbe7821['message']),null;}}while(_0x469b83<_0x43591b);return null;}default:}return null;},_0x560744=async(_0x48e136,_0x842d66)=>{const _0x1ff97f=_0x4537e7;for(const _0x4aaedb in _0x842d66){const _0x3377a5=_0x842d66[_0x4aaedb],[_0x237444,_0x3c6c90]=_0x2b2a20(_0x3377a5);if(_0x237444){const _0x231177=''+_0x4aaedb,_0xc63d5c=_0x237444+'('+_0x3c6c90[_0x1ff97f(0x16e)](',')+')',_0x1c6ffe=await _0x43152a(_0x48e136,_0x842d66,_0x231177,_0xc63d5c);if(_0x1c6ffe===null)delete _0x842d66[_0x4aaedb];else _0x842d66[_0x4aaedb]=_0x1c6ffe;}for(const _0x4f67e1 in _0x3377a5){const _0x43421b=_0x3377a5[_0x4f67e1],[_0x3d9587,_0x2b91ad]=_0x2b2a20(_0x43421b);if(_0x3d9587){const _0x281916=_0x4aaedb+'.'+_0x4f67e1,_0x186c45=_0x3d9587+'('+_0x2b91ad[_0x1ff97f(0x16e)](',')+')',_0x5a96ae=await _0x43152a(_0x48e136,_0x842d66,_0x281916,_0x186c45);if(_0x5a96ae===null)delete _0x3377a5[_0x4f67e1];else _0x3377a5[_0x4f67e1]=_0x5a96ae;}}}return _0x842d66;};},module[a0_0x5a0f4d(0x1e1)][a0_0x5a0f4d(0x13d)]=function(_0x3263a7){const _0x2e4f1b=a0_0x5a0f4d,_0x5aff94=_0x3263a7,_0x492bb1={},_0x1088d2=async(_0x217308,_0x19b923)=>{const _0x5cafc4=a0_0xf886,_0x21ec28=_0x492bb1[_0x217308][_0x5cafc4(0x161)]?.[_0x5cafc4(0x1f2)]?.[_0x5cafc4(0xed)];let _0x4c4e83=0x0;for await(const _0x45d603 of _0x19b923[_0x5cafc4(0xfa)]()){switch(_0x45d603['type']){case nats[_0x5cafc4(0x1fd)]['Disconnect']:_0x5aff94['logger'][_0x5cafc4(0x110)](_0x5aff94['gwName']+'['+_0x5aff94[_0x5cafc4(0x107)]+_0x5cafc4(0x1a7)+_0x217308+']['+_0x21ec28+_0x5cafc4(0x1ff)+_0x45d603['data']+'\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available'),_0x4c4e83=0x0;break;case nats['Events'][_0x5cafc4(0x18a)]:_0x5aff94[_0x5cafc4(0x14a)][_0x5cafc4(0x1e4)](_0x5aff94['gwName']+'['+_0x5aff94['pluginName']+_0x5cafc4(0x1a7)+_0x217308+']['+_0x21ec28+']\x20client\x20reconnected\x20'+_0x45d603[_0x5cafc4(0x162)]);break;case nats[_0x5cafc4(0x1fd)][_0x5cafc4(0x11c)]:_0x5aff94[_0x5cafc4(0x14a)][_0x5cafc4(0x110)](_0x5aff94['gwName']+'['+_0x5aff94[_0x5cafc4(0x107)]+']\x20publisher['+_0x217308+']['+_0x21ec28+_0x5cafc4(0x204)+_0x45d603[_0x5cafc4(0x162)]);break;case nats[_0x5cafc4(0x1c2)]['Reconnecting']:_0x4c4e83+=0x1;_0x4c4e83%0x1e===0x0&&_0x5aff94[_0x5cafc4(0x14a)][_0x5cafc4(0x118)](_0x5aff94[_0x5cafc4(0x153)]+'['+_0x5aff94[_0x5cafc4(0x107)]+']\x20publisher['+_0x217308+']['+_0x21ec28+_0x5cafc4(0x1aa)+_0x45d603[_0x5cafc4(0x162)]+_0x5cafc4(0x1a4)+_0x4c4e83+')');break;case nats[_0x5cafc4(0x1c2)][_0x5cafc4(0x145)]:_0x5aff94[_0x5cafc4(0x14a)][_0x5cafc4(0x118)](_0x5aff94[_0x5cafc4(0x153)]+'['+_0x5aff94[_0x5cafc4(0x107)]+_0x5cafc4(0x1a7)+_0x217308+']['+_0x21ec28+_0x5cafc4(0x1d8)+_0x45d603[_0x5cafc4(0x162)]);break;}}},_0x21f65d=async(_0x4446a3,_0x36ec9e)=>{const _0x4d4435=a0_0xf886,_0x275901=_0x492bb1[_0x4446a3][_0x4d4435(0x161)]?.[_0x4d4435(0x1f2)]?.[_0x4d4435(0xed)];let _0x458501;try{_0x458501=await nats[_0x4d4435(0x150)](_0x36ec9e);if(_0x458501[_0x4d4435(0x1e4)][_0x4d4435(0x1bf)]!==_0x4d4435(0x1ec)){_0x458501['close']();return;}_0x492bb1[_0x4446a3]['nc']=_0x458501,_0x1088d2(_0x4446a3,_0x458501);}catch(_0x37c7e9){_0x5aff94[_0x4d4435(0x14a)][_0x4d4435(0x110)](_0x5aff94[_0x4d4435(0x153)]+'['+_0x5aff94[_0x4d4435(0x107)]+']\x20publisher['+_0x4446a3+']['+_0x275901+_0x4d4435(0x13a)+_0x37c7e9[_0x4d4435(0x15d)]+'\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration'),_0x36ec9e[_0x4d4435(0x199)]=!![];try{_0x458501=await nats['connect'](_0x36ec9e);if(_0x458501[_0x4d4435(0x1e4)][_0x4d4435(0x1bf)]!=='SCIM\x20Stream'){_0x458501['close']();return;}_0x492bb1[_0x4446a3]['nc']=_0x458501,_0x1088d2(_0x4446a3,_0x458501);}catch(_0x5812c7){_0x5aff94['logger'][_0x4d4435(0x110)](_0x5aff94[_0x4d4435(0x153)]+'['+_0x5aff94[_0x4d4435(0x107)]+_0x4d4435(0x1a7)+_0x4446a3+']['+_0x275901+_0x4d4435(0x13a)+_0x5812c7[_0x4d4435(0x15d)]);return;}}_0x5aff94[_0x4d4435(0x14a)][_0x4d4435(0x118)](_0x5aff94[_0x4d4435(0x153)]+'['+_0x5aff94['pluginName']+_0x4d4435(0x1a7)+_0x4446a3+']['+_0x275901+']\x20connected\x20'+(_0x36ec9e[_0x4d4435(0x1fe)]['ca']?_0x4d4435(0x1fe):'')+'\x20'+_0x458501[_0x4d4435(0x209)]()),_0x458501[_0x4d4435(0x1e7)]()['then'](_0x2cf481=>{const _0x248d47=_0x4d4435;_0x2cf481&&_0x5aff94[_0x248d47(0x14a)][_0x248d47(0x110)](_0x5aff94[_0x248d47(0x153)]+'['+_0x5aff94[_0x248d47(0x107)]+_0x248d47(0x1a7)+_0x4446a3+']['+_0x275901+_0x248d47(0x1c7)+_0x2cf481[_0x248d47(0x15d)]);});};this['add']=async(_0x263fd6,_0x301ea1)=>{const _0x5319c2=a0_0xf886;if(!_0x301ea1?.[_0x5319c2(0x1f2)]){_0x5aff94[_0x5319c2(0x14a)]['error'](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+_0x5319c2(0x1a7)+_0x263fd6+_0x5319c2(0x19b));return;}if(!_0x301ea1?.[_0x5319c2(0x1f2)]?.[_0x5319c2(0x1d4)]){_0x5aff94[_0x5319c2(0x14a)][_0x5319c2(0x110)](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+_0x5319c2(0x1a7)+_0x263fd6+_0x5319c2(0x17f));return;}if(!_0x301ea1?.[_0x5319c2(0x1f2)]?.[_0x5319c2(0xed)]){_0x5aff94[_0x5319c2(0x14a)]['error'](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+']\x20publisher['+_0x263fd6+']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject');return;}if(!_0x301ea1?.['nats']?.[_0x5319c2(0xed)][_0x5319c2(0x1ce)](_0x5319c2(0x17b))){_0x5aff94[_0x5319c2(0x14a)]['error'](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+_0x5319c2(0x1a7)+_0x263fd6+_0x5319c2(0x1f9));return;}if(!_0x301ea1['baseUrls']||!Array[_0x5319c2(0x138)](_0x301ea1[_0x5319c2(0x135)])||_0x301ea1[_0x5319c2(0x135)][_0x5319c2(0x132)]<0x1){_0x5aff94[_0x5319c2(0x14a)][_0x5319c2(0x110)](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+_0x5319c2(0x1a7)+_0x263fd6+_0x5319c2(0x1e6));return;}if(!_0x301ea1?.[_0x5319c2(0xf8)]?.['ca']){_0x5aff94[_0x5319c2(0x14a)][_0x5319c2(0x110)](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+_0x5319c2(0x1a7)+_0x263fd6+_0x5319c2(0x157));return;}const _0x2863d1={};try{let _0x4b00e3=path[_0x5319c2(0x16e)](_0x5aff94[_0x5319c2(0x1f3)],_0x5319c2(0x143),_0x301ea1?.[_0x5319c2(0xf8)]?.['ca']||_0x5319c2(0x127));(_0x301ea1?.[_0x5319c2(0xf8)]?.['ca']?.['startsWith']('/')||_0x301ea1?.['certificate']?.['ca']?.[_0x5319c2(0x1a5)]('\x5c'))&&(_0x4b00e3=_0x301ea1[_0x5319c2(0xf8)]['ca']),_0x2863d1['ca']=[fs['readFileSync'](_0x4b00e3)],_0x2863d1[_0x5319c2(0x11e)]=!![];}catch(_0x254fab){_0x5aff94['logger']['error'](_0x5aff94[_0x5319c2(0x153)]+'['+_0x5aff94[_0x5319c2(0x107)]+_0x5319c2(0x1a7)+_0x263fd6+_0x5319c2(0x139)+_0x254fab[_0x5319c2(0x15d)]);return;}const _0x53a61a={},_0x2d6e43=new TextEncoder()['encode'](_0x301ea1?.[_0x5319c2(0x1f2)]?.[_0x5319c2(0xfb)]),_0x3c0ff1=_0x301ea1?.[_0x5319c2(0x1f2)]?.[_0x5319c2(0x18e)];_0x53a61a[_0x5319c2(0x1f5)]=nats[_0x5319c2(0x154)](_0x3c0ff1,_0x2d6e43),_0x53a61a['servers']=_0x301ea1[_0x5319c2(0x135)],_0x53a61a[_0x5319c2(0x1fe)]=_0x2863d1,_0x53a61a[_0x5319c2(0x199)]=![],_0x53a61a[_0x5319c2(0x112)]=!![],_0x53a61a[_0x5319c2(0x173)]=0x3e8*0xa,_0x53a61a['maxReconnectAttempts']=-0x1,_0x53a61a['pingInterval']=0x2*0x3c*0x3e8,_0x53a61a[_0x5319c2(0x1c9)]=0x5,_0x53a61a[_0x5319c2(0x118)]=![],_0x492bb1[_0x263fd6]={},_0x492bb1[_0x263fd6]['config']=_0x301ea1,_0x492bb1[_0x263fd6]['nc']=undefined,_0x21f65d(_0x263fd6,_0x53a61a);};const _0x1dc85a=nats[_0x2e4f1b(0x189)]();this[_0x2e4f1b(0x137)]=async _0x19b4e5=>{const _0x17f6c4=_0x2e4f1b;let _0x3e4915;try{if(_0x19b4e5[_0x17f6c4(0x141)]===Object){_0x3e4915=_0x19b4e5[_0x17f6c4(0x1bb)];if(!_0x3e4915)_0x19b4e5[_0x17f6c4(0x1bb)]=_0x17f6c4(0x1c1);_0x19b4e5=JSON[_0x17f6c4(0x102)](_0x19b4e5);}else{const _0x3b7a3b=JSON['parse'](_0x19b4e5);_0x3e4915=_0x3b7a3b[_0x17f6c4(0x1bb)];}}catch(_0x2dc6fc){throw new Error(_0x17f6c4(0x151)+_0x3e4915+_0x17f6c4(0x166));}if(!_0x492bb1[_0x3e4915])throw new Error(_0x17f6c4(0x151)+_0x3e4915+_0x17f6c4(0x167)+_0x3e4915);const _0x55970f=nats[_0x17f6c4(0x1ad)]();_0x55970f[_0x17f6c4(0x1b1)](_0x17f6c4(0x108),crypto[_0x17f6c4(0x13f)]());let _0xdf1103;try{if(!_0x492bb1[_0x3e4915]['nc'])throw new Error(_0x17f6c4(0x200));_0xdf1103=await _0x492bb1[_0x3e4915]['nc'][_0x17f6c4(0x114)](_0x492bb1[_0x3e4915][_0x17f6c4(0x161)]?.[_0x17f6c4(0x1f2)]?.[_0x17f6c4(0xed)],_0x1dc85a[_0x17f6c4(0x187)](_0x19b4e5),{'headers':_0x55970f});}catch(_0x125993){if(_0x125993[_0x17f6c4(0x15d)]===_0x17f6c4(0x1f1))throw new Error(_0x17f6c4(0x151)+_0x3e4915+']\x20error:\x20no\x20subscribers/responders\x20to\x20subject\x20'+_0x492bb1[_0x3e4915]['config']?.[_0x17f6c4(0x1f2)]?.['subject']);else throw new Error('publisher['+_0x3e4915+_0x17f6c4(0x1b5)+_0x125993[_0x17f6c4(0x15d)]);}let _0xf3d22a;try{_0xf3d22a=JSON[_0x17f6c4(0x117)](_0xdf1103['string']());}catch(_0x569d32){throw new Error(_0x17f6c4(0x16c)+_0xdf1103[_0x17f6c4(0x1cc)]());}if(_0xf3d22a?.['error']){const _0x6d3343=new Error(_0x17f6c4(0x1ea)+_0xf3d22a[_0x17f6c4(0x110)]);_0x6d3343[_0x17f6c4(0x124)]=_0xf3d22a[_0x17f6c4(0x195)];throw _0x6d3343;}return _0xf3d22a;},process['on']('SIGTERM',async()=>{const _0x33ba80=_0x2e4f1b;for(const _0xcea122 in _0x492bb1){_0x492bb1[_0xcea122]['nc']&&!_0x492bb1[_0xcea122]['nc']['isClosed']()&&await _0x492bb1[_0xcea122]['nc'][_0x33ba80(0x1ca)]();}}),process['on'](_0x2e4f1b(0x155),async()=>{const _0x5cbd04=_0x2e4f1b;for(const _0x5c74c4 in _0x492bb1){_0x492bb1[_0x5c74c4]['nc']&&!_0x492bb1[_0x5c74c4]['nc']['isClosed']()&&await _0x492bb1[_0x5c74c4]['nc'][_0x5cbd04(0x1ca)]();}});},module[a0_0x5a0f4d(0x1e1)][a0_0x5a0f4d(0x16d)]=async(_0x2b519f,_0x1f8042,_0x2ecc73,_0x478615)=>{const _0x182c05=a0_0x5a0f4d,_0x501b22='getAppRoles',_0x2c5296=_0x2b519f;_0x2c5296[_0x182c05(0x14a)][_0x182c05(0x118)](_0x2c5296['gwName']+'['+_0x2c5296[_0x182c05(0x107)]+_0x182c05(0x10d)+_0x501b22+'\x22');try{if(!fs[_0x182c05(0x128)](_0x2c5296[_0x182c05(0x1f3)]+'/approles'))fs[_0x182c05(0x17e)](_0x2c5296[_0x182c05(0x1f3)]+'/approles');}catch(_0x2813ab){}const _0xd77cbf=path[_0x182c05(0x16e)](''+_0x2c5296[_0x182c05(0x1f3)],_0x182c05(0x1ac),_0x182c05(0x207)+_0x2c5296[_0x182c05(0x107)]+_0x182c05(0x1dd)),_0x1ea007={};utils['fsExistsSync'](_0xd77cbf)&&fs[_0x182c05(0x1b4)](_0xd77cbf,_0x182c05(0x208))[_0x182c05(0x1fb)](/\r?\n/)[_0x182c05(0x159)](_0x3a8038=>{const _0x40ce79=_0x182c05,_0x34e53b=_0x3a8038['split']('\x20');_0x34e53b[_0x40ce79(0x132)]===0x2&&(_0x1ea007[_0x34e53b[0x0]]=_0x34e53b[0x1]);});const _0x1d719d=fs[_0x182c05(0x1de)](_0xd77cbf,{'flags':'w','encoding':'utf8','mode':0x1b6,'autoClose':!![]}),_0x36dc31=[],_0x21e161=await _0x2c5296[_0x182c05(0x116)](_0x1f8042,{'attribute':undefined,'operator':undefined,'value':undefined},['id',_0x182c05(0x105)]);return _0x21e161[_0x182c05(0x1f6)][_0x182c05(0x159)](_0x100826=>{const _0x49c36d=_0x182c05;if(_0x100826['id']){let _0x5a3332=crypto['randomUUID']();if(_0x1ea007[_0x100826['id']])_0x5a3332=_0x1ea007[_0x100826['id']];const _0x18c885={'allowedMemberTypes':[_0x49c36d(0x176)],'description':_0x49c36d(0x19e),'displayName':_0x100826[_0x49c36d(0x105)]||_0x100826['id'],'id':_0x5a3332,'isEnabled':!![],'lang':null,'origin':_0x49c36d(0x119),'value':decodeURIComponent(_0x100826['id'])};_0x36dc31[_0x49c36d(0x16f)](_0x18c885),_0x1d719d[_0x49c36d(0x1a9)](_0x100826['id']+'\x20'+_0x5a3332+'\x0a');}}),_0x1d719d['close'](),_0x2c5296[_0x182c05(0x14a)][_0x182c05(0x118)](_0x2c5296['gwName']+'['+_0x2c5296['pluginName']+']\x20approle\x20uuid\x20file\x20created:\x20'+_0xd77cbf),{'Resources':[{'appRoles':_0x36dc31}]};};