// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          Gateway publishing to SCIM Stream having other gateways as subscribers handling requests
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: scim-stream.js is part of the licensed SCIM Stream which is a prerequisite for message Pub/Sub
//       for details see: https://elshaug.xyz/docs/scim-stream
//
'use strict';const a0_0x2ad4e4=a0_0x7bcd;(function(_0x2159da,_0x1cd6cf){const _0x364e9f=a0_0x7bcd,_0xc901f9=_0x2159da();while(!![]){try{const _0x54c0b3=-parseInt(_0x364e9f(0x13a))/0x1*(-parseInt(_0x364e9f(0x138))/0x2)+parseInt(_0x364e9f(0x16a))/0x3*(parseInt(_0x364e9f(0xf9))/0x4)+-parseInt(_0x364e9f(0x1b5))/0x5+-parseInt(_0x364e9f(0x1a8))/0x6+parseInt(_0x364e9f(0x188))/0x7+parseInt(_0x364e9f(0x19e))/0x8+-parseInt(_0x364e9f(0x147))/0x9;if(_0x54c0b3===_0x1cd6cf)break;else _0xc901f9['push'](_0xc901f9['shift']());}catch(_0x4f48c0){_0xc901f9['push'](_0xc901f9['shift']());}}}(a0_0x1c1a,0x86d37));function a0_0x1c1a(){const _0x3d9ff8=['##doIncrement','includes','\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available','request','modifyOnly','putApi','\x20error:\x20missing\x20id}','approles_','Disconnect','rejectUnauthorized','false','remove','replaceUsrGrp','getServer','crypto','2zOShak','respond','1103814rpgQCV','indexOf',']\x20subscriber\x20stopped\x20error:\x20','\x20message:\x20user\x20does\x20not\x20exist','handle','obj','parse','originalUrl','\x20message\x20handled:\x20','utf8','timeout','baseUrls','\x22,\x22errName\x22:\x22','12227634dUNtkU','delete','detail','value',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject','lowercase','DeliverPolicy','toUpperCase','getAppRoles','\x20Delete\x20User\x20userName=','publisher[','replace','update','decode',']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls','normalize','debug','SCIM\x20Stream','\x20=>\x20subscriber\x20not\x20activated','\x20convertedScim20\x20error:\x20','patchApi',',\x20attributes=',']\x20subscriber[','secret','increment','split',']\x20initialization\x20error:\x20nats.subject\x20root\x20topic\x20must\x20be\x20\x27GW\x27,\x20nats.subject\x20example:\x20GW.APP1','subscriber\x20message\x20error:\x20handle\x20\x27','\x20Replace\x20User\x20id=','jwtAuthenticator','servers','SIGTERM','configDir','\x20createUser()\x20obj=','level','2652009gLvXYX','subject','ack','reconnectTimeWait','Resources','tls','baseEntity','\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true','randomUUID','\x20-\x20','push','connect','prototype',']\x20closed\x20with\x20error:\x20','write','name',']\x20connected\x20','description','info','ENOTFOUND',']\x20initialization\x20error:\x20missing\x20certificate\x20configuration','headers',']\x20client\x20has\x20a\x20stale\x20connection\x20','string','passThrough','activityOperation','\x20missing\x20user\x20object\x20in\x20message:\x20','jetstreamManager','file-not-configured','jwt','1519280bhcmzC','ETIMEDOUT','set','Error','\x20message\x20json\x20parsing\x20error:\x20','body','Reconnect','attributes','pingInterval','substring',']\x20client\x20disconnected\x20',']\x20error:\x20message\x20must\x20be\x20JSON\x20formatted','SCIM\x20Stream\x20-\x20Autogenerated','encode','trim','Explicit',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant','data','\x20message\x20error\x20response:\x20','config','elementnumber','DebugEvents','7027344WsagdU','exports','uppercase','\x20result=','ctxPassThrough','toString','onCreate','charAt','503','replaceAll','4404270dtpFmn','publisher\x20error:\x20none\x20JSON\x20formatted\x20response:\x20','query','\x20Delete\x20User\x20id=','\x20done','../lib/utils','path','\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration','StaleConnection','length','add',']\x20publisher[','\x20Create\x20User\x20userName=','2191785VBvtbd','displayName',']\x20initialization\x20error:\x20missing\x20configuration\x20nats','{\x22error\x22:\x22','internal\x20stream\x20policy\x20have\x20been\x20changed\x20-\x20central\x20SCIM\x20Stream\x20must\x20be\x20stopped\x20and\x20corresponding\x20./jetstream\x20folder\x20deleted\x20before\x20startup\x20allowing\x20new\x20policy','GW.','subscriber\x20message\x20error:\x20message\x20baseEntity=','close','_info','user','roles','getUsers()\x20getObj=','Msg-Id','\x20processing\x20incoming\x20message','\x20getUserId()\x20error:\x20',',true','nats','Events','type','deleteGroup','logger',']\x20connect\x20error:\x20','display','readFileSync','drain','All',']\x20client\x20is\x20attempting\x20to\x20reconnect\x20','/certs/','Operations','waitOnFirstConnect',']\x20client\x20reconnected\x20','getGroups','deleteUserOnLastGroupRoleRemoval','existsSync','params','deleteApi','operation','from','file','Reconnecting','\x20roles\x20converted\x20to\x20groups:\x20','consumers','stringify','gwName','getUsers','groups','schemas','deleteUser','durable_','authenticator','maxPingOut','SIGINT','subscriber\x20message\x20error:\x20message\x20missing\x20handle','server_name','approles','copyObj','\x20message:\x20','modifyGroup','\x20error:\x20','Subscriber','UnableConnectingService',']\x20error:\x20','error','true','password','userName','\x20Create\x20userName=','call','undefined','closed','typeId','4kXCVvp','createWriteStream','\x20(count=','\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true','getuniquevalue','toLowerCase','replaceDomains','forEach','reconnect','join','certificate','startsWith','constructor',']\x20client\x20error\x20','ECONNREFUSED','jetstream','firstn','then','\x20error:\x20missing\x20result','HR.','subscriber\x20message\x20error:\x20message\x20not\x20JSON\x20formatted','transports','\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false','status','StringCodec','modifyUser','skipConvertRolesToGroups','message','foldReplacing','utf-8',']\x20initialization\x20certificate\x20error:\x20','Publisher','pluginName',',false','User','createRandomPassword','Errors','isArray','\x20handling\x20message:\x20','all',',\x20obj=','/Users/','sub','get','usePutSoftSync','doIncrement','isClosed','active'];a0_0x1c1a=function(){return _0x3d9ff8;};return a0_0x1c1a();}function a0_0x7bcd(_0x245a4b,_0x55c34b){const _0x1c1a27=a0_0x1c1a();return a0_0x7bcd=function(_0x7bcd61,_0x54c915){_0x7bcd61=_0x7bcd61-0xf0;let _0x198ea0=_0x1c1a27[_0x7bcd61];return _0x198ea0;},a0_0x7bcd(_0x245a4b,_0x55c34b);}const nats=require(a0_0x2ad4e4(0x1c5)),ascii127=require('fold-to-ascii'),fs=require('fs'),utils=require(a0_0x2ad4e4(0x1ad)),path=require(a0_0x2ad4e4(0x1ae)),crypto=require(a0_0x2ad4e4(0x137));module[a0_0x2ad4e4(0x19f)][a0_0x2ad4e4(0x1f0)]=function(_0xc533ab){const _0x375032=a0_0x2ad4e4,_0x2a0389=_0xc533ab,_0x2f6dd3={};let _0x5eec2c='';for(let _0x288c56=0x0;_0x288c56<_0x2a0389[_0x375032(0x1c9)][_0x375032(0x10e)][_0x375032(0x1b1)];_0x288c56++){if(_0x2a0389['logger']['transports'][_0x288c56][_0x375032(0x179)]===_0x375032(0x1db)){_0x5eec2c=_0x2a0389[_0x375032(0x1c9)][_0x375032(0x10e)][_0x288c56][_0x375032(0x169)];break;}}const _0x77a231=''+(_0x5eec2c==='debug'?'\x0a':''),_0x298c5b=async(_0x5171a7,_0x26c189)=>{const _0x495dd1=_0x375032,_0x1833cc=_0x2f6dd3[_0x5171a7][_0x495dd1(0x19b)]?.['nats']?.[_0x495dd1(0x16b)];let _0xd54145;try{_0xd54145=await nats[_0x495dd1(0x175)](_0x26c189);if(_0xd54145['info'][_0x495dd1(0x1ea)]!=='SCIM\x20Stream'){_0xd54145[_0x495dd1(0x1bc)]();return;}_0x2f6dd3[_0x5171a7]['nc']=_0xd54145,_0x3b536e(_0x5171a7,_0xd54145),_0x549abb(_0x5171a7,_0xd54145);}catch(_0xdb95b9){_0x2a0389[_0x495dd1(0x1c9)][_0x495dd1(0xf0)](_0x2a0389[_0x495dd1(0x1e0)]+'['+_0x2a0389[_0x495dd1(0x119)]+']\x20subscriber['+_0x5171a7+']['+_0x1833cc+_0x495dd1(0x1ca)+_0xdb95b9[_0x495dd1(0x114)]+_0x495dd1(0x1af)),_0x26c189['waitOnFirstConnect']=!![];try{_0xd54145=await nats['connect'](_0x26c189);if(_0xd54145['info'][_0x495dd1(0x1ea)]!==_0x495dd1(0x158)){_0xd54145[_0x495dd1(0x1bc)]();return;}_0x2f6dd3[_0x5171a7]['nc']=_0xd54145,_0x3b536e(_0x5171a7,_0xd54145),_0x549abb(_0x5171a7,_0xd54145);}catch(_0x23f8a3){_0x2a0389[_0x495dd1(0x1c9)][_0x495dd1(0xf0)](_0x2a0389[_0x495dd1(0x1e0)]+'['+_0x2a0389[_0x495dd1(0x119)]+_0x495dd1(0x15d)+_0x5171a7+']['+_0x1833cc+_0x495dd1(0x1ca)+_0x23f8a3['message']);return;}}_0x2a0389[_0x495dd1(0x1c9)][_0x495dd1(0x157)](_0x2a0389[_0x495dd1(0x1e0)]+'['+_0x2a0389['pluginName']+']\x20subscriber['+_0x5171a7+']['+_0x1833cc+']\x20connected\x20'+(_0x26c189[_0x495dd1(0x16f)]['ca']?_0x495dd1(0x16f):'')+'\x20'+_0xd54145['getServer']()),_0xd54145[_0x495dd1(0xf7)]()[_0x495dd1(0x10a)](_0x57a741=>{const _0x570bec=_0x495dd1;_0x57a741&&_0x2a0389[_0x570bec(0x1c9)][_0x570bec(0xf0)](_0x2a0389['gwName']+'['+_0x2a0389[_0x570bec(0x119)]+']\x20subscriber['+_0x5171a7+']['+_0x1833cc+_0x570bec(0x177)+_0x57a741[_0x570bec(0x114)]);});};this['add']=async(_0x5b86f0,_0x23ceeb)=>{const _0x264667=_0x375032;if(!_0x23ceeb?.['nats']){_0x2a0389[_0x264667(0x1c9)][_0x264667(0xf0)](_0x2a0389['gwName']+'['+_0x2a0389['pluginName']+_0x264667(0x15d)+_0x5b86f0+']\x20initialization\x20error:\x20missing\x20configuration\x20nats');return;}if(!_0x23ceeb?.[_0x264667(0x1c5)]?.['tenant']){_0x2a0389[_0x264667(0x1c9)][_0x264667(0xf0)](_0x2a0389[_0x264667(0x1e0)]+'['+_0x2a0389[_0x264667(0x119)]+_0x264667(0x15d)+_0x5b86f0+']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant');return;}if(!_0x23ceeb?.[_0x264667(0x1c5)]?.[_0x264667(0x16b)]){_0x2a0389[_0x264667(0x1c9)][_0x264667(0xf0)](_0x2a0389['gwName']+'['+_0x2a0389['pluginName']+_0x264667(0x15d)+_0x5b86f0+_0x264667(0x14b));return;}if(!_0x23ceeb?.['certificate']?.['ca']){_0x2a0389[_0x264667(0x1c9)][_0x264667(0xf0)](_0x2a0389['gwName']+'['+_0x2a0389[_0x264667(0x119)]+_0x264667(0x15d)+_0x5b86f0+_0x264667(0x17e));return;}if(!_0x23ceeb[_0x264667(0x145)]||!Array[_0x264667(0x11e)](_0x23ceeb[_0x264667(0x145)])||_0x23ceeb['baseUrls'][_0x264667(0x1b1)]<0x1){_0x2a0389['logger'][_0x264667(0xf0)](_0x2a0389[_0x264667(0x1e0)]+'['+_0x2a0389['pluginName']+_0x264667(0x15d)+_0x5b86f0+_0x264667(0x155));return;}if(!_0x23ceeb[_0x264667(0x125)]){const _0x522033=_0x23ceeb?.[_0x264667(0x1c5)]?.[_0x264667(0x16b)][_0x264667(0x14e)]();if(_0x522033[_0x264667(0x104)](_0x264667(0x10c)))_0x23ceeb[_0x264667(0x125)]=!![];}const _0x24d2c6={};try{let _0x50be22=path[_0x264667(0x102)](_0x2a0389[_0x264667(0x167)],_0x264667(0x1d0),_0x23ceeb?.['certificate']?.['ca']||_0x264667(0x186));(_0x23ceeb?.[_0x264667(0x103)]?.['ca']?.[_0x264667(0x104)]('/')||_0x23ceeb?.[_0x264667(0x103)]?.['ca']?.[_0x264667(0x12a)]('\x5c'))&&(_0x50be22=_0x23ceeb[_0x264667(0x103)]['ca']),_0x24d2c6['ca']=[fs[_0x264667(0x1cc)](_0x50be22)],_0x24d2c6[_0x264667(0x132)]=!![];}catch(_0x2b0d41){_0x2a0389[_0x264667(0x1c9)]['error'](_0x2a0389[_0x264667(0x1e0)]+'['+_0x2a0389[_0x264667(0x119)]+_0x264667(0x15d)+_0x5b86f0+_0x264667(0x117)+_0x2b0d41[_0x264667(0x114)]);return;}const _0x2ae1b6={},_0x152eba=new TextEncoder()[_0x264667(0x195)](_0x23ceeb?.[_0x264667(0x1c5)]?.[_0x264667(0x15e)]),_0x5da4e4=_0x23ceeb?.[_0x264667(0x1c5)]?.['jwt'];_0x2ae1b6[_0x264667(0x1e6)]=nats[_0x264667(0x164)](_0x5da4e4,_0x152eba),_0x2ae1b6[_0x264667(0x165)]=_0x23ceeb[_0x264667(0x145)],_0x2ae1b6['tls']=_0x24d2c6,_0x2ae1b6['waitOnFirstConnect']=![],_0x2ae1b6['reconnect']=!![],_0x2ae1b6['reconnectTimeWait']=0x3e8*0xa,_0x2ae1b6['maxReconnectAttempts']=-0x1,_0x2ae1b6['pingInterval']=0x2*0x3c*0x3e8,_0x2ae1b6['maxPingOut']=0x5,_0x2ae1b6[_0x264667(0x157)]=![],_0x2f6dd3[_0x5b86f0]={},_0x2f6dd3[_0x5b86f0][_0x264667(0x19b)]=_0x23ceeb,_0x2f6dd3[_0x5b86f0]['nc']=undefined,_0x2f6dd3[_0x5b86f0][_0x264667(0x123)]=undefined,_0x298c5b(_0x5b86f0,_0x2ae1b6);};const _0x549abb=async(_0x11a74c,_0x117e8a)=>{const _0x27c58=_0x375032,_0x4a3c1c=_0x2f6dd3[_0x11a74c]['config'],_0x1be0d9=_0x4a3c1c?.[_0x27c58(0x1c5)]?.[_0x27c58(0x16b)];if(!_0x117e8a){_0x2a0389[_0x27c58(0x1c9)][_0x27c58(0xf0)](_0x2a0389[_0x27c58(0x1e0)]+'['+_0x2a0389['pluginName']+_0x27c58(0x15d)+_0x11a74c+']['+_0x1be0d9+']\x20error:\x20client\x20have\x20not\x20been\x20initialized');return;}const _0x1dc621=async(_0xdff44d,_0x32458c)=>{const _0x917b52=_0x27c58;try{_0x2a0389[_0x917b52(0x1c9)]['info'](_0xdff44d+_0x917b52(0x11f)+_0x32458c);let _0x197126;try{if(_0x4a3c1c[_0x917b52(0xff)]&&Array['isArray'](_0x4a3c1c[_0x917b52(0xff)]))for(let _0x58c7c6=0x0;_0x58c7c6<_0x4a3c1c['replaceDomains'][_0x917b52(0x1b1)];_0x58c7c6++){const _0x4acba6=_0x4a3c1c[_0x917b52(0xff)][_0x58c7c6];if(!_0x4acba6[_0x917b52(0x1da)]||!_0x4acba6[_0x917b52(0x1da)][_0x917b52(0x12a)]('.')||!_0x4acba6['to']||!_0x4acba6['to']['includes']('.'))continue;const _0x4bbdfb=new RegExp('@'+_0x4acba6['from']+'\x22','gi');_0x32458c=_0x32458c['replace'](_0x4bbdfb,'@'+_0x4acba6['to']+'\x22');}_0x197126=JSON[_0x917b52(0x140)](_0x32458c);}catch(_0x376cea){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+_0x917b52(0x18c)+_0x376cea[_0x917b52(0x114)]+_0x917b52(0x1ed)+_0x32458c),_0x2a0389['logger'][_0x917b52(0x157)](_0xdff44d+'\x20done'+_0x77a231);return;}const _0xcff90b=_0x197126[_0x917b52(0x1be)];if(!_0xcff90b){_0x2a0389['logger'][_0x917b52(0xf0)](_0xdff44d+_0x917b52(0x184)+JSON['stringify'](_0x197126)),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+'\x20done'+_0x77a231);return;}if(!_0xcff90b['userName']){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+'\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20'+JSON['stringify'](_0x197126)),_0x2a0389[_0x917b52(0x1c9)]['debug'](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}delete _0xcff90b[_0x917b52(0x1e3)];let _0x6d107f;_0xcff90b['id']&&(_0x6d107f=_0xcff90b['id'],delete _0xcff90b['id']);let _0x26fa62;_0xcff90b['onCreate']&&(_0x26fa62=utils['copyObj'](_0xcff90b[_0x917b52(0x1a4)]),delete _0xcff90b['onCreate']);await _0x162af5(_0x11a74c,_0xcff90b);const _0x216f27=_0xcff90b[_0x917b52(0xf3)];let _0x49f5e6,_0xb395be;try{_0x49f5e6=await _0x5d75a1(_0x11a74c,_0x917b52(0xf3),_0x216f27);}catch(_0x18ab71){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+_0x917b52(0x1c3)+_0x18ab71[_0x917b52(0x114)]),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+'\x20done'+_0x77a231);const _0x181cf1=['UnableConnectingHost',_0x917b52(0x1f1),_0x917b52(0x107),_0x917b52(0x17d),_0x917b52(0x189),_0x917b52(0x144)];for(const _0x508513 in _0x181cf1){if(_0x18ab71[_0x917b52(0x114)][_0x917b52(0x12a)](_0x508513))return!![];}return;}if(!_0x4a3c1c[_0x917b52(0x113)]){let _0x33ee0d=![];if(_0x197126[_0x917b52(0x1d1)]&&Array[_0x917b52(0x11e)](_0x197126['Operations']))for(let _0x4dcff6=0x0;_0x4dcff6<_0x197126['Operations']['length'];_0x4dcff6++){const _0xd5cfba=_0x197126[_0x917b52(0x1d1)][_0x4dcff6];_0xd5cfba[_0x917b52(0x1ae)][_0x917b52(0x104)](_0x917b52(0x1bf))&&(_0xd5cfba[_0x917b52(0x1ae)]='groups',Array[_0x917b52(0x11e)](_0xd5cfba[_0x917b52(0x14a)])?(_0xd5cfba[_0x917b52(0x14a)][0x0]['id']=_0xd5cfba[_0x917b52(0x14a)][0x0][_0x917b52(0x14a)],_0xd5cfba[_0x917b52(0x14a)][0x0][_0x917b52(0x1cb)]=_0xd5cfba[_0x917b52(0x14a)][0x0][_0x917b52(0x1c7)]+'\x20-\x20'+_0xd5cfba['value'][0x0][_0x917b52(0x14a)],delete _0xd5cfba['value'][0x0][_0x917b52(0x14a)],delete _0xd5cfba['value'][0x0]['type']):_0xd5cfba[_0x917b52(0x14a)]=[{'id':_0xd5cfba[_0x917b52(0x14a)],'display':_0xd5cfba[_0x917b52(0x14a)]}],delete _0xd5cfba[_0x917b52(0xf8)],_0x33ee0d=!![]);}if(_0xcff90b[_0x917b52(0x1bf)]&&Array[_0x917b52(0x11e)](_0xcff90b[_0x917b52(0x1bf)])&&_0xcff90b[_0x917b52(0x1bf)][_0x917b52(0x1b1)]>0x0){if(!_0xcff90b['groups'])_0xcff90b[_0x917b52(0x1e2)]=[];if(!Array['isArray'](_0xcff90b[_0x917b52(0x1e2)]))_0xcff90b[_0x917b52(0x1e2)]=[];for(let _0x4a143f=0x0;_0x4a143f<_0xcff90b['roles'][_0x917b52(0x1b1)];_0x4a143f++){const _0x44633e={},_0x5c0afc=_0xcff90b[_0x917b52(0x1bf)][_0x4a143f];_0x44633e[_0x917b52(0x14a)]=_0x5c0afc[_0x917b52(0x14a)],_0x44633e['display']=_0x5c0afc[_0x917b52(0x1c7)]+_0x917b52(0x173)+_0x5c0afc[_0x917b52(0x1cb)],_0xcff90b['groups'][_0x917b52(0x174)](_0x44633e);}delete _0xcff90b['roles'],_0x33ee0d=!![];}if(_0x33ee0d)_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1dd)+JSON[_0x917b52(0x1df)](_0x197126));}if(!_0x49f5e6){if(_0x197126[_0x917b52(0x183)]===_0x917b52(0x1e4)){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x150)+_0x216f27+_0x917b52(0x13d)),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}if(_0x4a3c1c[_0x917b52(0x12d)]&&_0x4a3c1c[_0x917b52(0x12d)]===!![]){_0x2a0389[_0x917b52(0x1c9)]['debug'](_0xdff44d+_0x917b52(0xf4)+_0x216f27+_0x917b52(0x171)),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+'\x20done'+_0x77a231);return;}if(Object[_0x917b52(0x176)]['hasOwnProperty'][_0x917b52(0xf5)](_0xcff90b,_0x917b52(0x128))){if(typeof _0xcff90b['active']===_0x917b52(0x181)){const _0x2dd703=_0xcff90b['active'][_0x917b52(0xfe)]();if(_0x2dd703===_0x917b52(0xf1))_0xcff90b[_0x917b52(0x128)]=!![];else{if(_0x2dd703===_0x917b52(0x133))_0xcff90b[_0x917b52(0x128)]=![];}}if(_0xcff90b[_0x917b52(0x128)]===![]){_0x2a0389['logger'][_0x917b52(0x157)](_0xdff44d+_0x917b52(0xf4)+_0x216f27+_0x917b52(0x10f)),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}}_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1b4)+_0x216f27);const _0x4598f4=utils[_0x917b52(0x1ec)](_0xcff90b);try{delete _0x4598f4[_0x917b52(0x1e2)];!_0x4598f4[_0x917b52(0xf2)]&&_0x4a3c1c['generateUserPassword']&&_0x4a3c1c['generateUserPassword']===!![]&&(_0x4598f4[_0x917b52(0xf2)]=utils[_0x917b52(0x11c)](0xf));if(_0x26fa62||_0x6d107f){if(_0x26fa62)for(const _0x19f9fe in _0x26fa62){_0x4598f4[_0x19f9fe]=_0x26fa62[_0x19f9fe];}if(_0x6d107f)_0x4598f4['id']=_0x6d107f;await _0x162af5(_0x11a74c,_0x4598f4);}await _0x2a0389['createUser'](_0x11a74c,_0x4598f4),_0xcff90b[_0x917b52(0x1e2)]&&Array['isArray'](_0xcff90b[_0x917b52(0x1e2)])&&_0xcff90b['groups'][_0x917b52(0x1b1)]>0x0&&(_0xb395be=await _0x5d75a1(_0x11a74c,_0x917b52(0xf3),_0x216f27));}catch(_0x2b64ab){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+_0x917b52(0x168)+JSON[_0x917b52(0x1df)](_0x4598f4)+_0x917b52(0x1ef)+_0x2b64ab[_0x917b52(0x114)]+'}'),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}}if(_0x49f5e6||_0xb395be){if(_0x197126[_0x917b52(0x183)]===_0x917b52(0x1e4)){if(_0x4a3c1c[_0x917b52(0x12d)]&&_0x4a3c1c[_0x917b52(0x12d)]===!![]){_0x2a0389['logger'][_0x917b52(0x157)](_0xdff44d+'\x20Delete\x20User\x20id='+_0x49f5e6+_0x917b52(0xfc)),_0x2a0389['logger'][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}_0x2a0389['logger'][_0x917b52(0x157)](_0xdff44d+'\x20Delete\x20User\x20id='+_0x49f5e6);try{await _0x2a0389[_0x917b52(0x1e4)](_0x11a74c,_0x49f5e6);}catch(_0x4227fc){_0x2a0389[_0x917b52(0x1c9)]['error'](_0xdff44d+_0x917b52(0x1ab)+_0x49f5e6+_0x917b52(0x1ef)+_0x4227fc[_0x917b52(0x114)]+'}'),_0x2a0389[_0x917b52(0x1c9)]['debug'](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}}else{if(_0xb395be)_0x49f5e6=_0xb395be;_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x163)+_0x49f5e6);const _0x220e97={};_0x220e97[_0x917b52(0x18a)]=()=>{},_0x220e97[_0x917b52(0x1d7)]={},_0x220e97[_0x917b52(0x1d7)][_0x917b52(0x170)]=_0x11a74c,_0x220e97[_0x917b52(0x1d7)]['id']=_0x49f5e6,_0x220e97[_0x917b52(0x12c)]={},_0x220e97[_0x917b52(0x12c)][_0x917b52(0x141)]=_0x11a74c?'/'+_0x11a74c+_0x917b52(0x122)+_0x49f5e6:_0x917b52(0x122)+_0x49f5e6,_0x220e97[_0x917b52(0x12c)]['body']=_0xcff90b;try{await _0x2a0389[_0x917b52(0x135)](_0x220e97,_0x4a3c1c[_0x917b52(0x125)]);}catch(_0x3cc849){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+_0x917b52(0x163)+_0x49f5e6+_0x917b52(0x1ef)+_0x3cc849[_0x917b52(0x114)]),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+'\x20done'+_0x77a231);return;}if(_0x220e97[_0x917b52(0x110)]&&(_0x220e97[_0x917b52(0x110)]<0xc8||_0x220e97['status']>0x12b)){if(_0x220e97[_0x917b52(0x18d)]){if(_0x220e97[_0x917b52(0x18d)][_0x917b52(0x149)]){let _0x4f4f01=_0x220e97[_0x917b52(0x18d)][_0x917b52(0x149)];_0x4f4f01=_0x4f4f01[_0x917b52(0x152)](_0x2a0389['gwName']+'['+_0x2a0389[_0x917b52(0x119)]+']',''+_0xdff44d),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](''+_0x4f4f01);}else{if(_0x220e97[_0x917b52(0x18d)][_0x917b52(0x11d)]&&Array[_0x917b52(0x11e)](_0x220e97[_0x917b52(0x18d)][_0x917b52(0x11d)])&&_0x220e97[_0x917b52(0x18d)]['Errors'][_0x917b52(0x1b1)]>0x0){let _0x58de21=_0x220e97[_0x917b52(0x18d)][_0x917b52(0x11d)][0x0][_0x917b52(0x17b)];_0x58de21=_0x58de21[_0x917b52(0x152)](_0x2a0389[_0x917b52(0x1e0)]+'['+_0x2a0389[_0x917b52(0x119)]+']',''+_0xdff44d),_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](''+_0x58de21);}}}}if(_0x4a3c1c[_0x917b52(0x125)]){const [_0x54e9b8,_0x48f36d]=_0x2a0389['convertedScim20']({'Operations':_0x197126[_0x917b52(0x1d1)]});if(_0x48f36d){_0x2a0389[_0x917b52(0x1c9)]['error'](_0xdff44d+_0x917b52(0x163)+_0x49f5e6+_0x917b52(0x15a)+_0x48f36d[_0x917b52(0x114)]),_0x2a0389['logger'][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}const _0x434f3a=[];if(_0x54e9b8[_0x917b52(0x1bf)]&&Array['isArray'](_0x54e9b8['roles']))for(let _0x2fb5dd=0x0;_0x2fb5dd<_0x54e9b8[_0x917b52(0x1bf)][_0x917b52(0x1b1)];_0x2fb5dd++){_0x54e9b8[_0x917b52(0x1bf)][_0x2fb5dd]['operation']&&_0x54e9b8[_0x917b52(0x1bf)][_0x2fb5dd]['operation']===_0x917b52(0x148)&&_0x434f3a['push'](_0x54e9b8[_0x917b52(0x1bf)][_0x2fb5dd]);}if(_0x434f3a[_0x917b52(0x1b1)]>0x0)try{await _0x2a0389[_0x917b52(0x112)](_0x11a74c,_0x49f5e6,{'roles':_0x434f3a});}catch(_0x1a386d){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+_0x917b52(0x163)+_0x49f5e6+'\x20role\x20removal\x20error:\x20'+_0x1a386d[_0x917b52(0x114)]);}const _0x40455a=[];if(_0x54e9b8['groups']&&Array[_0x917b52(0x11e)](_0x54e9b8[_0x917b52(0x1e2)]))for(let _0x5a8057=0x0;_0x5a8057<_0x54e9b8[_0x917b52(0x1e2)]['length'];_0x5a8057++){_0x54e9b8[_0x917b52(0x1e2)][_0x5a8057][_0x917b52(0x1d9)]&&_0x54e9b8[_0x917b52(0x1e2)][_0x5a8057][_0x917b52(0x1d9)]===_0x917b52(0x148)&&_0x40455a[_0x917b52(0x174)](_0x54e9b8[_0x917b52(0x1e2)][_0x5a8057]);}if(_0x40455a[_0x917b52(0x1b1)]>0x0)for(let _0x31cfe8=0x0;_0x31cfe8<_0x40455a[_0x917b52(0x1b1)];_0x31cfe8++){try{await _0x2a0389[_0x917b52(0x1ee)](_0x11a74c,_0x40455a[_0x31cfe8]['id'],{'members':[{'operation':_0x917b52(0x148),'value':_0x49f5e6}]});}catch(_0xb09c4c){_0x2a0389['logger']['error'](_0xdff44d+_0x917b52(0x163)+_0x49f5e6+'\x20group\x20removal\x20error:\x20'+_0xb09c4c['message']);}}}if(_0x4a3c1c[_0x917b52(0x1d5)]&&_0x197126[_0x917b52(0x183)]===_0x917b52(0x112)){if(_0xcff90b['groups']&&Array[_0x917b52(0x11e)](_0xcff90b[_0x917b52(0x1e2)])&&_0xcff90b[_0x917b52(0x1e2)][_0x917b52(0x1b1)]===0x0){if(_0xcff90b[_0x917b52(0x1bf)]&&Array[_0x917b52(0x11e)](_0xcff90b[_0x917b52(0x1bf)])&&_0xcff90b[_0x917b52(0x1bf)][_0x917b52(0x1b1)]===0x0){if(_0x197126[_0x917b52(0x1d1)]&&Array[_0x917b52(0x11e)](_0x197126[_0x917b52(0x1d1)])&&_0x197126[_0x917b52(0x1d1)][_0x917b52(0x1b1)]>0x0){let _0x383183=![];for(let _0x1374d0=0x0;_0x1374d0<_0x197126['Operations'][_0x917b52(0x1b1)];_0x1374d0++){const _0x4b7999=_0x197126[_0x917b52(0x1d1)][_0x1374d0];if(_0x4b7999['op']===_0x917b52(0x134)){if(_0x4b7999[_0x917b52(0x1ae)]){if(_0x4b7999['path']['startsWith']('roles')&&_0x4b7999['typeId']){_0x383183=!![];break;}else{if(_0x4b7999[_0x917b52(0x1ae)]==='groups'){_0x383183=!![];break;}}}}}if(_0x383183){_0x2a0389[_0x917b52(0x1c9)]['debug'](_0xdff44d+_0x917b52(0x1ab)+_0x49f5e6);try{await _0x2a0389[_0x917b52(0x1e4)](_0x11a74c,_0x49f5e6);}catch(_0x3950eb){_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0xf0)](_0xdff44d+'\x20Delete\x20User\x20id='+_0x49f5e6+_0x917b52(0x1ef)+_0x3950eb['message']+'}'),_0x2a0389[_0x917b52(0x1c9)]['debug'](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);return;}}}}}}}}_0x2a0389[_0x917b52(0x1c9)][_0x917b52(0x157)](_0xdff44d+_0x917b52(0x1ac)+_0x77a231);}catch(_0x332a0e){_0x2a0389['logger']['error'](_0x2a0389[_0x917b52(0x1e0)]+'['+_0x2a0389['pluginName']+']\x20subscriber['+_0x11a74c+']['+_0x1be0d9+']\x20error:\x20'+_0x332a0e[_0x917b52(0x114)]+_0x917b52(0x159)+_0x77a231);}},_0x5d328b=nats[_0x27c58(0x111)](),_0x18488f=_0x117e8a[_0x27c58(0x108)](),_0x3beace=(_0x27c58(0x1e5)+_0x2a0389[_0x27c58(0x119)]+'_'+_0x11a74c)['replaceAll']('*','#')[_0x27c58(0x1a7)]('>','##')[_0x27c58(0x1a7)]('.','_'),_0x10406a=_0x1be0d9[_0x27c58(0x160)]('.')[0x0][_0x27c58(0x14e)]()==='GW',_0x238d0d=async()=>{const _0x5bb862=_0x27c58;try{let _0x45ba8b;const _0x3abe35=''+_0x4a3c1c?.[_0x5bb862(0x1c5)]?.['tenant'],_0x3d30c0=await _0x117e8a[_0x5bb862(0x185)](),_0x4b2f38=async()=>{const _0x5d3c86=_0x5bb862;let _0x8e72c0;try{_0x8e72c0=await _0x18488f[_0x5d3c86(0x1de)][_0x5d3c86(0x124)](_0x3abe35,_0x3beace);}catch(_0x861829){const _0x371bd2={'durable_name':_0x3beace,'deliver_policy':nats[_0x5d3c86(0x14d)][_0x5d3c86(0x1ce)],'ack_policy':nats['AckPolicy'][_0x5d3c86(0x197)],'filter_subject':_0x1be0d9};await _0x3d30c0['consumers'][_0x5d3c86(0x1b2)](_0x3abe35,_0x371bd2),_0x8e72c0=await _0x18488f[_0x5d3c86(0x1de)][_0x5d3c86(0x124)](_0x3abe35,_0x3beace);}if(_0x8e72c0?.['_info']?.[_0x5d3c86(0x19b)]?.['deliver_policy']!==_0x5d3c86(0x120))throw new Error(_0x5d3c86(0x1b9));_0x8e72c0?.[_0x5d3c86(0x1bd)]?.[_0x5d3c86(0x19b)]?.['filter_subject']!==_0x1be0d9&&(await _0x3d30c0[_0x5d3c86(0x1de)][_0x5d3c86(0x153)](_0x3abe35,_0x3beace,{'filter_subject':_0x1be0d9}),_0x8e72c0=await _0x18488f['consumers'][_0x5d3c86(0x124)](_0x3abe35,_0x3beace)),_0x45ba8b=await _0x8e72c0['consume']({'max_messages':0x64}),_0x3872ba(_0x45ba8b);},_0x3872ba=async _0x5a9912=>{const _0x43d155=_0x5bb862;for await(const _0x1b59b2 of await _0x5a9912['status']()){switch(_0x1b59b2['type']){case nats['ConsumerEvents']['ConsumerNotFound']:_0x2a0389['logger'][_0x43d155(0x17c)](_0x2a0389['gwName']+'['+_0x2a0389[_0x43d155(0x119)]+_0x43d155(0x15d)+_0x11a74c+']['+_0x1be0d9+']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20'+_0x1b59b2[_0x43d155(0x1c7)]),_0x4b2f38();return;}}};await _0x4b2f38();let _0x2c47f3=-0x1;do{for await(const _0x419c38 of _0x45ba8b){if(!_0x419c38['headers']||!_0x419c38['headers'][_0x5bb862(0x124)](_0x5bb862(0x1c1))){_0x419c38['ack']();continue;}_0x2c47f3=_0x45ba8b['getProcessed']();const _0x18df0a=_0x2a0389[_0x5bb862(0x1e0)]+'['+_0x2a0389['pluginName']+_0x5bb862(0x15d)+_0x11a74c+']['+_0x419c38[_0x5bb862(0x16b)]+']['+_0x2c47f3+']['+(_0x419c38[_0x5bb862(0x17f)]?_0x419c38[_0x5bb862(0x17f)][_0x5bb862(0x124)]('Msg-Id'):'')+']',_0x45ca5c=_0x5d328b[_0x5bb862(0x154)](_0x419c38['data']),_0x9bf5b8=await _0x1dc621(_0x18df0a,_0x45ca5c);if(!_0x9bf5b8||_0x9bf5b8!==!![])_0x419c38[_0x5bb862(0x16c)]();else _0x2a0389[_0x5bb862(0x1c9)][_0x5bb862(0xf0)](_0x18df0a+'\x20subscriber\x20error:\x20scimgateway\x20endpoint\x20connect\x20problem\x20-\x20will\x20do\x20auto\x20retry\x20until\x20connected');if(_0x2c47f3<0x1)break;}}while(_0x2c47f3===0x0);}catch(_0x1935b3){_0x2a0389['logger'][_0x5bb862(0xf0)](_0x2a0389['gwName']+'['+_0x2a0389[_0x5bb862(0x119)]+']\x20subscriber['+_0x11a74c+']['+_0x1be0d9+_0x5bb862(0x13c)+_0x1935b3[_0x5bb862(0x114)]);}},_0x1088a5=async()=>{const _0xbeb5b9=_0x27c58,_0x389570=_0x117e8a['subscribe'](_0x1be0d9,{'max':0x64});for await(const _0x2898a4 of _0x389570){if(!_0x2898a4[_0xbeb5b9(0x17f)]||!_0x2898a4['headers'][_0xbeb5b9(0x124)]('Msg-Id'))continue;let _0x54e832,_0x223702;try{try{_0x54e832=JSON[_0xbeb5b9(0x140)](_0x2898a4['string']());}catch(_0xe14b2d){const _0x3f05fc=_0xbeb5b9(0x10d);_0x2a0389[_0xbeb5b9(0x1c9)][_0xbeb5b9(0xf0)](_0x2a0389[_0xbeb5b9(0x1e0)]+'['+_0x2a0389[_0xbeb5b9(0x119)]+_0xbeb5b9(0x15d)+_0x11a74c+']['+_0x1be0d9+']\x20'+_0x3f05fc+':\x20'+_0x2898a4[_0xbeb5b9(0x181)]());throw new Error(_0x3f05fc);}if(!_0x54e832||!_0x54e832['handle']){const _0x33c4b3=_0xbeb5b9(0x1e9);_0x2a0389[_0xbeb5b9(0x1c9)][_0xbeb5b9(0xf0)](_0x2a0389['gwName']+'['+_0x2a0389['pluginName']+_0xbeb5b9(0x15d)+_0x11a74c+']['+_0x1be0d9+']\x20'+_0x33c4b3+':\x20'+_0x54e832);throw new Error(_0x33c4b3);}!Object[_0xbeb5b9(0x176)]['hasOwnProperty']['call'](_0x54e832,_0xbeb5b9(0x170))&&(_0x54e832[_0xbeb5b9(0x170)]=_0xbeb5b9(0xf6));if(_0x54e832[_0xbeb5b9(0x170)]!==_0x11a74c){const _0xe07104=_0xbeb5b9(0x1bb)+_0x54e832[_0xbeb5b9(0x170)]+'\x20not\x20equal\x20subscriber\x20configured\x20baseEntity='+_0x11a74c;_0x2a0389['logger']['error'](_0x2a0389['gwName']+'['+_0x2a0389[_0xbeb5b9(0x119)]+_0xbeb5b9(0x15d)+_0x11a74c+']['+_0x1be0d9+']\x20'+_0xe07104);throw new Error(_0xe07104);}_0x223702=_0x2a0389['gwName']+'['+_0x2a0389[_0xbeb5b9(0x119)]+']\x20subscriber['+_0x11a74c+']['+_0x2898a4[_0xbeb5b9(0x16b)]+']['+(_0x2898a4['headers']?_0x2898a4[_0xbeb5b9(0x17f)][_0xbeb5b9(0x124)]('Msg-Id'):'')+']',_0x2a0389[_0xbeb5b9(0x1c9)][_0xbeb5b9(0x157)](_0x223702+_0xbeb5b9(0x1c2));const _0x39ea01={};let _0x575a5d,_0x3d8fc8;switch(_0x54e832[_0xbeb5b9(0x13e)]){case _0xbeb5b9(0x1e1):_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832['obj'],_0x54e832['attributes'],_0x54e832[_0xbeb5b9(0x1a2)]);break;case'getGroups':_0x575a5d=await _0x2a0389[_0x54e832['handle']](_0x11a74c,_0x54e832[_0xbeb5b9(0x13f)],_0x54e832['attributes'],_0x54e832[_0xbeb5b9(0x1a2)]);break;case'createUser':_0x575a5d=await _0x2a0389[_0x54e832['handle']](_0x11a74c,_0x54e832['obj'],_0x54e832[_0xbeb5b9(0x1a2)]);break;case'createGroup':_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832[_0xbeb5b9(0x13f)],_0x54e832[_0xbeb5b9(0x1a2)]);break;case _0xbeb5b9(0x1e4):_0x575a5d=await _0x2a0389[_0x54e832['handle']](_0x11a74c,_0x54e832['id'],_0x54e832['ctxPassThrough']);break;case _0xbeb5b9(0x1c8):_0x575a5d=await _0x2a0389[_0x54e832['handle']](_0x11a74c,_0x54e832['id'],_0x54e832['ctxPassThrough']);break;case'modifyUser':_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832['id'],_0x54e832[_0xbeb5b9(0x13f)],_0x54e832['ctxPassThrough']);break;case _0xbeb5b9(0x1ee):_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832['id'],_0x54e832['obj'],_0x54e832['ctxPassThrough']);break;case _0xbeb5b9(0x135):_0x39ea01['set']=()=>{},_0x39ea01['params']={},_0x39ea01[_0xbeb5b9(0x1d7)][_0xbeb5b9(0x170)]=_0x11a74c,_0x39ea01[_0xbeb5b9(0x1d7)]['id']=_0x54e832['id'],_0x39ea01[_0xbeb5b9(0x12c)]={},_0x39ea01[_0xbeb5b9(0x12c)][_0xbeb5b9(0x141)]=_0x54e832[_0xbeb5b9(0x141)],_0x39ea01[_0xbeb5b9(0x12c)]['body']=_0x54e832[_0xbeb5b9(0x13f)],_0x39ea01[_0xbeb5b9(0x182)]=_0x54e832['ctxPassThrough'],_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x39ea01);break;case'postApi':_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832[_0xbeb5b9(0x13f)],_0x54e832[_0xbeb5b9(0x1a2)]);break;case _0xbeb5b9(0x12e):_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832['id'],_0x54e832[_0xbeb5b9(0x13f)],_0x54e832[_0xbeb5b9(0x1a2)]);break;case _0xbeb5b9(0x15b):_0x575a5d=await _0x2a0389[_0x54e832[_0xbeb5b9(0x13e)]](_0x11a74c,_0x54e832['id'],_0x54e832[_0xbeb5b9(0x13f)],_0x54e832[_0xbeb5b9(0x1a2)]);break;case'getApi':_0x575a5d=await _0x2a0389[_0x54e832['handle']](_0x11a74c,_0x54e832['id'],_0x54e832[_0xbeb5b9(0x1aa)],_0x54e832['obj'],_0x54e832['ctxPassThrough']);break;case _0xbeb5b9(0x1d8):_0x575a5d=await _0x2a0389[_0x54e832['handle']](_0x11a74c,_0x54e832['id'],_0x54e832[_0xbeb5b9(0x1a2)]);break;default:_0x3d8fc8=_0xbeb5b9(0x162)+_0x54e832[_0xbeb5b9(0x13e)]+'\x27\x20not\x20supported',_0x2a0389[_0xbeb5b9(0x1c9)]['error'](_0x2a0389['gwName']+'['+_0x2a0389[_0xbeb5b9(0x119)]+']\x20subscriber['+_0x11a74c+']['+_0x1be0d9+']\x20'+_0x3d8fc8);throw new Error(_0x3d8fc8);}if(!_0x575a5d)_0x575a5d=null;const _0x4501dc=JSON[_0xbeb5b9(0x1df)](_0x575a5d);_0x2898a4[_0xbeb5b9(0x139)](_0x4501dc),_0x2a0389[_0xbeb5b9(0x1c9)][_0xbeb5b9(0x17c)](_0x223702+_0xbeb5b9(0x142)+_0x54e832[_0xbeb5b9(0x13e)]+_0xbeb5b9(0x121)+(_0x54e832[_0xbeb5b9(0x13f)]?JSON[_0xbeb5b9(0x1df)](_0x54e832[_0xbeb5b9(0x13f)]):'')+',\x20id='+(_0x54e832['id']?_0x54e832['id']:'')+_0xbeb5b9(0x15c)+(_0x54e832[_0xbeb5b9(0x18f)]?_0x54e832[_0xbeb5b9(0x18f)]:'')+'\x20message\x20response:\x20'+_0x4501dc+_0x77a231);}catch(_0x2d5654){const _0x238813=_0xbeb5b9(0x1b8)+_0x2d5654[_0xbeb5b9(0x114)]+_0xbeb5b9(0x146)+_0x2d5654[_0xbeb5b9(0x179)]+'\x22}';_0x2898a4[_0xbeb5b9(0x139)](_0x238813),_0x2a0389[_0xbeb5b9(0x1c9)][_0xbeb5b9(0x17c)]((_0x223702||'')+_0xbeb5b9(0x142)+_0x54e832['handle']+_0xbeb5b9(0x121)+(_0x54e832['obj']?JSON[_0xbeb5b9(0x1df)](_0x54e832[_0xbeb5b9(0x13f)]):'')+',\x20id='+(_0x54e832['id']?_0x54e832['id']:'')+',\x20attributes='+(_0x54e832['attributes']?_0x54e832[_0xbeb5b9(0x18f)]:'')+_0xbeb5b9(0x19a)+_0x238813+_0x77a231);}}};if(_0x10406a)_0x1088a5();else _0x238d0d();},_0x3b536e=async(_0x2c8080,_0x2bf2f2)=>{const _0x1ecb69=_0x375032,_0x49ccc0=_0x2f6dd3[_0x2c8080][_0x1ecb69(0x19b)]?.['nats']?.[_0x1ecb69(0x16b)];let _0xb2b9f0=0x0;for await(const _0x3ca72a of _0x2bf2f2[_0x1ecb69(0x110)]()){switch(_0x3ca72a[_0x1ecb69(0x1c7)]){case nats[_0x1ecb69(0x1c6)][_0x1ecb69(0x131)]:_0x2a0389[_0x1ecb69(0x1c9)][_0x1ecb69(0xf0)](_0x2a0389[_0x1ecb69(0x1e0)]+'['+_0x2a0389[_0x1ecb69(0x119)]+_0x1ecb69(0x15d)+_0x2c8080+']['+_0x49ccc0+']\x20client\x20disconnected\x20'+_0x3ca72a[_0x1ecb69(0x199)]+_0x1ecb69(0x12b)),_0xb2b9f0=0x0;break;case nats[_0x1ecb69(0x1c6)][_0x1ecb69(0x18e)]:_0x2a0389['logger']['info'](_0x2a0389[_0x1ecb69(0x1e0)]+'['+_0x2a0389[_0x1ecb69(0x119)]+']\x20subscriber['+_0x2c8080+']['+_0x49ccc0+_0x1ecb69(0x1d3)+_0x3ca72a[_0x1ecb69(0x199)]);break;case nats[_0x1ecb69(0x1c6)][_0x1ecb69(0x18b)]:_0x2a0389[_0x1ecb69(0x1c9)]['error'](_0x2a0389['gwName']+'['+_0x2a0389['pluginName']+']\x20subscriber['+_0x2c8080+']['+_0x49ccc0+_0x1ecb69(0x106)+_0x3ca72a[_0x1ecb69(0x199)]);break;case nats[_0x1ecb69(0x19d)]['Reconnecting']:_0xb2b9f0+=0x1;_0xb2b9f0%0x1e===0x0&&_0x2a0389[_0x1ecb69(0x1c9)][_0x1ecb69(0x157)](_0x2a0389['gwName']+'['+_0x2a0389[_0x1ecb69(0x119)]+_0x1ecb69(0x15d)+_0x2c8080+']['+_0x49ccc0+_0x1ecb69(0x1cf)+_0x3ca72a[_0x1ecb69(0x199)]+_0x1ecb69(0xfb)+_0xb2b9f0+')');break;case nats[_0x1ecb69(0x19d)]['StaleConnection']:_0x2a0389[_0x1ecb69(0x1c9)][_0x1ecb69(0x157)](_0x2a0389[_0x1ecb69(0x1e0)]+'['+_0x2a0389['pluginName']+_0x1ecb69(0x15d)+_0x2c8080+']['+_0x49ccc0+_0x1ecb69(0x180)+_0x3ca72a['data']);break;}}};process['on'](_0x375032(0x166),async()=>{const _0x45c287=_0x375032;for(const _0x510083 in _0x2f6dd3){_0x2f6dd3[_0x510083]['nc']&&!_0x2f6dd3[_0x510083]['nc'][_0x45c287(0x127)]()&&await _0x2f6dd3[_0x510083]['nc'][_0x45c287(0x1cd)]();}}),process['on'](_0x375032(0x1e8),async()=>{const _0x4cb3e5=_0x375032;for(const _0x168095 in _0x2f6dd3){_0x2f6dd3[_0x168095]['nc']&&!_0x2f6dd3[_0x168095]['nc'][_0x4cb3e5(0x127)]()&&await _0x2f6dd3[_0x168095]['nc']['drain']();}});const _0x5d75a1=async(_0x52a935,_0x58d465,_0xdc639)=>{const _0x39cb61=_0x375032,_0x1a764e={'attribute':_0x58d465,'operator':'eq','value':_0xdc639,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0x23e78d=[_0x58d465];if(_0x58d465!=='id')_0x23e78d[_0x39cb61(0x174)]('id');try{const _0x377504=await _0x2a0389['getUsers'](_0x52a935,_0x1a764e,_0x23e78d);if(!_0x377504||!_0x377504[_0x39cb61(0x16e)]||!Array['isArray'](_0x377504[_0x39cb61(0x16e)]))throw new Error(_0x39cb61(0x1c0)+JSON[_0x39cb61(0x1df)](_0x1a764e)+_0x39cb61(0x10b));if(_0x377504[_0x39cb61(0x16e)][_0x39cb61(0x1b1)]===0x0)return null;else{if(_0x377504['Resources'][_0x39cb61(0x1b1)]>0x2)throw new Error(_0x39cb61(0x1c0)+JSON['stringify'](_0x1a764e)+'\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}');else{const _0x56cea8=_0x377504[_0x39cb61(0x16e)][0x0];if(!_0x56cea8['id'])throw new Error(_0x39cb61(0x1c0)+JSON[_0x39cb61(0x1df)](_0x1a764e)+_0x39cb61(0x1a1)+JSON['stringify'](_0x56cea8)+_0x39cb61(0x12f));return decodeURIComponent(_0x56cea8['id']);}}}catch(_0x151547){throw new Error(_0x39cb61(0x1c0)+JSON['stringify'](_0x1a764e)+'\x20error:\x20'+_0x151547['message']+'}');}},_0x4dabde=_0x32239b=>{const _0x57f209=_0x375032;if(!_0x32239b||typeof _0x32239b!==_0x57f209(0x181))return[null,null];_0x32239b=_0x32239b[_0x57f209(0x196)]();const _0x326c8b=_0x32239b[_0x57f209(0x13b)]('(');if(_0x326c8b<0x1)return[null,null];if(_0x32239b[_0x57f209(0x191)](_0x32239b['length']-0x1)!==')')return[null,null];if(_0x269f6a(_0x32239b,'(')!==_0x269f6a(_0x32239b,')'))return[null,null];const _0x2d0ec9=_0x32239b[_0x57f209(0x191)](0x0,_0x326c8b),_0x528058=_0x32239b[_0x57f209(0x191)](_0x326c8b+0x1,_0x32239b[_0x57f209(0x1b1)]-0x1);let _0x5835d1=[];const _0x161e8f=_0x528058[_0x57f209(0x160)](',');let _0xdf0d13='';for(let _0x1a43ea=0x0;_0x1a43ea<_0x161e8f[_0x57f209(0x1b1)];_0x1a43ea++){const _0x1ae12f=_0xdf0d13?_0xdf0d13+','+_0x161e8f[_0x1a43ea]:_0x161e8f[_0x1a43ea],_0x2684e3=_0x269f6a(_0x1ae12f,'('),_0x295cb3=_0x269f6a(_0x1ae12f,')');if(_0x2684e3===_0x295cb3)_0x5835d1[_0x57f209(0x174)](_0x600a8d(_0x1ae12f,'\x22')),_0xdf0d13='';else{if(_0xdf0d13)_0xdf0d13+=','+_0x161e8f[_0x1a43ea];else _0xdf0d13+=_0x161e8f[_0x1a43ea];}}if(_0x5835d1[_0x57f209(0x1b1)]===0x0)_0x5835d1=null;return[_0x2d0ec9,_0x5835d1];};function _0x269f6a(_0x1d2c1c,_0x3502d8){const _0x5c6628=_0x375032;let _0x5b067a=0x0;for(let _0xb40f3e=0x0;_0xb40f3e<_0x1d2c1c[_0x5c6628(0x1b1)];_0xb40f3e++){_0x1d2c1c[_0x5c6628(0x1a5)](_0xb40f3e)===_0x3502d8&&(_0x5b067a+=0x1);}return _0x5b067a;}const _0x600a8d=(_0x1b5b0d,_0x54172b)=>{const _0x1ff84b=_0x375032;if(typeof _0x1b5b0d!==_0x1ff84b(0x181)||typeof _0x54172b!=='string')return _0x1b5b0d;if(_0x1b5b0d[_0x1ff84b(0x1b1)]===0x1)return _0x1b5b0d;if(_0x54172b[_0x1ff84b(0x1b1)]!==0x1)return _0x1b5b0d;return _0x1b5b0d=_0x1b5b0d[_0x1ff84b(0x196)](),_0x1b5b0d[_0x1ff84b(0x191)](0x0,0x1)===_0x54172b&&(_0x1b5b0d=_0x1b5b0d[_0x1ff84b(0x191)](0x1)),_0x1b5b0d[_0x1ff84b(0x191)](_0x1b5b0d[_0x1ff84b(0x1b1)]-0x1)===_0x54172b&&(_0x1b5b0d=_0x1b5b0d[_0x1ff84b(0x191)](0x0,_0x1b5b0d['length']-0x1)),_0x1b5b0d;},_0x30171c=async(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x5d85a0)=>{const _0x14d576=_0x375032;if(!_0x3bdae3||!_0x1df37d||!_0x5d85a0)return null;const [_0x29d324,_0x428675]=_0x4dabde(_0x5d85a0);if(!_0x29d324||!_0x428675){const _0x4c5a14=_0x5d85a0[_0x14d576(0x160)]('(');if(_0x4c5a14[_0x14d576(0x1b1)]>0x1){const _0x2505fd=[_0x14d576(0x14c),_0x14d576(0x1a0),_0x14d576(0x109),'elementnumber',_0x14d576(0x102),'replace','normalize','increment',_0x14d576(0xfd)],_0x5aed12=_0x4c5a14[0x0]['toLowerCase']();if(_0x2505fd[_0x14d576(0x12a)](_0x5aed12))return null;}return _0x5d85a0;}for(let _0x490e98=0x0;_0x490e98<_0x428675['length'];_0x490e98++){if(_0x428675[_0x490e98][_0x14d576(0x191)](0x0,0x1)==='['){const _0x26f0f7=_0x428675[_0x490e98][_0x14d576(0x13b)](']');if(_0x26f0f7<0x0)return null;const _0x35f4a9=_0x428675[_0x490e98][_0x14d576(0x191)](0x1,_0x26f0f7),_0x40e65b=_0x35f4a9[_0x14d576(0x160)]('.');let _0x483e03;for(let _0x2e33ad=0x0;_0x2e33ad<_0x40e65b[_0x14d576(0x1b1)];_0x2e33ad++){if(_0x2e33ad===0x0)_0x483e03=_0x3bdae3[_0x40e65b[_0x2e33ad]];else{if(!_0x483e03)return null;_0x483e03=_0x483e03[_0x40e65b[_0x2e33ad]];}}if(!_0x483e03)return null;_0x428675[_0x490e98]=_0x483e03;}}for(let _0x37d500=0x0;_0x37d500<_0x428675[_0x14d576(0x1b1)];_0x37d500++){const [_0xd5aaaf]=_0x4dabde(_0x428675[_0x37d500]);_0xd5aaaf&&(_0x428675[_0x37d500]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x428675[_0x37d500]));}if(_0x428675[0x0]===null)return null;switch(_0x29d324[_0x14d576(0xfe)]()){case _0x14d576(0x14c):{if(_0x428675[_0x14d576(0x1b1)]!==0x1)return null;const [_0x5e0898]=_0x4dabde(_0x428675[0x0]);if(_0x5e0898)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x5e0898);if(_0x428675[0x0]===null)return null;return _0x428675[0x0]['toLowerCase']();}case _0x14d576(0x1a0):{if(_0x428675['length']!==0x1)return null;const [_0x5f5ba8]=_0x4dabde(_0x428675[0x0]);if(_0x5f5ba8)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x5f5ba8);if(_0x428675[0x0]===null)return null;return _0x428675[0x0][_0x14d576(0x14e)]();}case _0x14d576(0x109):{if(_0x428675[_0x14d576(0x1b1)]!==0x2)return null;const [_0x12fcc4]=_0x4dabde(_0x428675[0x0]);if(_0x12fcc4)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x12fcc4);if(_0x428675[0x0]===null)return null;if(isNaN(_0x428675[0x1]))return null;return _0x428675[0x0][_0x14d576(0x191)](0x0,_0x428675[0x1]);}case _0x14d576(0x19c):{const [_0x198910]=_0x4dabde(_0x428675[0x0]);if(_0x428675[_0x14d576(0x1b1)]<0x2)return null;if(_0x198910)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x198910);if(_0x428675[0x0]===null)return null;const _0x2e646a=_0x428675[0x1];if(isNaN(_0x2e646a))return null;let _0x29451a;if(_0x428675[_0x14d576(0x1b1)]===0x3)_0x29451a=_0x428675[0x0][_0x14d576(0x160)](_0x428675[0x2]);else _0x29451a=_0x29451a=_0x428675[0x0][_0x14d576(0x160)]('\x20');if(_0x2e646a<=_0x29451a[_0x14d576(0x1b1)])return _0x29451a[_0x2e646a-0x1];else return'';}case _0x14d576(0x152):{const [_0x1afa7f]=_0x4dabde(_0x428675[0x0]);if(_0x1afa7f)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x1afa7f);if(_0x428675[0x0]===null)return null;if(_0x428675[_0x14d576(0x1b1)]!==0x3)return null;return _0x428675[0x0]['replaceAll'](_0x428675[0x1],_0x428675[0x2]);}case _0x14d576(0x156):{if(_0x428675[_0x14d576(0x1b1)]!==0x1)return null;const [_0x45dfc6]=_0x4dabde(_0x428675[0x0]);if(_0x45dfc6)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x45dfc6);if(_0x428675[0x0]===null)return null;return ascii127[_0x14d576(0x115)](_0x428675[0x0]);}case'join':{let _0x1db14e='';for(let _0x3b9f96=0x0;_0x3b9f96<_0x428675[_0x14d576(0x1b1)];_0x3b9f96++){const [_0x3d4da9]=_0x4dabde(_0x428675[_0x3b9f96]);if(_0x3d4da9)_0x428675[_0x3b9f96]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x3d4da9);if(_0x428675[_0x3b9f96]===null)return null;_0x1db14e+=_0x428675[_0x3b9f96];}return _0x1db14e;}case _0x14d576(0x15f):{if(_0x428675[_0x14d576(0x1b1)]>0x2)return null;const [_0x24ffc9]=_0x4dabde(_0x428675[0x0]);if(_0x24ffc9)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x24ffc9);if(_0x428675[0x0]===null)return null;const _0x55300e=parseInt(_0x428675[0x0]);if(isNaN(_0x55300e))return null;let _0x3217a1=_0x14d576(0x129);_0x3217a1+=','+_0x428675[0x0];if(_0x428675[_0x14d576(0x1b1)]===0x2&&_0x428675[0x1][_0x14d576(0xfe)]()===_0x14d576(0xf1))_0x3217a1+=_0x14d576(0x1c4);else _0x3217a1+=_0x14d576(0x11a);return _0x3217a1+='##',_0x3217a1;}case _0x14d576(0xfd):{if(_0x428675[_0x14d576(0x1b1)]!==0x1)return null;const [_0x3efe71]=_0x4dabde(_0x428675[0x0]);if(_0x3efe71)_0x428675[0x0]=await _0x30171c(_0x1b26cd,_0x3bdae3,_0x1df37d,_0x3efe71);if(_0x428675[0x0]===null)return null;let _0x509aff,_0x262783=![],_0x9758c5='';const _0x5f19e7=_0x428675[0x0][_0x14d576(0x160)]('##');if(_0x5f19e7['length']>0x2)for(let _0x587a45=0x0;_0x587a45<_0x5f19e7[_0x14d576(0x1b1)];_0x587a45++){if(_0x5f19e7[_0x587a45]['startsWith'](_0x14d576(0x126))){const _0x4e3396=_0x5f19e7[_0x587a45][_0x14d576(0x160)](',');if(_0x4e3396['length']<0x2)return null;const _0x48f540=parseInt(_0x4e3396[0x1]);if(isNaN(_0x48f540))return null;_0x9758c5='##'+_0x5f19e7[_0x587a45]+'##',_0x509aff=_0x4e3396[0x1],_0x4e3396[_0x14d576(0x1b1)]>0x2&&(_0x262783=_0x4e3396[0x2][_0x14d576(0xfe)]()===_0x14d576(0xf1));}}let _0x2294ad,_0x2c9f9c=0x0,_0x53c40c=0x0;if(_0x509aff){_0x53c40c=_0x509aff['length'],_0x2c9f9c=0xa;for(let _0x141328=0x1;_0x141328<_0x53c40c;_0x141328++){_0x2c9f9c*=0xa;}_0x2c9f9c-=0x1,_0x2294ad=parseInt(_0x509aff);if(isNaN(_0x2294ad))return null;_0x2294ad-=0x1;}else _0x2294ad=0x0;do{_0x2294ad+=0x1;let _0x4a5680=_0x428675[0x0];if(_0x509aff!==undefined&&_0x9758c5){let _0x432eb6=_0x2294ad[_0x14d576(0x1a3)]();while(_0x432eb6[_0x14d576(0x1b1)]<_0x53c40c){_0x432eb6='0'+_0x432eb6;}_0x262783?_0x4a5680=_0x4a5680['replace'](_0x9758c5,_0x432eb6):(_0x4a5680=_0x4a5680[_0x14d576(0x152)](_0x9758c5,''),_0x262783=!![],_0x2294ad-=0x1);}try{const _0x10eb36=await _0x5d75a1(_0x1b26cd,_0x1df37d,_0x4a5680);if(!_0x10eb36)return _0x4a5680;}catch(_0x5574af){return _0x2a0389[_0x14d576(0x1c9)]['error'](_0x2a0389[_0x14d576(0x1e0)]+'['+_0x2a0389['pluginName']+']\x20'+_0x29d324+'\x20getUserId()\x20error:\x20'+_0x5574af[_0x14d576(0x114)]),null;}}while(_0x2294ad<_0x2c9f9c);return null;}default:}return null;},_0x162af5=async(_0x42dc52,_0xd159aa)=>{const _0x98a951=_0x375032;for(const _0x56ec40 in _0xd159aa){const _0xc23263=_0xd159aa[_0x56ec40],[_0x5776a9,_0xe1bd17]=_0x4dabde(_0xc23263);if(_0x5776a9){const _0x3c2d7f=''+_0x56ec40,_0x4554a5=_0x5776a9+'('+_0xe1bd17[_0x98a951(0x102)](',')+')',_0x301f47=await _0x30171c(_0x42dc52,_0xd159aa,_0x3c2d7f,_0x4554a5);if(_0x301f47===null)delete _0xd159aa[_0x56ec40];else _0xd159aa[_0x56ec40]=_0x301f47;}for(const _0x17ff7b in _0xc23263){const _0x167f21=_0xc23263[_0x17ff7b],[_0x2c4204,_0x7b092b]=_0x4dabde(_0x167f21);if(_0x2c4204){const _0x197fc5=_0x56ec40+'.'+_0x17ff7b,_0x51bdab=_0x2c4204+'('+_0x7b092b[_0x98a951(0x102)](',')+')',_0x29d4fe=await _0x30171c(_0x42dc52,_0xd159aa,_0x197fc5,_0x51bdab);if(_0x29d4fe===null)delete _0xc23263[_0x17ff7b];else _0xc23263[_0x17ff7b]=_0x29d4fe;}}}return _0xd159aa;};},module[a0_0x2ad4e4(0x19f)][a0_0x2ad4e4(0x118)]=function(_0x54f2df){const _0x4afee8=a0_0x2ad4e4,_0x5d21ca=_0x54f2df,_0x1acfcf={},_0x507a6c=async(_0x411170,_0x19d774)=>{const _0x520475=a0_0x7bcd,_0x448588=_0x1acfcf[_0x411170][_0x520475(0x19b)]?.['nats']?.['subject'];let _0x3b10f3=0x0;for await(const _0x707d44 of _0x19d774[_0x520475(0x110)]()){switch(_0x707d44[_0x520475(0x1c7)]){case nats[_0x520475(0x1c6)]['Disconnect']:_0x5d21ca['logger'][_0x520475(0xf0)](_0x5d21ca[_0x520475(0x1e0)]+'['+_0x5d21ca[_0x520475(0x119)]+_0x520475(0x1b3)+_0x411170+']['+_0x448588+_0x520475(0x192)+_0x707d44[_0x520475(0x199)]+_0x520475(0x12b)),_0x3b10f3=0x0;break;case nats[_0x520475(0x1c6)][_0x520475(0x18e)]:_0x5d21ca[_0x520475(0x1c9)][_0x520475(0x17c)](_0x5d21ca[_0x520475(0x1e0)]+'['+_0x5d21ca[_0x520475(0x119)]+_0x520475(0x1b3)+_0x411170+']['+_0x448588+_0x520475(0x1d3)+_0x707d44[_0x520475(0x199)]);break;case nats['Events'][_0x520475(0x18b)]:_0x5d21ca['logger'][_0x520475(0xf0)](_0x5d21ca['gwName']+'['+_0x5d21ca[_0x520475(0x119)]+_0x520475(0x1b3)+_0x411170+']['+_0x448588+_0x520475(0x106)+_0x707d44[_0x520475(0x199)]);break;case nats[_0x520475(0x19d)][_0x520475(0x1dc)]:_0x3b10f3+=0x1;_0x3b10f3%0x1e===0x0&&_0x5d21ca[_0x520475(0x1c9)]['debug'](_0x5d21ca[_0x520475(0x1e0)]+'['+_0x5d21ca[_0x520475(0x119)]+']\x20publisher['+_0x411170+']['+_0x448588+_0x520475(0x1cf)+_0x707d44[_0x520475(0x199)]+'\x20(count='+_0x3b10f3+')');break;case nats[_0x520475(0x19d)][_0x520475(0x1b0)]:_0x5d21ca['logger'][_0x520475(0x157)](_0x5d21ca[_0x520475(0x1e0)]+'['+_0x5d21ca[_0x520475(0x119)]+_0x520475(0x1b3)+_0x411170+']['+_0x448588+_0x520475(0x180)+_0x707d44[_0x520475(0x199)]);break;}}},_0x51ce0b=async(_0x4ceae3,_0x3b61bb)=>{const _0x4e5d58=a0_0x7bcd,_0x1296d6=_0x1acfcf[_0x4ceae3]['config']?.[_0x4e5d58(0x1c5)]?.[_0x4e5d58(0x16b)];let _0x388b41;try{_0x388b41=await nats['connect'](_0x3b61bb);if(_0x388b41[_0x4e5d58(0x17c)][_0x4e5d58(0x1ea)]!==_0x4e5d58(0x158)){_0x388b41[_0x4e5d58(0x1bc)]();return;}_0x1acfcf[_0x4ceae3]['nc']=_0x388b41,_0x507a6c(_0x4ceae3,_0x388b41);}catch(_0x1ffcf2){_0x5d21ca[_0x4e5d58(0x1c9)][_0x4e5d58(0xf0)](_0x5d21ca['gwName']+'['+_0x5d21ca[_0x4e5d58(0x119)]+_0x4e5d58(0x1b3)+_0x4ceae3+']['+_0x1296d6+']\x20connect\x20error:\x20'+_0x1ffcf2[_0x4e5d58(0x114)]+'\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration'),_0x3b61bb[_0x4e5d58(0x1d2)]=!![];try{_0x388b41=await nats[_0x4e5d58(0x175)](_0x3b61bb);if(_0x388b41[_0x4e5d58(0x17c)][_0x4e5d58(0x1ea)]!==_0x4e5d58(0x158)){_0x388b41[_0x4e5d58(0x1bc)]();return;}_0x1acfcf[_0x4ceae3]['nc']=_0x388b41,_0x507a6c(_0x4ceae3,_0x388b41);}catch(_0x35580e){_0x5d21ca[_0x4e5d58(0x1c9)]['error'](_0x5d21ca[_0x4e5d58(0x1e0)]+'['+_0x5d21ca['pluginName']+_0x4e5d58(0x1b3)+_0x4ceae3+']['+_0x1296d6+_0x4e5d58(0x1ca)+_0x35580e[_0x4e5d58(0x114)]);return;}}_0x5d21ca['logger']['debug'](_0x5d21ca[_0x4e5d58(0x1e0)]+'['+_0x5d21ca[_0x4e5d58(0x119)]+_0x4e5d58(0x1b3)+_0x4ceae3+']['+_0x1296d6+_0x4e5d58(0x17a)+(_0x3b61bb[_0x4e5d58(0x16f)]['ca']?_0x4e5d58(0x16f):'')+'\x20'+_0x388b41[_0x4e5d58(0x136)]()),_0x388b41[_0x4e5d58(0xf7)]()[_0x4e5d58(0x10a)](_0x52ec0c=>{const _0x3a6d44=_0x4e5d58;_0x52ec0c&&_0x5d21ca[_0x3a6d44(0x1c9)][_0x3a6d44(0xf0)](_0x5d21ca[_0x3a6d44(0x1e0)]+'['+_0x5d21ca[_0x3a6d44(0x119)]+_0x3a6d44(0x1b3)+_0x4ceae3+']['+_0x1296d6+_0x3a6d44(0x177)+_0x52ec0c[_0x3a6d44(0x114)]);});};this[_0x4afee8(0x1b2)]=async(_0x4b0578,_0x38de1c)=>{const _0x3a3b1b=_0x4afee8;if(!_0x38de1c?.[_0x3a3b1b(0x1c5)]){_0x5d21ca['logger'][_0x3a3b1b(0xf0)](_0x5d21ca['gwName']+'['+_0x5d21ca['pluginName']+_0x3a3b1b(0x1b3)+_0x4b0578+_0x3a3b1b(0x1b7));return;}if(!_0x38de1c?.[_0x3a3b1b(0x1c5)]?.['tenant']){_0x5d21ca[_0x3a3b1b(0x1c9)][_0x3a3b1b(0xf0)](_0x5d21ca[_0x3a3b1b(0x1e0)]+'['+_0x5d21ca['pluginName']+_0x3a3b1b(0x1b3)+_0x4b0578+_0x3a3b1b(0x198));return;}if(!_0x38de1c?.[_0x3a3b1b(0x1c5)]?.[_0x3a3b1b(0x16b)]){_0x5d21ca['logger'][_0x3a3b1b(0xf0)](_0x5d21ca[_0x3a3b1b(0x1e0)]+'['+_0x5d21ca[_0x3a3b1b(0x119)]+_0x3a3b1b(0x1b3)+_0x4b0578+_0x3a3b1b(0x14b));return;}if(!_0x38de1c?.[_0x3a3b1b(0x1c5)]?.[_0x3a3b1b(0x16b)][_0x3a3b1b(0x104)](_0x3a3b1b(0x1ba))){_0x5d21ca['logger'][_0x3a3b1b(0xf0)](_0x5d21ca[_0x3a3b1b(0x1e0)]+'['+_0x5d21ca['pluginName']+']\x20publisher['+_0x4b0578+_0x3a3b1b(0x161));return;}if(!_0x38de1c[_0x3a3b1b(0x145)]||!Array[_0x3a3b1b(0x11e)](_0x38de1c[_0x3a3b1b(0x145)])||_0x38de1c[_0x3a3b1b(0x145)]['length']<0x1){_0x5d21ca['logger'][_0x3a3b1b(0xf0)](_0x5d21ca[_0x3a3b1b(0x1e0)]+'['+_0x5d21ca[_0x3a3b1b(0x119)]+_0x3a3b1b(0x1b3)+_0x4b0578+']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls');return;}if(!_0x38de1c?.[_0x3a3b1b(0x103)]?.['ca']){_0x5d21ca[_0x3a3b1b(0x1c9)][_0x3a3b1b(0xf0)](_0x5d21ca[_0x3a3b1b(0x1e0)]+'['+_0x5d21ca[_0x3a3b1b(0x119)]+_0x3a3b1b(0x1b3)+_0x4b0578+_0x3a3b1b(0x17e));return;}const _0x23090b={};try{let _0x240103=path[_0x3a3b1b(0x102)](_0x5d21ca[_0x3a3b1b(0x167)],'/certs/',_0x38de1c?.[_0x3a3b1b(0x103)]?.['ca']||_0x3a3b1b(0x186));(_0x38de1c?.[_0x3a3b1b(0x103)]?.['ca']?.[_0x3a3b1b(0x104)]('/')||_0x38de1c?.[_0x3a3b1b(0x103)]?.['ca']?.['includes']('\x5c'))&&(_0x240103=_0x38de1c[_0x3a3b1b(0x103)]['ca']),_0x23090b['ca']=[fs[_0x3a3b1b(0x1cc)](_0x240103)],_0x23090b[_0x3a3b1b(0x132)]=!![];}catch(_0x124e7d){_0x5d21ca[_0x3a3b1b(0x1c9)][_0x3a3b1b(0xf0)](_0x5d21ca[_0x3a3b1b(0x1e0)]+'['+_0x5d21ca[_0x3a3b1b(0x119)]+']\x20publisher['+_0x4b0578+']\x20initialization\x20certificate\x20error:\x20'+_0x124e7d['message']);return;}const _0x102851={},_0x43fe3e=new TextEncoder()[_0x3a3b1b(0x195)](_0x38de1c?.[_0x3a3b1b(0x1c5)]?.[_0x3a3b1b(0x15e)]),_0x5cb17f=_0x38de1c?.[_0x3a3b1b(0x1c5)]?.[_0x3a3b1b(0x187)];_0x102851[_0x3a3b1b(0x1e6)]=nats[_0x3a3b1b(0x164)](_0x5cb17f,_0x43fe3e),_0x102851[_0x3a3b1b(0x165)]=_0x38de1c[_0x3a3b1b(0x145)],_0x102851[_0x3a3b1b(0x16f)]=_0x23090b,_0x102851['waitOnFirstConnect']=![],_0x102851[_0x3a3b1b(0x101)]=!![],_0x102851[_0x3a3b1b(0x16d)]=0x3e8*0xa,_0x102851['maxReconnectAttempts']=-0x1,_0x102851[_0x3a3b1b(0x190)]=0x2*0x3c*0x3e8,_0x102851[_0x3a3b1b(0x1e7)]=0x5,_0x102851[_0x3a3b1b(0x157)]=![],_0x1acfcf[_0x4b0578]={},_0x1acfcf[_0x4b0578]['config']=_0x38de1c,_0x1acfcf[_0x4b0578]['nc']=undefined,_0x51ce0b(_0x4b0578,_0x102851);};const _0x3108af=nats[_0x4afee8(0x111)]();this['publish']=async _0x2cb6d8=>{const _0x5c590f=_0x4afee8;let _0x2b20ee;try{if(_0x2cb6d8[_0x5c590f(0x105)]===Object){_0x2b20ee=_0x2cb6d8[_0x5c590f(0x170)];if(!_0x2b20ee)_0x2cb6d8[_0x5c590f(0x170)]=_0x5c590f(0xf6);_0x2cb6d8=JSON[_0x5c590f(0x1df)](_0x2cb6d8);}else{const _0xb20f33=JSON[_0x5c590f(0x140)](_0x2cb6d8);_0x2b20ee=_0xb20f33[_0x5c590f(0x170)];}}catch(_0x336262){throw new Error(_0x5c590f(0x151)+_0x2b20ee+_0x5c590f(0x193));}if(!_0x1acfcf[_0x2b20ee])throw new Error(_0x5c590f(0x151)+_0x2b20ee+']\x20error:\x20missing\x20entity\x20configuration\x20for\x20baseEntity='+_0x2b20ee);const _0x198eb1=nats['headers']();_0x198eb1['append'](_0x5c590f(0x1c1),crypto['randomUUID']());let _0x59c1a2;try{if(!_0x1acfcf[_0x2b20ee]['nc'])throw new Error('publisher\x20not\x20initialized/connected');_0x59c1a2=await _0x1acfcf[_0x2b20ee]['nc'][_0x5c590f(0x12c)](_0x1acfcf[_0x2b20ee][_0x5c590f(0x19b)]?.[_0x5c590f(0x1c5)]?.[_0x5c590f(0x16b)],_0x3108af[_0x5c590f(0x195)](_0x2cb6d8),{'headers':_0x198eb1});}catch(_0x55ba46){if(_0x55ba46[_0x5c590f(0x114)]===_0x5c590f(0x1a6))throw new Error(_0x5c590f(0x151)+_0x2b20ee+']\x20error:\x20no\x20subscribers/responders\x20to\x20subject\x20'+_0x1acfcf[_0x2b20ee]['config']?.[_0x5c590f(0x1c5)]?.[_0x5c590f(0x16b)]);else throw new Error(_0x5c590f(0x151)+_0x2b20ee+_0x5c590f(0x1f2)+_0x55ba46[_0x5c590f(0x114)]);}let _0x13d9ea;try{_0x13d9ea=JSON[_0x5c590f(0x140)](_0x59c1a2[_0x5c590f(0x181)]());}catch(_0x23b965){throw new Error(_0x5c590f(0x1a9)+_0x59c1a2[_0x5c590f(0x181)]());}if(_0x13d9ea?.[_0x5c590f(0xf0)]){const _0x36bdb4=new Error('publisher\x20response\x20error:\x20'+_0x13d9ea[_0x5c590f(0xf0)]);_0x36bdb4[_0x5c590f(0x179)]=_0x13d9ea['errName'];throw _0x36bdb4;}return _0x13d9ea;},process['on'](_0x4afee8(0x166),async()=>{const _0x1cd413=_0x4afee8;for(const _0x53590c in _0x1acfcf){_0x1acfcf[_0x53590c]['nc']&&!_0x1acfcf[_0x53590c]['nc'][_0x1cd413(0x127)]()&&await _0x1acfcf[_0x53590c]['nc'][_0x1cd413(0x1cd)]();}}),process['on'](_0x4afee8(0x1e8),async()=>{const _0x358c33=_0x4afee8;for(const _0x1d9708 in _0x1acfcf){_0x1acfcf[_0x1d9708]['nc']&&!_0x1acfcf[_0x1d9708]['nc'][_0x358c33(0x127)]()&&await _0x1acfcf[_0x1d9708]['nc'][_0x358c33(0x1cd)]();}});},module[a0_0x2ad4e4(0x19f)][a0_0x2ad4e4(0x14f)]=async(_0x21c16b,_0x26d02e,_0x20d6bd,_0xda380f)=>{const _0x15f24c=a0_0x2ad4e4,_0x369324='getAppRoles',_0x27f5a5=_0x21c16b;_0x27f5a5[_0x15f24c(0x1c9)][_0x15f24c(0x157)](_0x27f5a5[_0x15f24c(0x1e0)]+'['+_0x27f5a5['pluginName']+']\x20handling\x20\x22'+_0x369324+'\x22');try{if(!fs[_0x15f24c(0x1d6)](_0x27f5a5[_0x15f24c(0x167)]+'/approles'))fs['mkdirSync'](_0x27f5a5[_0x15f24c(0x167)]+'/approles');}catch(_0x3948a4){}const _0x15a29f=path[_0x15f24c(0x102)](''+_0x27f5a5['configDir'],_0x15f24c(0x1eb),_0x15f24c(0x130)+_0x27f5a5[_0x15f24c(0x119)]+'_autogenerated.cfg'),_0x302315={};utils['fsExistsSync'](_0x15a29f)&&fs[_0x15f24c(0x1cc)](_0x15a29f,_0x15f24c(0x116))[_0x15f24c(0x160)](/\r?\n/)[_0x15f24c(0x100)](_0x3da6f8=>{const _0x3b5c97=_0x15f24c,_0x514d9a=_0x3da6f8[_0x3b5c97(0x160)]('\x20');_0x514d9a[_0x3b5c97(0x1b1)]===0x2&&(_0x302315[_0x514d9a[0x0]]=_0x514d9a[0x1]);});const _0xbf36a2=fs[_0x15f24c(0xfa)](_0x15a29f,{'flags':'w','encoding':_0x15f24c(0x143),'mode':0x1b6,'autoClose':!![]}),_0x442353=[],_0x17ccf1=await _0x27f5a5[_0x15f24c(0x1d4)](_0x26d02e,{'attribute':undefined,'operator':undefined,'value':undefined},['id','displayName']);return _0x17ccf1[_0x15f24c(0x16e)][_0x15f24c(0x100)](_0x448e5c=>{const _0xb9673b=_0x15f24c;if(_0x448e5c['id']){let _0x3f9d12=crypto[_0xb9673b(0x172)]();if(_0x302315[_0x448e5c['id']])_0x3f9d12=_0x302315[_0x448e5c['id']];const _0x1a13ad={'allowedMemberTypes':[_0xb9673b(0x11b)],'description':_0xb9673b(0x194),'displayName':_0x448e5c[_0xb9673b(0x1b6)]||_0x448e5c['id'],'id':_0x3f9d12,'isEnabled':!![],'lang':null,'origin':'Application','value':decodeURIComponent(_0x448e5c['id'])};_0x442353[_0xb9673b(0x174)](_0x1a13ad),_0xbf36a2[_0xb9673b(0x178)](_0x448e5c['id']+'\x20'+_0x3f9d12+'\x0a');}}),_0xbf36a2[_0x15f24c(0x1bc)](),_0x27f5a5[_0x15f24c(0x1c9)]['debug'](_0x27f5a5[_0x15f24c(0x1e0)]+'['+_0x27f5a5['pluginName']+']\x20approle\x20uuid\x20file\x20created:\x20'+_0x15a29f),{'Resources':[{'appRoles':_0x442353}]};};