// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          Gateway publishing to SCIM Stream having other gateways as subscribers handling requests
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: scim-stream.js is part of the licensed SCIM Stream which is a prerequisite for message Pub/Sub
//       for details see: https://elshaug.xyz/docs/scim-stream
//
// ================================================================
'use strict';(function(_0x9489f9,_0xa108ad){const _0x3d4f8b=a0_0xb16d,_0x364ee3=_0x9489f9();while(!![]){try{const _0x4537eb=-parseInt(_0x3d4f8b(0x15f))/0x1*(parseInt(_0x3d4f8b(0x123))/0x2)+-parseInt(_0x3d4f8b(0x181))/0x3+parseInt(_0x3d4f8b(0x1cc))/0x4+parseInt(_0x3d4f8b(0x188))/0x5+parseInt(_0x3d4f8b(0x1df))/0x6*(parseInt(_0x3d4f8b(0xe4))/0x7)+parseInt(_0x3d4f8b(0x13d))/0x8*(parseInt(_0x3d4f8b(0x1ab))/0x9)+-parseInt(_0x3d4f8b(0x150))/0xa*(parseInt(_0x3d4f8b(0x117))/0xb);if(_0x4537eb===_0xa108ad)break;else _0x364ee3['push'](_0x364ee3['shift']());}catch(_0x41e5c4){_0x364ee3['push'](_0x364ee3['shift']());}}}(a0_0x4ebe,0x6e113));import{jwtAuthenticator,headers}from'@nats-io/nats-core';import{jetstream,jetstreamManager,DeliverPolicy,AckPolicy}from'@nats-io/jetstream';import{connect as a0_0x1eb4cc}from'@nats-io/transport-node';function a0_0x4ebe(){const _0x918521=['typeId','utf8','\x22\x20with\x20chunks\x20and\x20awaiting\x20result','indexOf','4rgyKDU','ENOTFOUND','\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20','elementnumber','Resources','baseUrls','debug',']\x20error:\x20missing\x20entity\x20configuration\x20for\x20baseEntity=',']\x20error:\x20','\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true','subject','approles','\x20getUserId()\x20error:\x20','\x20error:\x20','groups','reason','password','drain','normalize','forEach','write',']\x20error:\x20no\x20subscribers/responders\x20to\x20subject\x20','all','\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false','filter','status','8yiwNOh','Operations','\x22\x20and\x20awaiting\x20result','{\x22error\x22:\x22','prototype','randomUUID','getGroups','lowercase','filter_subject','SIGINT','constructor','modifyOnly','obj',']\x20handling\x20\x22',']\x20client\x20disconnected\x20','true','GW.',']\x20initialization\x20error:\x20nats.subject\x20root\x20topic\x20must\x20be\x20\x27GW\x27,\x20nats.subject\x20example:\x20GW.APP1','schemas','2673590zcWHHt','staleConnection','\x20or\x20','\x20missing\x20user\x20object\x20in\x20message:\x20',',\x20id=','modifyGroup','activityOperation','\x20createUser()\x20obj=','\x20subscriber\x20error:\x20scimgateway\x20endpoint\x20connect\x20problem\x20-\x20will\x20do\x20auto\x20retry\x20until\x20connected','Msg-Id','isClosed','createUser','publisher\x20not\x20initialized/connected','subscriber\x20message\x20error:\x20message\x20not\x20JSON\x20formatted','query','10321vRbKAY','handle','replaceDomains','getProcessed','active','deleteGroup','attributes','userName','attribute','copyObj','getApi',']\x20subscriber[','nats','endsWith','logger','allSettled','skipConvertRolesToGroups',']\x20closed\x20with\x20error:\x20','encode','createRandomPassword','certificate','baseEntity',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject','pingInterval','convertedScim20','delete','maxPingOut','\x20handling\x20message:\x20','isArray','increment','info','message',',\x20obj=','startsWith','813705OBJWxl','replaceAll','deleteUser',']\x20client\x20reconnected\x20','request','\x20(count=','operator','2780350YTjVbI','\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true','type','/approles','503','getMemberOf','get','slice','\x20-\x20',']\x20error:\x20client\x20have\x20not\x20been\x20initialized','ctxPassThrough','pluginName','gwName',']\x20initialization\x20error:\x20missing\x20configuration\x20nats',']\x20initialization\x20certificate\x20error:\x20','stringify','from','splice','\x20result=','SCIM\x20Stream\x20-\x20Autogenerated','rejected','level','configDir','\x20role\x20removal\x20error:\x20','deleteApi','rawFilter','name','_info',',true','\x27\x20not\x20supported','operation','closed','durable_','add',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant','845694wSPWrJ','getAppRoles','display','ack','passThrough','\x20message:\x20user\x20does\x20not\x20exist','caller','roles','maxReconnectAttempts','publish','string','ECONNREFUSED','disconnect','HR.','displayName','SCIM\x20Stream','append',']\x20client\x20is\x20attempting\x20to\x20reconnect\x20','\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}','reconnect','consumers',']\x20client\x20error\x20','data','func','split','sub','server_name','path','Users','error','servers','rejectUnauthorized','config','769264vuvHlv','modifyUser','\x20error:\x20missing\x20result',']\x20initialization\x20error:\x20missing\x20certificate\x20configuration',']\x20publisher[','getUsers()\x20getObj=','\x20message\x20handled:\x20','close','\x20Delete\x20User\x20id=','push','waitOnFirstConnect','\x20message\x20json\x20parsing\x20error:\x20','\x20Create\x20User\x20userName=','secret','toUpperCase','call','\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration','internal\x20stream\x20policy\x20have\x20been\x20changed\x20-\x20central\x20SCIM\x20Stream\x20must\x20be\x20stopped\x20and\x20corresponding\x20./jetstream\x20folder\x20deleted\x20before\x20startup\x20allowing\x20new\x20policy','\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available','2202buZmkM','tls','/certs/','map',']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls','getuniquevalue','reconnectTimeWait','\x20Create\x20userName=','apply','toLowerCase','\x20calling\x20\x22','replaceUsrGrp',']\x20connect\x20error:\x20','\x20Delete\x20User\x20userName=','3199vvveZk','file-not-configured','\x20message\x20error\x20response:\x20','\x20group\x20removal\x20error:\x20','UnableConnectingHost',']\x20client\x20has\x20a\x20stale\x20connection\x20','transports','publisher[','publisher\x20error:\x20none\x20JSON\x20formatted\x20response:\x20','headers','utf-8','\x20error:\x20missing\x20id}','substring','includes','\x20convertedScim20\x20error:\x20','ETIMEDOUT','deliver_policy','onCreate','foldReplacing','\x20message:\x20','\x20with\x20chunks\x20returned\x20errors:\x20',',\x20attributes=','charAt','hasOwnProperty','undefined','createWriteStream','createGroup','User','_autogenerated.cfg','All','respond','reconnecting','mkdirSync','SIGTERM','length','file','parse','tenant','readFileSync','trim','getUsers','Explicit',']\x20error:\x20message\x20must\x20be\x20JSON\x20formatted','publisher\x20response\x20error:\x20','then','consumer_not_found',']\x20subscriber\x20stopped\x20error:\x20','subscribe','jwt','\x20processing\x20incoming\x20message',',false','11HWeXwY','value','\x20Replace\x20User\x20id=','join','consume','replace','\x20done','usePutSoftSync'];a0_0x4ebe=function(){return _0x918521;};return a0_0x4ebe();}import a0_0x15849a from'fold-to-ascii';import a0_0x5517ab from'node:fs';import a0_0x31a0e9 from'node:path';import a0_0xf9b720 from'node:crypto';import*as a0_0x2da0c2 from'./utils.ts';import*as a0_0x370d20 from'./utils-scim.ts';export class Subscriber{constructor(_0x231acd){const _0x576821=a0_0xb16d,_0x6c3bac=_0x231acd,_0x2106a9={};let _0x3fcecc='';for(let _0x544b46=0x0;_0x544b46<_0x6c3bac['logger']['transports'][_0x576821(0x106)];_0x544b46++){if(_0x6c3bac[_0x576821(0x16d)][_0x576821(0xea)][_0x544b46][_0x576821(0x1a2)]===_0x576821(0x107)){_0x3fcecc=_0x6c3bac[_0x576821(0x16d)][_0x576821(0xea)][_0x544b46][_0x576821(0x19d)];break;}}const _0x146a38=''+(_0x3fcecc==='debug'?'\x0a':''),_0x4a81e6=async(_0x1cab3b,_0x2e5da1)=>{const _0x2f3463=_0x576821,_0x3d4a61=_0x2106a9[_0x1cab3b][_0x2f3463(0x1cb)]?.['nats']?.['subject'];let _0x2c390c;try{_0x2c390c=await a0_0x1eb4cc(_0x2e5da1);if(_0x2c390c[_0x2f3463(0x17d)][_0x2f3463(0x1c5)]!==_0x2f3463(0x1ba)){_0x2c390c[_0x2f3463(0x1d3)]();return;}_0x2106a9[_0x1cab3b]['nc']=_0x2c390c,_0x5232e7(_0x1cab3b,_0x2c390c),_0x499d06(_0x1cab3b,_0x2c390c);}catch(_0x3ed5f6){_0x6c3bac[_0x2f3463(0x16d)][_0x2f3463(0x1c8)](_0x6c3bac[_0x2f3463(0x194)]+'['+_0x6c3bac['pluginName']+_0x2f3463(0x16a)+_0x1cab3b+']['+_0x3d4a61+_0x2f3463(0xe2)+_0x3ed5f6[_0x2f3463(0x17e)]+'\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration'),_0x2e5da1[_0x2f3463(0x1d6)]=!![];try{_0x2c390c=await a0_0x1eb4cc(_0x2e5da1);if(_0x2c390c[_0x2f3463(0x17d)]['server_name']!=='SCIM\x20Stream'){_0x2c390c['close']();return;}_0x2106a9[_0x1cab3b]['nc']=_0x2c390c,_0x5232e7(_0x1cab3b,_0x2c390c),_0x499d06(_0x1cab3b,_0x2c390c);}catch(_0x3451a1){_0x6c3bac[_0x2f3463(0x16d)][_0x2f3463(0x1c8)](_0x6c3bac[_0x2f3463(0x194)]+'['+_0x6c3bac[_0x2f3463(0x193)]+_0x2f3463(0x16a)+_0x1cab3b+']['+_0x3d4a61+_0x2f3463(0xe2)+_0x3451a1[_0x2f3463(0x17e)]);return;}}_0x6c3bac['logger'][_0x2f3463(0x129)](_0x6c3bac['gwName']+'['+_0x6c3bac[_0x2f3463(0x193)]+']\x20subscriber['+_0x1cab3b+']['+_0x3d4a61+']\x20connected\x20'+(_0x2e5da1[_0x2f3463(0x1e0)]['ca']?_0x2f3463(0x1e0):'')+'\x20'+_0x2c390c['getServer']()),_0x2c390c['closed']()[_0x2f3463(0x110)](_0x2bc89f=>{const _0x4d451b=_0x2f3463;_0x2bc89f&&_0x6c3bac[_0x4d451b(0x16d)][_0x4d451b(0x1c8)](_0x6c3bac['gwName']+'['+_0x6c3bac[_0x4d451b(0x193)]+_0x4d451b(0x16a)+_0x1cab3b+']['+_0x3d4a61+_0x4d451b(0x170)+_0x2bc89f['message']);});};this[_0x576821(0x1a9)]=async(_0x33e51c,_0x16bb18)=>{const _0x129325=_0x576821;if(!_0x16bb18?.[_0x129325(0x16b)]){_0x6c3bac[_0x129325(0x16d)][_0x129325(0x1c8)](_0x6c3bac[_0x129325(0x194)]+'['+_0x6c3bac['pluginName']+']\x20subscriber['+_0x33e51c+_0x129325(0x195));return;}if(!_0x16bb18?.['nats']?.[_0x129325(0x109)]){_0x6c3bac['logger'][_0x129325(0x1c8)](_0x6c3bac[_0x129325(0x194)]+'['+_0x6c3bac[_0x129325(0x193)]+']\x20subscriber['+_0x33e51c+_0x129325(0x1aa));return;}if(!_0x16bb18?.[_0x129325(0x16b)]?.[_0x129325(0x12d)]){_0x6c3bac['logger'][_0x129325(0x1c8)](_0x6c3bac[_0x129325(0x194)]+'['+_0x6c3bac['pluginName']+_0x129325(0x16a)+_0x33e51c+_0x129325(0x175));return;}if(!_0x16bb18?.['certificate']?.['ca']){_0x6c3bac[_0x129325(0x16d)][_0x129325(0x1c8)](_0x6c3bac[_0x129325(0x194)]+'['+_0x6c3bac[_0x129325(0x193)]+_0x129325(0x16a)+_0x33e51c+']\x20initialization\x20error:\x20missing\x20certificate\x20configuration');return;}if(!_0x16bb18[_0x129325(0x128)]||!Array['isArray'](_0x16bb18[_0x129325(0x128)])||_0x16bb18['baseUrls'][_0x129325(0x106)]<0x1){_0x6c3bac[_0x129325(0x16d)][_0x129325(0x1c8)](_0x6c3bac[_0x129325(0x194)]+'['+_0x6c3bac[_0x129325(0x193)]+_0x129325(0x16a)+_0x33e51c+_0x129325(0x1e3));return;}if(!_0x16bb18[_0x129325(0x11e)]){const _0x4f1cc4=_0x16bb18?.[_0x129325(0x16b)]?.[_0x129325(0x12d)][_0x129325(0x1da)]();if(_0x4f1cc4[_0x129325(0x180)](_0x129325(0x1b8)))_0x16bb18[_0x129325(0x11e)]=!![];}const _0x2794d6={};try{let _0x3038fa=a0_0x31a0e9[_0x129325(0x11a)](_0x6c3bac[_0x129325(0x19e)],_0x129325(0x1e1),_0x16bb18?.['certificate']?.['ca']||_0x129325(0xe5));(_0x16bb18?.[_0x129325(0x173)]?.['ca']?.['startsWith']('/')||_0x16bb18?.[_0x129325(0x173)]?.['ca']?.[_0x129325(0xf1)]('\x5c'))&&(_0x3038fa=_0x16bb18[_0x129325(0x173)]['ca']),_0x2794d6['ca']=[a0_0x5517ab[_0x129325(0x10a)](_0x3038fa)],_0x2794d6[_0x129325(0x1ca)]=!![];}catch(_0x1ba58a){_0x6c3bac[_0x129325(0x16d)][_0x129325(0x1c8)](_0x6c3bac['gwName']+'['+_0x6c3bac['pluginName']+_0x129325(0x16a)+_0x33e51c+_0x129325(0x196)+_0x1ba58a['message']);return;}const _0x5ecf52={},_0xd0664=new TextEncoder()[_0x129325(0x171)](_0x16bb18?.[_0x129325(0x16b)]?.[_0x129325(0x1d9)]),_0x40ca4c=_0x16bb18?.[_0x129325(0x16b)]?.['jwt'];_0x5ecf52['authenticator']=jwtAuthenticator(_0x40ca4c,_0xd0664),_0x5ecf52[_0x129325(0x1c9)]=_0x16bb18[_0x129325(0x128)],_0x5ecf52[_0x129325(0x1e0)]=_0x2794d6,_0x5ecf52[_0x129325(0x1d6)]=![],_0x5ecf52[_0x129325(0x1be)]=!![],_0x5ecf52[_0x129325(0x1e5)]=0x3e8*0xa,_0x5ecf52['maxReconnectAttempts']=-0x1,_0x5ecf52[_0x129325(0x176)]=0x2*0x3c*0x3e8,_0x5ecf52[_0x129325(0x179)]=0x5,_0x5ecf52['debug']=![],_0x2106a9[_0x33e51c]={},_0x2106a9[_0x33e51c][_0x129325(0x1cb)]=_0x16bb18,_0x2106a9[_0x33e51c]['nc']=undefined,_0x2106a9[_0x33e51c][_0x129325(0x1c4)]=undefined,_0x4a81e6(_0x33e51c,_0x5ecf52);};const _0x499d06=async(_0x5f05b4,_0x2fe531)=>{const _0x73c459=_0x576821,_0x55455f=_0x2106a9[_0x5f05b4][_0x73c459(0x1cb)],_0x3c536d=_0x55455f?.[_0x73c459(0x16b)]?.[_0x73c459(0x12d)];if(!_0x2fe531){_0x6c3bac['logger'][_0x73c459(0x1c8)](_0x6c3bac['gwName']+'['+_0x6c3bac[_0x73c459(0x193)]+_0x73c459(0x16a)+_0x5f05b4+']['+_0x3c536d+_0x73c459(0x191));return;}const _0x58d20e=async(_0x4b165b,_0x5ab24c)=>{const _0x29b91c=_0x73c459;try{_0x6c3bac[_0x29b91c(0x16d)]['info'](_0x4b165b+_0x29b91c(0x17a)+_0x5ab24c);let _0xdb60de;try{if(_0x55455f[_0x29b91c(0x161)]&&Array[_0x29b91c(0x17b)](_0x55455f[_0x29b91c(0x161)]))for(let _0x1d3b3b=0x0;_0x1d3b3b<_0x55455f[_0x29b91c(0x161)]['length'];_0x1d3b3b++){const _0x4683a8=_0x55455f[_0x29b91c(0x161)][_0x1d3b3b];if(!_0x4683a8[_0x29b91c(0x198)]||!_0x4683a8['from'][_0x29b91c(0xf1)]('.')||!_0x4683a8['to']||!_0x4683a8['to']['includes']('.'))continue;const _0x1d95ee=new RegExp('@'+_0x4683a8[_0x29b91c(0x198)]+'\x22','gi');_0x5ab24c=_0x5ab24c[_0x29b91c(0x11c)](_0x1d95ee,'@'+_0x4683a8['to']+'\x22');}_0xdb60de=JSON[_0x29b91c(0x108)](_0x5ab24c);}catch(_0x20ffee){_0x6c3bac[_0x29b91c(0x16d)]['error'](_0x4b165b+_0x29b91c(0x1d7)+_0x20ffee[_0x29b91c(0x17e)]+_0x29b91c(0xf7)+_0x5ab24c),_0x6c3bac['logger'][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}const _0x14bf89=_0xdb60de['user'];if(!_0x14bf89){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x153)+JSON['stringify'](_0xdb60de)),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+'\x20done'+_0x146a38);return;}if(!_0x14bf89[_0x29b91c(0x166)]){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x125)+JSON[_0x29b91c(0x197)](_0xdb60de)),_0x6c3bac[_0x29b91c(0x16d)]['debug'](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}delete _0x14bf89[_0x29b91c(0x14f)];let _0x5c7ee4;_0x14bf89['id']&&(_0x5c7ee4=_0x14bf89['id'],delete _0x14bf89['id']);let _0x127398;_0x14bf89[_0x29b91c(0xf5)]&&(_0x127398=a0_0x2da0c2['copyObj'](_0x14bf89['onCreate']),delete _0x14bf89['onCreate']);await _0x11ce40(_0x5f05b4,_0x14bf89);const _0xf9ab78=_0x14bf89[_0x29b91c(0x166)];let _0x2d3a22,_0x311b53;try{_0x2d3a22=await _0x53ada3(_0x5f05b4,_0x29b91c(0x166),_0xf9ab78);}catch(_0x2f916f){_0x6c3bac['logger'][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x12f)+_0x2f916f[_0x29b91c(0x17e)]),_0x6c3bac[_0x29b91c(0x16d)]['debug'](_0x4b165b+'\x20done'+_0x146a38);const _0x47c51c=[_0x29b91c(0xe8),'UnableConnectingService',_0x29b91c(0x1b6),_0x29b91c(0x124),_0x29b91c(0xf3),'timeout'];for(const _0x6f66bb in _0x47c51c){if(_0x2f916f[_0x29b91c(0x17e)][_0x29b91c(0xf1)](_0x6f66bb))return!![];}return;}if(!_0x55455f[_0x29b91c(0x16f)]){let _0x5ae404=![];if(_0xdb60de[_0x29b91c(0x13e)]&&Array[_0x29b91c(0x17b)](_0xdb60de[_0x29b91c(0x13e)]))for(let _0x3d883b=0x0;_0x3d883b<_0xdb60de[_0x29b91c(0x13e)]['length'];_0x3d883b++){const _0x11449a=_0xdb60de[_0x29b91c(0x13e)][_0x3d883b];_0x11449a[_0x29b91c(0x1c6)][_0x29b91c(0x180)](_0x29b91c(0x1b2))&&(_0x11449a[_0x29b91c(0x1c6)]=_0x29b91c(0x131),Array[_0x29b91c(0x17b)](_0x11449a[_0x29b91c(0x118)])?(_0x11449a[_0x29b91c(0x118)][0x0]['id']=_0x11449a[_0x29b91c(0x118)][0x0]['value'],_0x11449a['value'][0x0][_0x29b91c(0x1ad)]=_0x11449a[_0x29b91c(0x118)][0x0][_0x29b91c(0x18a)]+_0x29b91c(0x190)+_0x11449a['value'][0x0][_0x29b91c(0x118)],delete _0x11449a[_0x29b91c(0x118)][0x0][_0x29b91c(0x118)],delete _0x11449a['value'][0x0][_0x29b91c(0x18a)]):_0x11449a['value']=[{'id':_0x11449a[_0x29b91c(0x118)],'display':_0x11449a['value']}],delete _0x11449a['typeId'],_0x5ae404=!![]);}if(_0x14bf89[_0x29b91c(0x1b2)]&&Array[_0x29b91c(0x17b)](_0x14bf89['roles'])&&_0x14bf89[_0x29b91c(0x1b2)]['length']>0x0){if(!_0x14bf89[_0x29b91c(0x131)])_0x14bf89[_0x29b91c(0x131)]=[];if(!Array[_0x29b91c(0x17b)](_0x14bf89[_0x29b91c(0x131)]))_0x14bf89[_0x29b91c(0x131)]=[];for(let _0x36fb19=0x0;_0x36fb19<_0x14bf89['roles'][_0x29b91c(0x106)];_0x36fb19++){const _0x26b22d={},_0x3d906d=_0x14bf89['roles'][_0x36fb19];_0x26b22d['value']=_0x3d906d[_0x29b91c(0x118)],_0x26b22d[_0x29b91c(0x1ad)]=_0x3d906d[_0x29b91c(0x18a)]+'\x20-\x20'+_0x3d906d['display'],_0x14bf89[_0x29b91c(0x131)][_0x29b91c(0x1d5)](_0x26b22d);}delete _0x14bf89[_0x29b91c(0x1b2)],_0x5ae404=!![];}if(_0x5ae404)_0x6c3bac[_0x29b91c(0x16d)]['debug'](_0x4b165b+'\x20roles\x20converted\x20to\x20groups:\x20'+JSON['stringify'](_0xdb60de));}if(!_0x2d3a22){if(_0xdb60de[_0x29b91c(0x156)]===_0x29b91c(0x183)){_0x6c3bac[_0x29b91c(0x16d)]['debug'](_0x4b165b+_0x29b91c(0xe3)+_0xf9ab78+_0x29b91c(0x1b0)),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}if(_0x55455f['modifyOnly']&&_0x55455f[_0x29b91c(0x148)]===!![]){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x1e6)+_0xf9ab78+_0x29b91c(0x12c)),_0x6c3bac[_0x29b91c(0x16d)]['debug'](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}if(Object[_0x29b91c(0x141)][_0x29b91c(0xfb)]['call'](_0x14bf89,_0x29b91c(0x163))){if(typeof _0x14bf89[_0x29b91c(0x163)]===_0x29b91c(0x1b5)){const _0x564718=_0x14bf89[_0x29b91c(0x163)][_0x29b91c(0x1e8)]();if(_0x564718==='true')_0x14bf89[_0x29b91c(0x163)]=!![];else{if(_0x564718==='false')_0x14bf89['active']=![];}}if(_0x14bf89[_0x29b91c(0x163)]===![]){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x1e6)+_0xf9ab78+_0x29b91c(0x13a)),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}}_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x1d8)+_0xf9ab78);const _0x4f6e28=a0_0x2da0c2[_0x29b91c(0x168)](_0x14bf89);try{delete _0x4f6e28[_0x29b91c(0x131)];!_0x4f6e28[_0x29b91c(0x133)]&&_0x55455f['generateUserPassword']&&_0x55455f['generateUserPassword']===!![]&&(_0x4f6e28[_0x29b91c(0x133)]=a0_0x2da0c2[_0x29b91c(0x172)](0xf));if(_0x127398||_0x5c7ee4){if(_0x127398)for(const _0x203075 in _0x127398){_0x4f6e28[_0x203075]=_0x127398[_0x203075];}if(_0x5c7ee4)_0x4f6e28['id']=_0x5c7ee4;await _0x11ce40(_0x5f05b4,_0x4f6e28);}await _0x6c3bac[_0x29b91c(0x15b)](_0x5f05b4,_0x4f6e28),_0x14bf89[_0x29b91c(0x131)]&&Array[_0x29b91c(0x17b)](_0x14bf89[_0x29b91c(0x131)])&&_0x14bf89[_0x29b91c(0x131)][_0x29b91c(0x106)]>0x0&&(_0x311b53=await _0x53ada3(_0x5f05b4,_0x29b91c(0x166),_0xf9ab78));}catch(_0x24e317){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x157)+JSON['stringify'](_0x4f6e28)+'\x20error:\x20'+_0x24e317[_0x29b91c(0x17e)]+'}'),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+'\x20done'+_0x146a38);return;}}if(_0x2d3a22||_0x311b53){if(_0xdb60de['activityOperation']===_0x29b91c(0x183)){if(_0x55455f[_0x29b91c(0x148)]&&_0x55455f['modifyOnly']===!![]){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+'\x20Delete\x20User\x20id='+_0x2d3a22+_0x29b91c(0x189)),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x1d4)+_0x2d3a22);try{await _0x6c3bac[_0x29b91c(0x183)](_0x5f05b4,_0x2d3a22);}catch(_0x28a64d){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x1d4)+_0x2d3a22+_0x29b91c(0x130)+_0x28a64d[_0x29b91c(0x17e)]+'}'),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}}else{if(_0x311b53)_0x2d3a22=_0x311b53;_0x6c3bac['logger'][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x119)+_0x2d3a22);try{await _0x6c3bac[_0x29b91c(0x1ea)](_0x29b91c(0x1c7),_0x5f05b4,_0x2d3a22,_0x14bf89,_0x55455f['usePutSoftSync']);}catch(_0x8caade){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x119)+_0x2d3a22+'\x20error:\x20'+_0x8caade[_0x29b91c(0x17e)]),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+'\x20done'+_0x146a38);return;}if(_0x55455f[_0x29b91c(0x11e)]){const [_0x35d644,_0x506944]=a0_0x370d20[_0x29b91c(0x177)]({'Operations':_0xdb60de['Operations']});if(_0x506944){_0x6c3bac['logger'][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x119)+_0x2d3a22+_0x29b91c(0xf2)+_0x506944[_0x29b91c(0x17e)]),_0x6c3bac[_0x29b91c(0x16d)]['debug'](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);return;}const _0x31c0a9=[];if(_0x35d644[_0x29b91c(0x1b2)]&&Array[_0x29b91c(0x17b)](_0x35d644['roles']))for(let _0x1b5da8=0x0;_0x1b5da8<_0x35d644[_0x29b91c(0x1b2)][_0x29b91c(0x106)];_0x1b5da8++){_0x35d644[_0x29b91c(0x1b2)][_0x1b5da8][_0x29b91c(0x1a6)]&&_0x35d644[_0x29b91c(0x1b2)][_0x1b5da8][_0x29b91c(0x1a6)]===_0x29b91c(0x178)&&_0x31c0a9[_0x29b91c(0x1d5)](_0x35d644['roles'][_0x1b5da8]);}if(_0x31c0a9['length']>0x0)try{await _0x6c3bac[_0x29b91c(0x1cd)](_0x5f05b4,_0x2d3a22,{'roles':_0x31c0a9});}catch(_0x5a9285){_0x6c3bac['logger'][_0x29b91c(0x1c8)](_0x4b165b+_0x29b91c(0x119)+_0x2d3a22+_0x29b91c(0x19f)+_0x5a9285['message']);}const _0xac8fc6=[];if(_0x35d644[_0x29b91c(0x131)]&&Array[_0x29b91c(0x17b)](_0x35d644[_0x29b91c(0x131)]))for(let _0x1b72af=0x0;_0x1b72af<_0x35d644[_0x29b91c(0x131)]['length'];_0x1b72af++){_0x35d644[_0x29b91c(0x131)][_0x1b72af][_0x29b91c(0x1a6)]&&_0x35d644[_0x29b91c(0x131)][_0x1b72af][_0x29b91c(0x1a6)]==='delete'&&_0xac8fc6['push'](_0x35d644[_0x29b91c(0x131)][_0x1b72af]);}if(_0xac8fc6[_0x29b91c(0x106)]>0x0)for(let _0xae40ca=0x0;_0xae40ca<_0xac8fc6[_0x29b91c(0x106)];_0xae40ca++){try{await _0x6c3bac[_0x29b91c(0x155)](_0x5f05b4,_0xac8fc6[_0xae40ca]['id'],{'members':[{'operation':'delete','value':_0x2d3a22}]});}catch(_0x2d9e6a){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+'\x20Replace\x20User\x20id='+_0x2d3a22+_0x29b91c(0xe7)+_0x2d9e6a['message']);}}}if(_0x55455f['deleteUserOnLastGroupRoleRemoval']&&_0xdb60de[_0x29b91c(0x156)]===_0x29b91c(0x1cd)){if(_0x14bf89[_0x29b91c(0x131)]&&Array['isArray'](_0x14bf89['groups'])&&_0x14bf89[_0x29b91c(0x131)][_0x29b91c(0x106)]===0x0){if(_0x14bf89['roles']&&Array[_0x29b91c(0x17b)](_0x14bf89[_0x29b91c(0x1b2)])&&_0x14bf89[_0x29b91c(0x1b2)][_0x29b91c(0x106)]===0x0){if(_0xdb60de[_0x29b91c(0x13e)]&&Array[_0x29b91c(0x17b)](_0xdb60de[_0x29b91c(0x13e)])&&_0xdb60de[_0x29b91c(0x13e)][_0x29b91c(0x106)]>0x0){let _0x3afc39=![];for(let _0x4d5bfb=0x0;_0x4d5bfb<_0xdb60de[_0x29b91c(0x13e)]['length'];_0x4d5bfb++){const _0x34134a=_0xdb60de[_0x29b91c(0x13e)][_0x4d5bfb];if(_0x34134a['op']==='remove'){if(_0x34134a['path']){if(_0x34134a[_0x29b91c(0x1c6)][_0x29b91c(0x180)]('roles')&&_0x34134a[_0x29b91c(0x11f)]){_0x3afc39=!![];break;}else{if(_0x34134a['path']==='groups'){_0x3afc39=!![];break;}}}}}if(_0x3afc39){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x1d4)+_0x2d3a22);try{await _0x6c3bac[_0x29b91c(0x183)](_0x5f05b4,_0x2d3a22);}catch(_0x1872a3){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x4b165b+'\x20Delete\x20User\x20id='+_0x2d3a22+_0x29b91c(0x130)+_0x1872a3[_0x29b91c(0x17e)]+'}'),_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+'\x20done'+_0x146a38);return;}}}}}}}}_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x129)](_0x4b165b+_0x29b91c(0x11d)+_0x146a38);}catch(_0x54c35d){_0x6c3bac[_0x29b91c(0x16d)][_0x29b91c(0x1c8)](_0x6c3bac[_0x29b91c(0x194)]+'['+_0x6c3bac['pluginName']+_0x29b91c(0x16a)+_0x5f05b4+']['+_0x3c536d+_0x29b91c(0x12b)+_0x54c35d[_0x29b91c(0x17e)]+'\x20=>\x20subscriber\x20not\x20activated'+_0x146a38);}},_0x381681=jetstream(_0x2fe531),_0x312a19=(_0x73c459(0x1a8)+_0x6c3bac[_0x73c459(0x193)]+'_'+_0x5f05b4)[_0x73c459(0x182)]('*','#')[_0x73c459(0x182)]('>','##')[_0x73c459(0x182)]('.','_'),_0x42cd1c=_0x3c536d[_0x73c459(0x1c3)]('.')[0x0][_0x73c459(0x1da)]()==='GW',_0xdfe09a=async()=>{const _0x3b5637=_0x73c459;try{let _0x3fcf66;const _0x10bea2=''+_0x55455f?.[_0x3b5637(0x16b)]?.['tenant'],_0x1d79dd=await jetstreamManager(_0x2fe531),_0x10140c=async()=>{const _0x5e5ad1=_0x3b5637;let _0x38f7cc;try{_0x38f7cc=await _0x381681[_0x5e5ad1(0x1bf)][_0x5e5ad1(0x18e)](_0x10bea2,_0x312a19);}catch(_0x3c3663){const _0xd49452={'durable_name':_0x312a19,'deliver_policy':DeliverPolicy[_0x5e5ad1(0x101)],'ack_policy':AckPolicy[_0x5e5ad1(0x10d)],'filter_subject':_0x3c536d};await _0x1d79dd['consumers']['add'](_0x10bea2,_0xd49452),_0x38f7cc=await _0x381681[_0x5e5ad1(0x1bf)][_0x5e5ad1(0x18e)](_0x10bea2,_0x312a19);}if(_0x38f7cc?.[_0x5e5ad1(0x1a3)]?.[_0x5e5ad1(0x1cb)]?.[_0x5e5ad1(0xf4)]!==_0x5e5ad1(0x139))throw new Error(_0x5e5ad1(0x1dd));_0x38f7cc?.[_0x5e5ad1(0x1a3)]?.['config']?.[_0x5e5ad1(0x145)]!==_0x3c536d&&(await _0x1d79dd[_0x5e5ad1(0x1bf)]['update'](_0x10bea2,_0x312a19,{'filter_subject':_0x3c536d}),_0x38f7cc=await _0x381681[_0x5e5ad1(0x1bf)][_0x5e5ad1(0x18e)](_0x10bea2,_0x312a19)),_0x3fcf66=await _0x38f7cc[_0x5e5ad1(0x11b)]({'max_messages':0x64}),_0x1d1616(_0x3fcf66);},_0x1d1616=async _0x2086ce=>{const _0x2df83e=_0x3b5637;for await(const _0x440d13 of await _0x2086ce[_0x2df83e(0x13c)]()){switch(_0x440d13[_0x2df83e(0x18a)]){case _0x2df83e(0x111):_0x6c3bac[_0x2df83e(0x16d)][_0x2df83e(0x17d)](_0x6c3bac[_0x2df83e(0x194)]+'['+_0x6c3bac['pluginName']+_0x2df83e(0x16a)+_0x5f05b4+']['+_0x3c536d+']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20'+_0x440d13[_0x2df83e(0x18a)]),_0x10140c();return;}}};await _0x10140c();let _0x560173=-0x1;do{for await(const _0x477f02 of _0x3fcf66){if(!_0x477f02[_0x3b5637(0xed)]||!_0x477f02[_0x3b5637(0xed)][_0x3b5637(0x18e)](_0x3b5637(0x159))){_0x477f02[_0x3b5637(0x1ae)]();continue;}_0x560173=_0x3fcf66[_0x3b5637(0x162)]();const _0x4b6e1f=_0x6c3bac['gwName']+'['+_0x6c3bac[_0x3b5637(0x193)]+_0x3b5637(0x16a)+_0x5f05b4+']['+_0x477f02['subject']+']['+_0x560173+']['+(_0x477f02['headers']?_0x477f02[_0x3b5637(0xed)][_0x3b5637(0x18e)](_0x3b5637(0x159)):'')+']',_0x560198=_0x477f02['string'](),_0x46ddd9=await _0x58d20e(_0x4b6e1f,_0x560198);if(!_0x46ddd9||_0x46ddd9!==!![])_0x477f02['ack']();else _0x6c3bac[_0x3b5637(0x16d)][_0x3b5637(0x1c8)](_0x4b6e1f+_0x3b5637(0x158));if(_0x560173<0x1)break;}}while(_0x560173===0x0);}catch(_0x3ae582){_0x6c3bac[_0x3b5637(0x16d)]['error'](_0x6c3bac['gwName']+'['+_0x6c3bac['pluginName']+']\x20subscriber['+_0x5f05b4+']['+_0x3c536d+_0x3b5637(0x112)+_0x3ae582['message']);}},_0x5dd8c3=async()=>{const _0x20d9c3=_0x73c459,_0xaf7598=_0x2fe531[_0x20d9c3(0x113)](_0x3c536d,{'max':0x64});for await(const _0xf36dbf of _0xaf7598){if(!_0xf36dbf[_0x20d9c3(0xed)]||!_0xf36dbf['headers']['get']('Msg-Id'))continue;let _0x5351c,_0x1967da;try{try{_0x5351c=JSON[_0x20d9c3(0x108)](_0xf36dbf[_0x20d9c3(0x1b5)]());}catch(_0x24ca89){const _0x466523=_0x20d9c3(0x15d);_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x1c8)](_0x6c3bac[_0x20d9c3(0x194)]+'['+_0x6c3bac[_0x20d9c3(0x193)]+_0x20d9c3(0x16a)+_0x5f05b4+']['+_0x3c536d+']\x20'+_0x466523+':\x20'+_0xf36dbf[_0x20d9c3(0x1b5)]());throw new Error(_0x466523);}if(!_0x5351c||!_0x5351c['func']){const _0x23d771='subscriber\x20message\x20error:\x20message\x20missing\x20method';this[_0x20d9c3(0x1b1)]['logger'][_0x20d9c3(0x1c8)](this[_0x20d9c3(0x1b1)]['gwName']+'['+this[_0x20d9c3(0x1b1)][_0x20d9c3(0x193)]+']\x20subscriber['+_0x5f05b4+']['+_0x3c536d+']\x20'+_0x23d771+':\x20'+_0x5351c);throw new Error(_0x23d771);}!Object[_0x20d9c3(0x141)]['hasOwnProperty'][_0x20d9c3(0x1db)](_0x5351c,_0x20d9c3(0x174))&&(_0x5351c[_0x20d9c3(0x174)]=_0x20d9c3(0xfc));if(_0x5351c[_0x20d9c3(0x174)]!==_0x5f05b4){const _0x29c9b5='subscriber\x20message\x20error:\x20message\x20baseEntity='+_0x5351c[_0x20d9c3(0x174)]+'\x20not\x20equal\x20subscriber\x20configured\x20baseEntity='+_0x5f05b4;_0x6c3bac[_0x20d9c3(0x16d)]['error'](_0x6c3bac[_0x20d9c3(0x194)]+'['+_0x6c3bac[_0x20d9c3(0x193)]+_0x20d9c3(0x16a)+_0x5f05b4+']['+_0x3c536d+']\x20'+_0x29c9b5);throw new Error(_0x29c9b5);}_0x1967da=_0x6c3bac[_0x20d9c3(0x194)]+'['+_0x6c3bac[_0x20d9c3(0x193)]+_0x20d9c3(0x16a)+_0x5f05b4+']['+_0xf36dbf['subject']+']['+(_0xf36dbf[_0x20d9c3(0xed)]?_0xf36dbf[_0x20d9c3(0xed)][_0x20d9c3(0x18e)]('Msg-Id'):'')+']',_0x6c3bac[_0x20d9c3(0x16d)]['debug'](_0x1967da+_0x20d9c3(0x115));let _0x2eac7b,_0x2eddee;switch(_0x5351c[_0x20d9c3(0x1c2)]){case _0x20d9c3(0x10c):if(!_0x5351c[_0x20d9c3(0x149)][_0x20d9c3(0x187)]&&_0x5351c[_0x20d9c3(0x149)][_0x20d9c3(0x1a1)]&&_0x5351c[_0x20d9c3(0x149)]['rawFilter'][_0x20d9c3(0xf1)](_0x20d9c3(0x152))){const _0x14d8c0=_0x5351c[_0x20d9c3(0x149)][_0x20d9c3(0x1a1)][_0x20d9c3(0x1c3)](_0x20d9c3(0x152));let _0xcc0a4d=[];for(let _0x168cf5=0x0;_0x168cf5<_0x14d8c0[_0x20d9c3(0x106)];_0x168cf5++){_0x14d8c0[_0x168cf5]=_0x14d8c0[_0x168cf5][_0x20d9c3(0x11c)](/\(/g,'')[_0x20d9c3(0x11c)](/\)/g,'')[_0x20d9c3(0x10b)]();const _0x53653b=_0x14d8c0[_0x168cf5]['split']('\x20');if(_0x53653b[_0x20d9c3(0x106)]===0x3||_0x53653b['length']>0x2&&_0x53653b[0x2][_0x20d9c3(0x180)]('\x22')&&_0x53653b[_0x53653b['length']-0x1][_0x20d9c3(0x16c)]('\x22')){const _0x20ed2e={};_0x20ed2e[_0x20d9c3(0x167)]=_0x53653b[0x0],_0x20ed2e[_0x20d9c3(0x187)]=_0x53653b[0x1][_0x20d9c3(0x1e8)](),_0x20ed2e[_0x20d9c3(0x118)]=decodeURIComponent(_0x53653b[_0x20d9c3(0x18f)](0x2)[_0x20d9c3(0x11a)]('\x20')[_0x20d9c3(0x11c)](/"/g,'')),_0xcc0a4d[_0x20d9c3(0x1d5)](_0x20ed2e);}else{_0xcc0a4d=[];break;}}if(_0xcc0a4d[_0x20d9c3(0x106)]>0x0){const _0x1bb7f2=async _0x1b01fd=>{const _0x137908=_0x20d9c3;return await _0x6c3bac[_0x5351c['func']](_0x5f05b4,_0x1b01fd,_0x5351c[_0x137908(0x165)],_0x5351c[_0x137908(0x1af)]);},_0x3aad60=0x5,_0x173d22=[];_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+'\x20calling\x20\x22'+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x121));do{const _0x3fa170=_0xcc0a4d[_0x20d9c3(0x199)](0x0,_0x3aad60),_0x2bc681=await Promise[_0x20d9c3(0x16e)](_0x3fa170['map'](_0x1759bc=>_0x1bb7f2(_0x1759bc))),_0x30b986=_0x2bc681[_0x20d9c3(0x13b)](_0x8881d0=>_0x8881d0[_0x20d9c3(0x13c)]===_0x20d9c3(0x19c))[_0x20d9c3(0x1e2)](_0x96d875=>_0x96d875[_0x20d9c3(0x132)][_0x20d9c3(0x17e)]);if(_0x30b986['length']>0x0){const _0x34811d=_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0xf8)+_0x30b986[_0x20d9c3(0x11a)](',\x20');throw new Error(_0x34811d);}const _0x56bc7e=_0x2bc681[_0x20d9c3(0x1e2)](_0x2c7f8b=>_0x2c7f8b?.['value']?.[_0x20d9c3(0x127)]);for(let _0x5d9193=0x0;_0x5d9193<_0x56bc7e[_0x20d9c3(0x106)];_0x5d9193++){Array[_0x20d9c3(0x141)][_0x20d9c3(0x1d5)][_0x20d9c3(0x1e7)](_0x173d22,_0x56bc7e[_0x5d9193]);}}while(_0xcc0a4d[_0x20d9c3(0x106)]>0x0);_0x2eac7b={'Resources':_0x173d22};}}!_0x2eac7b&&(_0x6c3bac['logger'][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c[_0x20d9c3(0x149)],_0x5351c[_0x20d9c3(0x165)],_0x5351c['ctxPassThrough']));if(Array[_0x20d9c3(0x17b)](_0x2eac7b?.[_0x20d9c3(0x127)])){if(_0x5351c?.[_0x20d9c3(0x165)]?.[_0x20d9c3(0x106)]===0x0||_0x5351c?.[_0x20d9c3(0x165)]?.[_0x20d9c3(0xf1)](_0x20d9c3(0x131)))for(let _0x1c816b=0x0;_0x1c816b<_0x2eac7b[_0x20d9c3(0x127)][_0x20d9c3(0x106)];_0x1c816b++){const _0x95ff8b=_0x2eac7b[_0x20d9c3(0x127)][_0x1c816b];if(!_0x95ff8b['id'])break;if(_0x95ff8b['groups'])break;_0x95ff8b[_0x20d9c3(0x131)]=await _0x6c3bac[_0x20d9c3(0x18d)](_0x5f05b4,_0x95ff8b['id'],_0x20d9c3(0x143),_0x5351c['ctxPassThrough']);}}break;case _0x20d9c3(0x143):_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['obj'],_0x5351c[_0x20d9c3(0x165)],_0x5351c[_0x20d9c3(0x192)]);break;case _0x20d9c3(0x15b):_0x6c3bac['logger'][_0x20d9c3(0x129)](_0x1967da+'\x20calling\x20\x22'+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c[_0x20d9c3(0x149)],_0x5351c[_0x20d9c3(0x192)]);break;case _0x20d9c3(0xfe):_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c['func']+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c['func']](_0x5f05b4,_0x5351c[_0x20d9c3(0x149)],_0x5351c[_0x20d9c3(0x192)]);break;case _0x20d9c3(0x183):_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x192)]);break;case _0x20d9c3(0x164):_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c['func']+'\x22\x20and\x20awaiting\x20result'),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x192)]);break;case'modifyUser':_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+'\x20calling\x20\x22'+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x149)],_0x5351c[_0x20d9c3(0x192)]);break;case _0x20d9c3(0x155):_0x6c3bac['logger']['debug'](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x149)],_0x5351c[_0x20d9c3(0x192)]);break;case'replaceUsrGrp':_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+'\x20calling\x20\x22'+_0x5351c[_0x20d9c3(0x1c2)]+'\x22\x20and\x20awaiting\x20result'),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5351c[_0x20d9c3(0x160)],_0x5f05b4,_0x5351c['id'],_0x5351c['obj'],_0x55455f[_0x20d9c3(0x11e)],_0x5351c[_0x20d9c3(0x192)]);break;case'postApi':_0x6c3bac['logger'][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c['func']](_0x5f05b4,_0x5351c[_0x20d9c3(0x149)],_0x5351c['ctxPassThrough']);break;case'putApi':_0x6c3bac[_0x20d9c3(0x16d)]['debug'](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+'\x22\x20and\x20awaiting\x20result'),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x149)],_0x5351c[_0x20d9c3(0x192)]);break;case'patchApi':_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c['func']+'\x22\x20and\x20awaiting\x20result'),_0x2eac7b=await _0x6c3bac[_0x5351c[_0x20d9c3(0x1c2)]](_0x5f05b4,_0x5351c['id'],_0x5351c['obj'],_0x5351c[_0x20d9c3(0x192)]);break;case _0x20d9c3(0x169):_0x6c3bac[_0x20d9c3(0x16d)][_0x20d9c3(0x129)](_0x1967da+'\x20calling\x20\x22'+_0x5351c[_0x20d9c3(0x1c2)]+'\x22\x20and\x20awaiting\x20result'),_0x2eac7b=await _0x6c3bac[_0x5351c['func']](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x15e)],_0x5351c[_0x20d9c3(0x149)],_0x5351c['ctxPassThrough']);break;case _0x20d9c3(0x1a0):_0x6c3bac[_0x20d9c3(0x16d)]['debug'](_0x1967da+_0x20d9c3(0x1e9)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x13f)),_0x2eac7b=await _0x6c3bac[_0x5351c['func']](_0x5f05b4,_0x5351c['id'],_0x5351c[_0x20d9c3(0x192)]);break;default:_0x2eddee='subscriber\x20message\x20error:\x20handle\x20\x27'+_0x5351c['func']+_0x20d9c3(0x1a5),_0x6c3bac[_0x20d9c3(0x16d)]['error'](_0x1967da+'\x20'+_0x2eddee);throw new Error(_0x2eddee);}if(!_0x2eac7b)_0x2eac7b=null;const _0x32abd1=JSON['stringify'](_0x2eac7b);_0xf36dbf[_0x20d9c3(0x102)](_0x32abd1),_0x6c3bac['logger'][_0x20d9c3(0x17d)](_0x1967da+_0x20d9c3(0x1d2)+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x17f)+(_0x5351c[_0x20d9c3(0x149)]?JSON['stringify'](_0x5351c[_0x20d9c3(0x149)]):'')+_0x20d9c3(0x154)+(_0x5351c['id']?_0x5351c['id']:'')+_0x20d9c3(0xf9)+(_0x5351c[_0x20d9c3(0x165)]?_0x5351c[_0x20d9c3(0x165)]:'')+'\x20message\x20response:\x20'+_0x32abd1+_0x146a38);}catch(_0x1c8c48){const _0x175a1f=_0x20d9c3(0x140)+_0x1c8c48[_0x20d9c3(0x17e)]+'\x22,\x22errName\x22:\x22'+_0x1c8c48['name']+'\x22}';_0xf36dbf[_0x20d9c3(0x102)](_0x175a1f),_0x6c3bac['logger'][_0x20d9c3(0x17d)]((_0x1967da||'')+'\x20message\x20handled:\x20'+_0x5351c[_0x20d9c3(0x1c2)]+_0x20d9c3(0x17f)+(_0x5351c['obj']?JSON[_0x20d9c3(0x197)](_0x5351c[_0x20d9c3(0x149)]):'')+_0x20d9c3(0x154)+(_0x5351c['id']?_0x5351c['id']:'')+_0x20d9c3(0xf9)+(_0x5351c[_0x20d9c3(0x165)]?_0x5351c[_0x20d9c3(0x165)]:'')+_0x20d9c3(0xe6)+_0x175a1f+_0x146a38);}}};if(_0x42cd1c)_0x5dd8c3();else _0xdfe09a();},_0x5232e7=async(_0x4ca753,_0x206473)=>{const _0x17b5d6=_0x576821,_0x4641ed=_0x2106a9[_0x4ca753][_0x17b5d6(0x1cb)]?.[_0x17b5d6(0x16b)]?.[_0x17b5d6(0x12d)];let _0x3cc8cc=0x0;for await(const _0x470d49 of _0x206473['status']()){switch(_0x470d49[_0x17b5d6(0x18a)]){case _0x17b5d6(0x1b7):_0x6c3bac['logger']['error'](_0x6c3bac[_0x17b5d6(0x194)]+'['+_0x6c3bac[_0x17b5d6(0x193)]+']\x20subscriber['+_0x4ca753+']['+_0x4641ed+_0x17b5d6(0x14b)+_0x470d49[_0x17b5d6(0x1c1)]+_0x17b5d6(0x1de)),_0x3cc8cc=0x0;break;case _0x17b5d6(0x1be):_0x6c3bac['logger']['info'](_0x6c3bac['gwName']+'['+_0x6c3bac[_0x17b5d6(0x193)]+_0x17b5d6(0x16a)+_0x4ca753+']['+_0x4641ed+_0x17b5d6(0x184)+_0x470d49[_0x17b5d6(0x1c1)]);break;case _0x17b5d6(0x1c8):_0x6c3bac[_0x17b5d6(0x16d)]['error'](_0x6c3bac[_0x17b5d6(0x194)]+'['+_0x6c3bac['pluginName']+_0x17b5d6(0x16a)+_0x4ca753+']['+_0x4641ed+_0x17b5d6(0x1c0)+_0x470d49[_0x17b5d6(0x1c1)]);break;case _0x17b5d6(0x103):_0x3cc8cc+=0x1;_0x3cc8cc%0x1e===0x0&&_0x6c3bac['logger'][_0x17b5d6(0x129)](_0x6c3bac[_0x17b5d6(0x194)]+'['+_0x6c3bac[_0x17b5d6(0x193)]+_0x17b5d6(0x16a)+_0x4ca753+']['+_0x4641ed+']\x20client\x20is\x20attempting\x20to\x20reconnect\x20'+_0x470d49['data']+'\x20(count='+_0x3cc8cc+')');break;case _0x17b5d6(0x151):_0x6c3bac['logger']['debug'](_0x6c3bac[_0x17b5d6(0x194)]+'['+_0x6c3bac[_0x17b5d6(0x193)]+_0x17b5d6(0x16a)+_0x4ca753+']['+_0x4641ed+_0x17b5d6(0xe9)+_0x470d49[_0x17b5d6(0x1c1)]);break;}}};process['on'](_0x576821(0x105),async()=>{const _0x1bc137=_0x576821;for(const _0x8aca66 in _0x2106a9){_0x2106a9[_0x8aca66]['nc']&&!_0x2106a9[_0x8aca66]['nc'][_0x1bc137(0x15a)]()&&await _0x2106a9[_0x8aca66]['nc']['drain']();}}),process['on'](_0x576821(0x146),async()=>{for(const _0xec8e97 in _0x2106a9){_0x2106a9[_0xec8e97]['nc']&&!_0x2106a9[_0xec8e97]['nc']['isClosed']()&&await _0x2106a9[_0xec8e97]['nc']['drain']();}});const _0x53ada3=async(_0x5f5b0e,_0x580281,_0xed166b)=>{const _0x31ca58=_0x576821,_0x5e5b48={'attribute':_0x580281,'operator':'eq','value':_0xed166b,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0x4f6a70=[_0x580281];if(_0x580281!=='id')_0x4f6a70['push']('id');try{const _0x53cc77=await _0x6c3bac[_0x31ca58(0x10c)](_0x5f5b0e,_0x5e5b48,_0x4f6a70);if(!_0x53cc77||!_0x53cc77['Resources']||!Array['isArray'](_0x53cc77[_0x31ca58(0x127)]))throw new Error('getUsers()\x20getObj='+JSON[_0x31ca58(0x197)](_0x5e5b48)+_0x31ca58(0x1ce));if(_0x53cc77['Resources'][_0x31ca58(0x106)]===0x0)return null;else{if(_0x53cc77[_0x31ca58(0x127)][_0x31ca58(0x106)]>0x2)throw new Error('getUsers()\x20getObj='+JSON['stringify'](_0x5e5b48)+_0x31ca58(0x1bd));else{const _0x3e2914=_0x53cc77[_0x31ca58(0x127)][0x0];if(!_0x3e2914['id'])throw new Error(_0x31ca58(0x1d1)+JSON[_0x31ca58(0x197)](_0x5e5b48)+_0x31ca58(0x19a)+JSON[_0x31ca58(0x197)](_0x3e2914)+_0x31ca58(0xef));return decodeURIComponent(_0x3e2914['id']);}}}catch(_0x3b910f){throw new Error(_0x31ca58(0x1d1)+JSON[_0x31ca58(0x197)](_0x5e5b48)+_0x31ca58(0x130)+_0x3b910f['message']+'}');}},_0x1688ba=_0x15e411=>{const _0x421f81=_0x576821;if(!_0x15e411||typeof _0x15e411!==_0x421f81(0x1b5))return[null,null];_0x15e411=_0x15e411[_0x421f81(0x10b)]();const _0x109335=_0x15e411[_0x421f81(0x122)]('(');if(_0x109335<0x1)return[null,null];if(_0x15e411[_0x421f81(0xf0)](_0x15e411[_0x421f81(0x106)]-0x1)!==')')return[null,null];if(_0x120dce(_0x15e411,'(')!==_0x120dce(_0x15e411,')'))return[null,null];const _0x2a7dd4=_0x15e411[_0x421f81(0xf0)](0x0,_0x109335),_0x5151b9=_0x15e411[_0x421f81(0xf0)](_0x109335+0x1,_0x15e411['length']-0x1);let _0x976cdf=[];const _0x561a0d=_0x5151b9[_0x421f81(0x1c3)](',');let _0x523dac='';for(let _0x2f8eda=0x0;_0x2f8eda<_0x561a0d[_0x421f81(0x106)];_0x2f8eda++){const _0x15f99a=_0x523dac?_0x523dac+','+_0x561a0d[_0x2f8eda]:_0x561a0d[_0x2f8eda],_0x2025de=_0x120dce(_0x15f99a,'('),_0x189285=_0x120dce(_0x15f99a,')');if(_0x2025de===_0x189285)_0x976cdf[_0x421f81(0x1d5)](_0x3ff864(_0x15f99a,'\x22')),_0x523dac='';else{if(_0x523dac)_0x523dac+=','+_0x561a0d[_0x2f8eda];else _0x523dac+=_0x561a0d[_0x2f8eda];}}if(_0x976cdf[_0x421f81(0x106)]===0x0)_0x976cdf=null;return[_0x2a7dd4,_0x976cdf];};function _0x120dce(_0x41fcb1,_0x5cafde){const _0x319cc1=_0x576821;let _0x5662c0=0x0;for(let _0x3a3436=0x0;_0x3a3436<_0x41fcb1[_0x319cc1(0x106)];_0x3a3436++){_0x41fcb1[_0x319cc1(0xfa)](_0x3a3436)===_0x5cafde&&(_0x5662c0+=0x1);}return _0x5662c0;}const _0x3ff864=(_0x1865e4,_0x4975c3)=>{const _0x5edcc7=_0x576821;if(typeof _0x1865e4!==_0x5edcc7(0x1b5)||typeof _0x4975c3!==_0x5edcc7(0x1b5))return _0x1865e4;if(_0x1865e4[_0x5edcc7(0x106)]===0x1)return _0x1865e4;if(_0x4975c3[_0x5edcc7(0x106)]!==0x1)return _0x1865e4;return _0x1865e4=_0x1865e4['trim'](),_0x1865e4['substring'](0x0,0x1)===_0x4975c3&&(_0x1865e4=_0x1865e4[_0x5edcc7(0xf0)](0x1)),_0x1865e4['substring'](_0x1865e4[_0x5edcc7(0x106)]-0x1)===_0x4975c3&&(_0x1865e4=_0x1865e4['substring'](0x0,_0x1865e4[_0x5edcc7(0x106)]-0x1)),_0x1865e4;},_0x2865b8=async(_0x11138d,_0x385a69,_0x2e4f82,_0x2ed6b7)=>{const _0x152a2e=_0x576821;if(!_0x385a69||!_0x2e4f82||!_0x2ed6b7)return null;const [_0x1f905d,_0xd0e325]=_0x1688ba(_0x2ed6b7);if(!_0x1f905d||!_0xd0e325){const _0x2b2585=_0x2ed6b7[_0x152a2e(0x1c3)]('(');if(_0x2b2585[_0x152a2e(0x106)]>0x1){const _0x176e91=[_0x152a2e(0x144),'uppercase','firstn',_0x152a2e(0x126),_0x152a2e(0x11a),_0x152a2e(0x11c),_0x152a2e(0x135),_0x152a2e(0x17c),_0x152a2e(0x1e4)],_0x1192c4=_0x2b2585[0x0][_0x152a2e(0x1e8)]();if(_0x176e91[_0x152a2e(0xf1)](_0x1192c4))return null;}return _0x2ed6b7;}for(let _0x27b3cc=0x0;_0x27b3cc<_0xd0e325[_0x152a2e(0x106)];_0x27b3cc++){if(_0xd0e325[_0x27b3cc][_0x152a2e(0xf0)](0x0,0x1)==='['){const _0x169c07=_0xd0e325[_0x27b3cc][_0x152a2e(0x122)](']');if(_0x169c07<0x0)return null;const _0x5a6ea5=_0xd0e325[_0x27b3cc]['substring'](0x1,_0x169c07),_0x11f5cd=_0x5a6ea5['split']('.');let _0x88f068;for(let _0x19d23d=0x0;_0x19d23d<_0x11f5cd['length'];_0x19d23d++){if(_0x19d23d===0x0)_0x88f068=_0x385a69[_0x11f5cd[_0x19d23d]];else{if(!_0x88f068)return null;_0x88f068=_0x88f068[_0x11f5cd[_0x19d23d]];}}if(!_0x88f068)return null;_0xd0e325[_0x27b3cc]=_0x88f068;}}for(let _0x4b64c2=0x0;_0x4b64c2<_0xd0e325['length'];_0x4b64c2++){const [_0x2ce42b]=_0x1688ba(_0xd0e325[_0x4b64c2]);_0x2ce42b&&(_0xd0e325[_0x4b64c2]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0xd0e325[_0x4b64c2]));}if(_0xd0e325[0x0]===null)return null;switch(_0x1f905d[_0x152a2e(0x1e8)]()){case _0x152a2e(0x144):{if(_0xd0e325[_0x152a2e(0x106)]!==0x1)return null;const [_0x5d5af8]=_0x1688ba(_0xd0e325[0x0]);if(_0x5d5af8)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x5d5af8);if(_0xd0e325[0x0]===null)return null;return _0xd0e325[0x0]['toLowerCase']();}case'uppercase':{if(_0xd0e325[_0x152a2e(0x106)]!==0x1)return null;const [_0x380077]=_0x1688ba(_0xd0e325[0x0]);if(_0x380077)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x380077);if(_0xd0e325[0x0]===null)return null;return _0xd0e325[0x0][_0x152a2e(0x1da)]();}case'firstn':{if(_0xd0e325[_0x152a2e(0x106)]!==0x2)return null;const [_0x1a7fb8]=_0x1688ba(_0xd0e325[0x0]);if(_0x1a7fb8)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x1a7fb8);if(_0xd0e325[0x0]===null)return null;if(isNaN(_0xd0e325[0x1]))return null;return _0xd0e325[0x0][_0x152a2e(0xf0)](0x0,_0xd0e325[0x1]);}case _0x152a2e(0x126):{const [_0x3ae8ec]=_0x1688ba(_0xd0e325[0x0]);if(_0xd0e325['length']<0x2)return null;if(_0x3ae8ec)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x3ae8ec);if(_0xd0e325[0x0]===null)return null;const _0x4a552a=_0xd0e325[0x1];if(isNaN(_0x4a552a))return null;let _0x46f541;if(_0xd0e325[_0x152a2e(0x106)]===0x3)_0x46f541=_0xd0e325[0x0]['split'](_0xd0e325[0x2]);else _0x46f541=_0x46f541=_0xd0e325[0x0][_0x152a2e(0x1c3)]('\x20');if(_0x4a552a<=_0x46f541[_0x152a2e(0x106)])return _0x46f541[_0x4a552a-0x1];else return'';}case _0x152a2e(0x11c):{const [_0x61582e]=_0x1688ba(_0xd0e325[0x0]);if(_0x61582e)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x61582e);if(_0xd0e325[0x0]===null)return null;if(_0xd0e325[_0x152a2e(0x106)]!==0x3)return null;return _0xd0e325[0x0][_0x152a2e(0x182)](_0xd0e325[0x1],_0xd0e325[0x2]);}case _0x152a2e(0x135):{if(_0xd0e325[_0x152a2e(0x106)]!==0x1)return null;const [_0x2f909e]=_0x1688ba(_0xd0e325[0x0]);if(_0x2f909e)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x2f909e);if(_0xd0e325[0x0]===null)return null;return a0_0x15849a[_0x152a2e(0xf6)](_0xd0e325[0x0]);}case _0x152a2e(0x11a):{let _0x322a8a='';for(let _0x376337=0x0;_0x376337<_0xd0e325[_0x152a2e(0x106)];_0x376337++){const [_0x5292ce]=_0x1688ba(_0xd0e325[_0x376337]);if(_0x5292ce)_0xd0e325[_0x376337]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x5292ce);if(_0xd0e325[_0x376337]===null)return null;_0x322a8a+=_0xd0e325[_0x376337];}return _0x322a8a;}case _0x152a2e(0x17c):{if(_0xd0e325['length']>0x2)return null;const [_0x394058]=_0x1688ba(_0xd0e325[0x0]);if(_0x394058)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x394058);if(_0xd0e325[0x0]===null)return null;const _0x3a8f3b=parseInt(_0xd0e325[0x0]);if(isNaN(_0x3a8f3b))return null;let _0x4b829d='##doIncrement';_0x4b829d+=','+_0xd0e325[0x0];if(_0xd0e325['length']===0x2&&_0xd0e325[0x1][_0x152a2e(0x1e8)]()===_0x152a2e(0x14c))_0x4b829d+=_0x152a2e(0x1a4);else _0x4b829d+=_0x152a2e(0x116);return _0x4b829d+='##',_0x4b829d;}case _0x152a2e(0x1e4):{if(_0xd0e325[_0x152a2e(0x106)]!==0x1)return null;const [_0x24c038]=_0x1688ba(_0xd0e325[0x0]);if(_0x24c038)_0xd0e325[0x0]=await _0x2865b8(_0x11138d,_0x385a69,_0x2e4f82,_0x24c038);if(_0xd0e325[0x0]===null)return null;let _0x29c337,_0x44c28d=![],_0x4cbf9a='';const _0x315897=_0xd0e325[0x0]['split']('##');if(_0x315897[_0x152a2e(0x106)]>0x2)for(let _0x5bf13c=0x0;_0x5bf13c<_0x315897['length'];_0x5bf13c++){if(_0x315897[_0x5bf13c][_0x152a2e(0x180)]('doIncrement')){const _0x5b921e=_0x315897[_0x5bf13c][_0x152a2e(0x1c3)](',');if(_0x5b921e[_0x152a2e(0x106)]<0x2)return null;const _0x13ec64=parseInt(_0x5b921e[0x1]);if(isNaN(_0x13ec64))return null;_0x4cbf9a='##'+_0x315897[_0x5bf13c]+'##',_0x29c337=_0x5b921e[0x1],_0x5b921e[_0x152a2e(0x106)]>0x2&&(_0x44c28d=_0x5b921e[0x2][_0x152a2e(0x1e8)]()===_0x152a2e(0x14c));}}let _0x4f37e0,_0x58d535=0x0,_0x2347c3=0x0;if(_0x29c337){_0x2347c3=_0x29c337[_0x152a2e(0x106)],_0x58d535=0xa;for(let _0x2fbf64=0x1;_0x2fbf64<_0x2347c3;_0x2fbf64++){_0x58d535*=0xa;}_0x58d535-=0x1,_0x4f37e0=parseInt(_0x29c337);if(isNaN(_0x4f37e0))return null;_0x4f37e0-=0x1;}else _0x4f37e0=0x0;do{_0x4f37e0+=0x1;let _0x1512d8=_0xd0e325[0x0];if(_0x29c337!==undefined&&_0x4cbf9a){let _0x4cfc5e=_0x4f37e0['toString']();while(_0x4cfc5e[_0x152a2e(0x106)]<_0x2347c3){_0x4cfc5e='0'+_0x4cfc5e;}_0x44c28d?_0x1512d8=_0x1512d8[_0x152a2e(0x11c)](_0x4cbf9a,_0x4cfc5e):(_0x1512d8=_0x1512d8[_0x152a2e(0x11c)](_0x4cbf9a,''),_0x44c28d=!![],_0x4f37e0-=0x1);}try{const _0x17a3d8=await _0x53ada3(_0x11138d,_0x2e4f82,_0x1512d8);if(!_0x17a3d8)return _0x1512d8;}catch(_0x293a6e){return _0x6c3bac[_0x152a2e(0x16d)][_0x152a2e(0x1c8)](_0x6c3bac[_0x152a2e(0x194)]+'['+_0x6c3bac[_0x152a2e(0x193)]+']\x20'+_0x1f905d+_0x152a2e(0x12f)+_0x293a6e[_0x152a2e(0x17e)]),null;}}while(_0x4f37e0<_0x58d535);return null;}default:}return null;},_0x11ce40=async(_0x524b83,_0x46bfe3)=>{const _0x3ae344=_0x576821;for(const _0x22d61c in _0x46bfe3){const _0x27a394=_0x46bfe3[_0x22d61c],[_0x2e80eb,_0x362945]=_0x1688ba(_0x27a394);if(_0x2e80eb){const _0x372e83=''+_0x22d61c,_0x2d5339=_0x2e80eb+'('+_0x362945[_0x3ae344(0x11a)](',')+')',_0x4d6396=await _0x2865b8(_0x524b83,_0x46bfe3,_0x372e83,_0x2d5339);if(_0x4d6396===null)delete _0x46bfe3[_0x22d61c];else _0x46bfe3[_0x22d61c]=_0x4d6396;}for(const _0xec2e5 in _0x27a394){const _0x13d2f0=_0x27a394[_0xec2e5],[_0x1d2305,_0x5eb2ef]=_0x1688ba(_0x13d2f0);if(_0x1d2305){const _0x10e852=_0x22d61c+'.'+_0xec2e5,_0x21c32f=_0x1d2305+'('+_0x5eb2ef[_0x3ae344(0x11a)](',')+')',_0x29749b=await _0x2865b8(_0x524b83,_0x46bfe3,_0x10e852,_0x21c32f);if(_0x29749b===null)delete _0x27a394[_0xec2e5];else _0x27a394[_0xec2e5]=_0x29749b;}}}return _0x46bfe3;};}}function a0_0xb16d(_0x207a7c,_0x13d1c0){const _0x4ebe68=a0_0x4ebe();return a0_0xb16d=function(_0xb16d14,_0x56d99e){_0xb16d14=_0xb16d14-0xe2;let _0x2555ee=_0x4ebe68[_0xb16d14];return _0x2555ee;},a0_0xb16d(_0x207a7c,_0x13d1c0);}export class Publisher{constructor(_0x37c773){const _0x2b202e=a0_0xb16d,_0x2a6e0f=_0x37c773,_0x3e6888={},_0x305537=async(_0x357da7,_0x2043ca)=>{const _0x4e7c19=a0_0xb16d,_0x5074ad=_0x3e6888[_0x357da7][_0x4e7c19(0x1cb)]?.[_0x4e7c19(0x16b)]?.[_0x4e7c19(0x12d)];let _0x137331=0x0;for await(const _0x2340c8 of _0x2043ca[_0x4e7c19(0x13c)]()){switch(_0x2340c8['type']){case _0x4e7c19(0x1b7):_0x2a6e0f[_0x4e7c19(0x16d)][_0x4e7c19(0x1c8)](_0x2a6e0f[_0x4e7c19(0x194)]+'['+_0x2a6e0f['pluginName']+_0x4e7c19(0x1d0)+_0x357da7+']['+_0x5074ad+']\x20client\x20disconnected\x20'+_0x2340c8[_0x4e7c19(0x1c1)]+_0x4e7c19(0x1de)),_0x137331=0x0;break;case _0x4e7c19(0x1be):_0x2a6e0f[_0x4e7c19(0x16d)][_0x4e7c19(0x17d)](_0x2a6e0f[_0x4e7c19(0x194)]+'['+_0x2a6e0f[_0x4e7c19(0x193)]+']\x20publisher['+_0x357da7+']['+_0x5074ad+_0x4e7c19(0x184)+_0x2340c8[_0x4e7c19(0x1c1)]);break;case _0x4e7c19(0x1c8):_0x2a6e0f[_0x4e7c19(0x16d)]['error'](_0x2a6e0f[_0x4e7c19(0x194)]+'['+_0x2a6e0f[_0x4e7c19(0x193)]+']\x20publisher['+_0x357da7+']['+_0x5074ad+_0x4e7c19(0x1c0)+_0x2340c8[_0x4e7c19(0x1c1)]);break;case _0x4e7c19(0x103):_0x137331+=0x1;_0x137331%0x1e===0x0&&_0x2a6e0f[_0x4e7c19(0x16d)][_0x4e7c19(0x129)](_0x2a6e0f['gwName']+'['+_0x2a6e0f[_0x4e7c19(0x193)]+_0x4e7c19(0x1d0)+_0x357da7+']['+_0x5074ad+_0x4e7c19(0x1bc)+_0x2340c8['data']+_0x4e7c19(0x186)+_0x137331+')');break;case'staleConnection':_0x2a6e0f[_0x4e7c19(0x16d)]['debug'](_0x2a6e0f[_0x4e7c19(0x194)]+'['+_0x2a6e0f[_0x4e7c19(0x193)]+_0x4e7c19(0x1d0)+_0x357da7+']['+_0x5074ad+_0x4e7c19(0xe9)+_0x2340c8[_0x4e7c19(0x1c1)]);break;}}},_0x330396=async(_0x34a171,_0x134916)=>{const _0xfd622d=a0_0xb16d,_0x1e247a=_0x3e6888[_0x34a171][_0xfd622d(0x1cb)]?.[_0xfd622d(0x16b)]?.[_0xfd622d(0x12d)];let _0x2d02ee;try{_0x2d02ee=await a0_0x1eb4cc(_0x134916);if(_0x2d02ee[_0xfd622d(0x17d)][_0xfd622d(0x1c5)]!==_0xfd622d(0x1ba)){_0x2d02ee[_0xfd622d(0x1d3)]();return;}_0x3e6888[_0x34a171]['nc']=_0x2d02ee,_0x305537(_0x34a171,_0x2d02ee);}catch(_0x177d35){_0x2a6e0f[_0xfd622d(0x16d)][_0xfd622d(0x1c8)](_0x2a6e0f['gwName']+'['+_0x2a6e0f[_0xfd622d(0x193)]+_0xfd622d(0x1d0)+_0x34a171+']['+_0x1e247a+_0xfd622d(0xe2)+_0x177d35[_0xfd622d(0x17e)]+_0xfd622d(0x1dc)),_0x134916[_0xfd622d(0x1d6)]=!![];try{_0x2d02ee=await a0_0x1eb4cc(_0x134916);if(_0x2d02ee[_0xfd622d(0x17d)]['server_name']!==_0xfd622d(0x1ba)){_0x2d02ee[_0xfd622d(0x1d3)]();return;}_0x3e6888[_0x34a171]['nc']=_0x2d02ee,_0x305537(_0x34a171,_0x2d02ee);}catch(_0x3206c5){_0x2a6e0f[_0xfd622d(0x16d)]['error'](_0x2a6e0f[_0xfd622d(0x194)]+'['+_0x2a6e0f[_0xfd622d(0x193)]+_0xfd622d(0x1d0)+_0x34a171+']['+_0x1e247a+_0xfd622d(0xe2)+_0x3206c5['message']);return;}}_0x2a6e0f['logger'][_0xfd622d(0x129)](_0x2a6e0f[_0xfd622d(0x194)]+'['+_0x2a6e0f[_0xfd622d(0x193)]+']\x20publisher['+_0x34a171+']['+_0x1e247a+']\x20connected\x20'+(_0x134916[_0xfd622d(0x1e0)]['ca']?'tls':'')+'\x20'+_0x2d02ee['getServer']()),_0x2d02ee[_0xfd622d(0x1a7)]()[_0xfd622d(0x110)](_0x13a29d=>{const _0x35c46a=_0xfd622d;_0x13a29d&&_0x2a6e0f[_0x35c46a(0x16d)]['error'](_0x2a6e0f[_0x35c46a(0x194)]+'['+_0x2a6e0f[_0x35c46a(0x193)]+_0x35c46a(0x1d0)+_0x34a171+']['+_0x1e247a+_0x35c46a(0x170)+_0x13a29d[_0x35c46a(0x17e)]);});};this[_0x2b202e(0x1a9)]=async(_0x6d4e4b,_0x5620cc)=>{const _0x36eb5b=_0x2b202e;if(!_0x5620cc?.[_0x36eb5b(0x16b)]){_0x2a6e0f['logger'][_0x36eb5b(0x1c8)](_0x2a6e0f['gwName']+'['+_0x2a6e0f[_0x36eb5b(0x193)]+']\x20publisher['+_0x6d4e4b+_0x36eb5b(0x195));return;}if(!_0x5620cc?.[_0x36eb5b(0x16b)]?.[_0x36eb5b(0x109)]){_0x2a6e0f[_0x36eb5b(0x16d)][_0x36eb5b(0x1c8)](_0x2a6e0f['gwName']+'['+_0x2a6e0f[_0x36eb5b(0x193)]+_0x36eb5b(0x1d0)+_0x6d4e4b+_0x36eb5b(0x1aa));return;}if(!_0x5620cc?.[_0x36eb5b(0x16b)]?.[_0x36eb5b(0x12d)]){_0x2a6e0f['logger'][_0x36eb5b(0x1c8)](_0x2a6e0f[_0x36eb5b(0x194)]+'['+_0x2a6e0f[_0x36eb5b(0x193)]+_0x36eb5b(0x1d0)+_0x6d4e4b+']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject');return;}if(!_0x5620cc?.[_0x36eb5b(0x16b)]?.[_0x36eb5b(0x12d)][_0x36eb5b(0x180)](_0x36eb5b(0x14d))){_0x2a6e0f[_0x36eb5b(0x16d)][_0x36eb5b(0x1c8)](_0x2a6e0f['gwName']+'['+_0x2a6e0f[_0x36eb5b(0x193)]+_0x36eb5b(0x1d0)+_0x6d4e4b+_0x36eb5b(0x14e));return;}if(!_0x5620cc[_0x36eb5b(0x128)]||!Array['isArray'](_0x5620cc[_0x36eb5b(0x128)])||_0x5620cc[_0x36eb5b(0x128)]['length']<0x1){_0x2a6e0f[_0x36eb5b(0x16d)][_0x36eb5b(0x1c8)](_0x2a6e0f[_0x36eb5b(0x194)]+'['+_0x2a6e0f['pluginName']+_0x36eb5b(0x1d0)+_0x6d4e4b+_0x36eb5b(0x1e3));return;}if(!_0x5620cc?.['certificate']?.['ca']){_0x2a6e0f[_0x36eb5b(0x16d)][_0x36eb5b(0x1c8)](_0x2a6e0f['gwName']+'['+_0x2a6e0f[_0x36eb5b(0x193)]+_0x36eb5b(0x1d0)+_0x6d4e4b+_0x36eb5b(0x1cf));return;}const _0x2a4cf7={};try{let _0x154206=a0_0x31a0e9['join'](_0x2a6e0f['configDir'],_0x36eb5b(0x1e1),_0x5620cc?.['certificate']?.['ca']||_0x36eb5b(0xe5));(_0x5620cc?.[_0x36eb5b(0x173)]?.['ca']?.['startsWith']('/')||_0x5620cc?.['certificate']?.['ca']?.[_0x36eb5b(0xf1)]('\x5c'))&&(_0x154206=_0x5620cc[_0x36eb5b(0x173)]['ca']),_0x2a4cf7['ca']=[a0_0x5517ab[_0x36eb5b(0x10a)](_0x154206)],_0x2a4cf7[_0x36eb5b(0x1ca)]=!![];}catch(_0x307d4e){_0x2a6e0f['logger'][_0x36eb5b(0x1c8)](_0x2a6e0f[_0x36eb5b(0x194)]+'['+_0x2a6e0f[_0x36eb5b(0x193)]+_0x36eb5b(0x1d0)+_0x6d4e4b+_0x36eb5b(0x196)+_0x307d4e[_0x36eb5b(0x17e)]);return;}const _0xae1db2={},_0x509c6d=new TextEncoder()[_0x36eb5b(0x171)](_0x5620cc?.[_0x36eb5b(0x16b)]?.[_0x36eb5b(0x1d9)]),_0x5b7d3d=_0x5620cc?.[_0x36eb5b(0x16b)]?.[_0x36eb5b(0x114)];_0xae1db2['authenticator']=jwtAuthenticator(_0x5b7d3d,_0x509c6d),_0xae1db2['servers']=_0x5620cc[_0x36eb5b(0x128)],_0xae1db2[_0x36eb5b(0x1e0)]=_0x2a4cf7,_0xae1db2[_0x36eb5b(0x1d6)]=![],_0xae1db2[_0x36eb5b(0x1be)]=!![],_0xae1db2[_0x36eb5b(0x1e5)]=0x3e8*0xa,_0xae1db2[_0x36eb5b(0x1b3)]=-0x1,_0xae1db2[_0x36eb5b(0x176)]=0x2*0x3c*0x3e8,_0xae1db2[_0x36eb5b(0x179)]=0x5,_0xae1db2[_0x36eb5b(0x129)]=![],_0x3e6888[_0x6d4e4b]={},_0x3e6888[_0x6d4e4b]['config']=_0x5620cc,_0x3e6888[_0x6d4e4b]['nc']=undefined,_0x330396(_0x6d4e4b,_0xae1db2);},this[_0x2b202e(0x1b4)]=async _0x2ab967=>{const _0x487da8=_0x2b202e;let _0x494527;try{if(_0x2ab967[_0x487da8(0x147)]===Object){_0x494527=_0x2ab967[_0x487da8(0x174)];if(!_0x494527)_0x2ab967[_0x487da8(0x174)]=_0x487da8(0xfc);_0x2ab967=JSON['stringify'](_0x2ab967);}else{const _0x4a646f=JSON[_0x487da8(0x108)](_0x2ab967);_0x494527=_0x4a646f[_0x487da8(0x174)];}}catch(_0x37b689){throw new Error(_0x487da8(0xeb)+_0x494527+_0x487da8(0x10e));}if(!_0x3e6888[_0x494527])throw new Error(_0x487da8(0xeb)+_0x494527+_0x487da8(0x12a)+_0x494527);const _0x83ed7a=headers();_0x83ed7a[_0x487da8(0x1bb)](_0x487da8(0x159),a0_0xf9b720['randomUUID']());let _0x3ef29a;try{if(!_0x3e6888[_0x494527]['nc'])throw new Error(_0x487da8(0x15c));_0x3ef29a=await _0x3e6888[_0x494527]['nc'][_0x487da8(0x185)](_0x3e6888[_0x494527][_0x487da8(0x1cb)]?.[_0x487da8(0x16b)]?.['subject'],_0x2ab967,{'headers':_0x83ed7a});}catch(_0x5aeece){if(_0x5aeece['message']===_0x487da8(0x18c))throw new Error(_0x487da8(0xeb)+_0x494527+_0x487da8(0x138)+_0x3e6888[_0x494527][_0x487da8(0x1cb)]?.[_0x487da8(0x16b)]?.[_0x487da8(0x12d)]);else throw new Error(_0x487da8(0xeb)+_0x494527+_0x487da8(0x12b)+_0x5aeece['message']);}let _0x36f94b;try{_0x36f94b=JSON['parse'](_0x3ef29a[_0x487da8(0x1b5)]());}catch(_0x1de63d){throw new Error(_0x487da8(0xec)+_0x3ef29a[_0x487da8(0x1b5)]());}if(_0x36f94b?.[_0x487da8(0x1c8)]){const _0xbc1f36=new Error(_0x487da8(0x10f)+_0x36f94b[_0x487da8(0x1c8)]);_0xbc1f36[_0x487da8(0x1a2)]=_0x36f94b['errName'];throw _0xbc1f36;}return _0x36f94b;},process['on'](_0x2b202e(0x105),async()=>{const _0x4a813d=_0x2b202e;for(const _0x5dfdf7 in _0x3e6888){_0x3e6888[_0x5dfdf7]['nc']&&!_0x3e6888[_0x5dfdf7]['nc']['isClosed']()&&await _0x3e6888[_0x5dfdf7]['nc'][_0x4a813d(0x134)]();}}),process['on'](_0x2b202e(0x146),async()=>{const _0x19bd8f=_0x2b202e;for(const _0x35271a in _0x3e6888){_0x3e6888[_0x35271a]['nc']&&!_0x3e6888[_0x35271a]['nc'][_0x19bd8f(0x15a)]()&&await _0x3e6888[_0x35271a]['nc']['drain']();}});}}export const getAppRoles=async(_0xf04722,_0x561713)=>{const _0x5b993d=a0_0xb16d,_0x192e78=_0x5b993d(0x1ac),_0x20e2aa=_0xf04722;_0x20e2aa[_0x5b993d(0x16d)][_0x5b993d(0x129)](_0x20e2aa[_0x5b993d(0x194)]+'['+_0x20e2aa[_0x5b993d(0x193)]+_0x5b993d(0x14a)+_0x192e78+'\x22');try{if(!a0_0x5517ab['existsSync'](_0x20e2aa[_0x5b993d(0x19e)]+'/approles'))a0_0x5517ab[_0x5b993d(0x104)](_0x20e2aa[_0x5b993d(0x19e)]+_0x5b993d(0x18b));}catch(_0x3b8198){void 0x0;}const _0x1cb423=a0_0x31a0e9[_0x5b993d(0x11a)](''+_0x20e2aa['configDir'],_0x5b993d(0x12e),'approles_'+_0x20e2aa[_0x5b993d(0x193)]+_0x5b993d(0x100)),_0x101a6c={};a0_0x2da0c2['fsExistsSync'](_0x1cb423)&&a0_0x5517ab[_0x5b993d(0x10a)](_0x1cb423,_0x5b993d(0xee))[_0x5b993d(0x1c3)](/\r?\n/)[_0x5b993d(0x136)](_0x5327ce=>{const _0x16423a=_0x5b993d,_0x72ef1d=_0x5327ce[_0x16423a(0x1c3)]('\x20');_0x72ef1d['length']===0x2&&(_0x101a6c[_0x72ef1d[0x0]]=_0x72ef1d[0x1]);});const _0x4e5606=a0_0x5517ab[_0x5b993d(0xfd)](_0x1cb423,{'flags':'w','encoding':_0x5b993d(0x120),'mode':0x1b6,'autoClose':!![]}),_0x537233=[],_0x3ccbb9=await _0x20e2aa[_0x5b993d(0x143)](_0x561713,{'attribute':undefined,'operator':undefined,'value':undefined},['id',_0x5b993d(0x1b9)]);return _0x3ccbb9[_0x5b993d(0x127)][_0x5b993d(0x136)](_0x31e6c1=>{const _0xa0cd82=_0x5b993d;if(_0x31e6c1['id']){let _0x574da8=a0_0xf9b720[_0xa0cd82(0x142)]();if(_0x101a6c[_0x31e6c1['id']])_0x574da8=_0x101a6c[_0x31e6c1['id']];const _0x1f73fd={'allowedMemberTypes':[_0xa0cd82(0xff)],'description':_0xa0cd82(0x19b),'displayName':_0x31e6c1[_0xa0cd82(0x1b9)]||_0x31e6c1['id'],'id':_0x574da8,'isEnabled':!![],'lang':null,'origin':'Application','value':decodeURIComponent(_0x31e6c1['id'])};_0x537233[_0xa0cd82(0x1d5)](_0x1f73fd),_0x4e5606[_0xa0cd82(0x137)](_0x31e6c1['id']+'\x20'+_0x574da8+'\x0a');}}),_0x4e5606['close'](),_0x20e2aa[_0x5b993d(0x16d)][_0x5b993d(0x129)](_0x20e2aa[_0x5b993d(0x194)]+'['+_0x20e2aa[_0x5b993d(0x193)]+']\x20approle\x20uuid\x20file\x20created:\x20'+_0x1cb423),{'Resources':[{'appRoles':_0x537233}]};};