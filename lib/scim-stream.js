// ================================================================
// File:    scim-stream.js
//
// Author:  Jarle Elshaug
//
// Purpose: SCIM Stream message subscription and automated provisioning
//          Gateway publishing to SCIM Stream having other gateways as subscribers handling requests
//          getApproles() for exporting all groups into Entra ID AppRole manifest-format
//
// Note: scim-stream.js is part of the licensed SCIM Stream which is a prerequisite for message Pub/Sub
//       for details see: https://elshaug.xyz/docs/scim-stream
//
// ================================================================
'use strict';(function(_0xfaabdb,_0x4af979){const _0xb3b178=a0_0xe6f9,_0x4a84c5=_0xfaabdb();while(!![]){try{const _0x45bc59=parseInt(_0xb3b178(0x179))/0x1*(-parseInt(_0xb3b178(0xd7))/0x2)+-parseInt(_0xb3b178(0x189))/0x3+parseInt(_0xb3b178(0x1a3))/0x4*(parseInt(_0xb3b178(0x133))/0x5)+parseInt(_0xb3b178(0x1bd))/0x6*(parseInt(_0xb3b178(0x104))/0x7)+parseInt(_0xb3b178(0x19c))/0x8*(-parseInt(_0xb3b178(0x177))/0x9)+parseInt(_0xb3b178(0xd5))/0xa*(-parseInt(_0xb3b178(0x154))/0xb)+parseInt(_0xb3b178(0x17c))/0xc;if(_0x45bc59===_0x4af979)break;else _0x4a84c5['push'](_0x4a84c5['shift']());}catch(_0x87397d){_0x4a84c5['push'](_0x4a84c5['shift']());}}}(a0_0x3711,0x583e9));function a0_0x3711(){const _0x167e38=['ConsumerNotFound','Application','ConsumerEvents','length','foldReplacing','publisher\x20not\x20initialized/connected','value','deliver_policy','consumers','pluginName','onCreate','330PbBUWv','\x20Create\x20userName=','certificate',',\x20attributes=','parse','transports','config','configDir','false','allSettled','baseUrls','firstn','status','server_name','getGroups','gwName','apply','internal\x20stream\x20policy\x20have\x20been\x20changed\x20-\x20central\x20SCIM\x20Stream\x20must\x20be\x20stopped\x20and\x20corresponding\x20./jetstream\x20folder\x20deleted\x20before\x20startup\x20allowing\x20new\x20policy','attribute','\x20-\x20will\x20do\x20auto\x20reconnect\x20when\x20connection\x20becomes\x20available',']\x20client\x20is\x20attempting\x20to\x20reconnect\x20','\x20message:\x20user\x20not\x20created\x20because\x20of\x20active=false','\x20group\x20removal\x20error:\x20','from','\x20message\x20response:\x20','rejected','\x20done','Resources','All','toUpperCase','jwt','append','createGroup','nats','name','221652yHVewl','\x20-\x20','1XXWFpM','ENOTFOUND','passThrough','3332592kBhGso','operation','getMemberOf','modifyUser','prototype','approles','\x20role\x20removal\x20error:\x20','stringify','delete','headers','data','call','randomUUID','954585yjlphY','waitOnFirstConnect','forEach','/certs/','createWriteStream','path','\x20createUser()\x20obj=','fsExistsSync','getuniquevalue',',\x20id=','DeliverPolicy','startsWith','tls','utf8','uppercase','getUsers',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.subject','info','copyObj','16HXgGpd','\x27\x20not\x20supported','servers','_info','charAt','DebugEvents','obj','2842124YeoZpL','push','replaceAll','handle','Operations','jetstreamManager','\x20not\x20equal\x20subscriber\x20configured\x20baseEntity=',',false',']\x20client\x20error\x20','update','modifyOnly','tenant','usePutSoftSync','subscriber\x20message\x20error:\x20message\x20baseEntity=','Reconnect','modifyGroup','Events','file-not-configured','utf-8','debug','type','connect',']\x20client\x20disconnected\x20',']\x20connected\x20','StaleConnection',']\x20error:\x20missing\x20entity\x20configuration\x20for\x20baseEntity=','6SaSiOJ','query','generateUserPassword','Msg-Id','SCIM\x20Stream',']\x20subscriber[',',true','GW.','readFileSync','\x20message:\x20user\x20not\x20created\x20because\x20of\x20configuration\x20modifyOnly=true','activityOperation','jetstream','\x20calling\x20\x22','mkdirSync','isArray','filter_subject','map','encode','deleteUserOnLastGroupRoleRemoval','\x22\x20with\x20chunks\x20and\x20awaiting\x20result','UnableConnectingHost','splice','{\x22error\x22:\x22','caller','publisher\x20response\x20error:\x20','\x20or\x20',']\x20publisher[','\x20Replace\x20User\x20id=','ack',']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant','\x20message\x20handled:\x20','\x22,\x22errName\x22:\x22','SIGTERM','split','hasOwnProperty','\x20Delete\x20User\x20id=','181360wKQdkg','pingInterval','489434YJPhrF','putApi','level','subscriber\x20message\x20error:\x20message\x20missing\x20method',']\x20error:\x20client\x20have\x20not\x20been\x20initialized','baseEntity','\x20(count=','errName','active','\x20error:\x20','file','sub','undefined','message','\x20missing\x20mandatory\x20user.userName\x20in\x20message:\x20','subject','\x20Delete\x20User\x20userName=','lowercase','closed','\x20processing\x20incoming\x20message','postApi','secret','roles','createUser','toString','then','join','userName','\x20message:\x20user\x20does\x20not\x20exist',']\x20connect\x20error:\x20','patchApi','replaceUsrGrp','indexOf','\x20with\x20chunks\x20returned\x20errors:\x20','maxReconnectAttempts','Explicit','includes','503','jwtAuthenticator','createRandomPassword','func','getAppRoles','attributes','close','getApi','3706150SFJVzz',']\x20initialization\x20error:\x20nats.subject\x20root\x20topic\x20must\x20be\x20\x27GW\x27,\x20nats.subject\x20example:\x20GW.APP1','getServer','Reconnecting','\x20getUserId()\x20error:\x20','replace','\x20handling\x20message:\x20','\x20roles\x20converted\x20to\x20groups:\x20','increment','respond','rawFilter','drain','getUsers()\x20getObj=','Disconnect','replaceDomains','/approles','trim','publisher\x20error:\x20none\x20JSON\x20formatted\x20response:\x20','toLowerCase','maxPingOut','HR.','approles_','ctxPassThrough','SIGINT','getProcessed','all','reason','deleteUser','User','StringCodec',']\x20closed\x20with\x20error:\x20','timeout',']\x20initialization\x20error:\x20missing\x20configuration\x20stream.baseUrls','logger',']\x20initialization\x20error:\x20missing\x20certificate\x20configuration','\x22\x20and\x20awaiting\x20result','string','groups','reconnectTimeWait','publisher[','error',']\x20client\x20reconnected\x20','isClosed','AckPolicy','\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration','existsSync','typeId','5DSYPBs','endsWith',']\x20error:\x20message\x20must\x20be\x20JSON\x20formatted','filter','deleteApi','convertedScim20',',\x20obj=','\x20missing\x20user\x20object\x20in\x20message:\x20','reconnect','subscribe',']\x20initialization\x20error:\x20missing\x20configuration\x20nats','add','remove','##doIncrement',']\x20error:\x20no\x20subscribers/responders\x20to\x20subject\x20','operator','get','true','decode','Users','substring','\x20=>\x20subscriber\x20not\x20activated'];a0_0x3711=function(){return _0x167e38;};return a0_0x3711();}import a0_0x1f12d0 from'nats';import a0_0x7d5195 from'fold-to-ascii';import a0_0x804e61 from'node:fs';function a0_0xe6f9(_0x1afc6f,_0x43fb34){const _0x371179=a0_0x3711();return a0_0xe6f9=function(_0xe6f917,_0x4ac354){_0xe6f917=_0xe6f917-0xd3;let _0x546687=_0x371179[_0xe6f917];return _0x546687;},a0_0xe6f9(_0x1afc6f,_0x43fb34);}import a0_0x24d390 from'node:path';import a0_0xd1e96 from'crypto';import*as a0_0x3bafd7 from'./utils.ts';import*as a0_0x690914 from'./utils-scim.ts';export class Subscriber{constructor(_0x680bee){const _0x438835=a0_0xe6f9,_0x5cd7a3=_0x680bee,_0x870e65={};let _0x332977='';for(let _0x19afcd=0x0;_0x19afcd<_0x5cd7a3['logger']['transports'][_0x438835(0x14c)];_0x19afcd++){if(_0x5cd7a3[_0x438835(0x125)][_0x438835(0x159)][_0x19afcd][_0x438835(0x176)]===_0x438835(0xe1)){_0x332977=_0x5cd7a3[_0x438835(0x125)]['transports'][_0x19afcd][_0x438835(0xd9)];break;}}const _0x5bffdc=''+(_0x332977===_0x438835(0x1b6)?'\x0a':''),_0xbf2e38=async(_0x4b491c,_0x15c95e)=>{const _0x440c35=_0x438835,_0x16613d=_0x870e65[_0x4b491c][_0x440c35(0x15a)]?.[_0x440c35(0x175)]?.[_0x440c35(0xe6)];let _0x567ff;try{_0x567ff=await a0_0x1f12d0['connect'](_0x15c95e);if(_0x567ff['info'][_0x440c35(0x161)]!==_0x440c35(0x1c1)){_0x567ff[_0x440c35(0x102)]();return;}_0x870e65[_0x4b491c]['nc']=_0x567ff,_0x2667e9(_0x4b491c,_0x567ff),_0x5508c0(_0x4b491c,_0x567ff);}catch(_0x13e52b){_0x5cd7a3[_0x440c35(0x125)][_0x440c35(0x12c)](_0x5cd7a3[_0x440c35(0x163)]+'['+_0x5cd7a3[_0x440c35(0x152)]+']\x20subscriber['+_0x4b491c+']['+_0x16613d+_0x440c35(0xf4)+_0x13e52b['message']+_0x440c35(0x130)),_0x15c95e['waitOnFirstConnect']=!![];try{_0x567ff=await a0_0x1f12d0[_0x440c35(0x1b8)](_0x15c95e);if(_0x567ff[_0x440c35(0x19a)][_0x440c35(0x161)]!==_0x440c35(0x1c1)){_0x567ff[_0x440c35(0x102)]();return;}_0x870e65[_0x4b491c]['nc']=_0x567ff,_0x2667e9(_0x4b491c,_0x567ff),_0x5508c0(_0x4b491c,_0x567ff);}catch(_0xbc5adc){_0x5cd7a3[_0x440c35(0x125)][_0x440c35(0x12c)](_0x5cd7a3[_0x440c35(0x163)]+'['+_0x5cd7a3['pluginName']+_0x440c35(0x1c2)+_0x4b491c+']['+_0x16613d+']\x20connect\x20error:\x20'+_0xbc5adc['message']);return;}}_0x5cd7a3['logger'][_0x440c35(0x1b6)](_0x5cd7a3[_0x440c35(0x163)]+'['+_0x5cd7a3[_0x440c35(0x152)]+_0x440c35(0x1c2)+_0x4b491c+']['+_0x16613d+_0x440c35(0x1ba)+(_0x15c95e['tls']['ca']?'tls':'')+'\x20'+_0x567ff[_0x440c35(0x106)]()),_0x567ff['closed']()[_0x440c35(0xf0)](_0x5d6677=>{const _0x30733c=_0x440c35;_0x5d6677&&_0x5cd7a3[_0x30733c(0x125)][_0x30733c(0x12c)](_0x5cd7a3[_0x30733c(0x163)]+'['+_0x5cd7a3[_0x30733c(0x152)]+']\x20subscriber['+_0x4b491c+']['+_0x16613d+_0x30733c(0x122)+_0x5d6677[_0x30733c(0xe4)]);});};this[_0x438835(0x13e)]=async(_0x4a9018,_0x1d620e)=>{const _0x1e041e=_0x438835;if(!_0x1d620e?.[_0x1e041e(0x175)]){_0x5cd7a3['logger'][_0x1e041e(0x12c)](_0x5cd7a3[_0x1e041e(0x163)]+'['+_0x5cd7a3['pluginName']+']\x20subscriber['+_0x4a9018+_0x1e041e(0x13d));return;}if(!_0x1d620e?.[_0x1e041e(0x175)]?.[_0x1e041e(0x1ae)]){_0x5cd7a3['logger']['error'](_0x5cd7a3[_0x1e041e(0x163)]+'['+_0x5cd7a3[_0x1e041e(0x152)]+_0x1e041e(0x1c2)+_0x4a9018+']\x20initialization\x20error:\x20missing\x20configuration\x20nats.tenant');return;}if(!_0x1d620e?.[_0x1e041e(0x175)]?.[_0x1e041e(0xe6)]){_0x5cd7a3[_0x1e041e(0x125)][_0x1e041e(0x12c)](_0x5cd7a3['gwName']+'['+_0x5cd7a3['pluginName']+_0x1e041e(0x1c2)+_0x4a9018+_0x1e041e(0x199));return;}if(!_0x1d620e?.[_0x1e041e(0x156)]?.['ca']){_0x5cd7a3[_0x1e041e(0x125)][_0x1e041e(0x12c)](_0x5cd7a3[_0x1e041e(0x163)]+'['+_0x5cd7a3[_0x1e041e(0x152)]+_0x1e041e(0x1c2)+_0x4a9018+_0x1e041e(0x126));return;}if(!_0x1d620e[_0x1e041e(0x15e)]||!Array[_0x1e041e(0x1cb)](_0x1d620e[_0x1e041e(0x15e)])||_0x1d620e[_0x1e041e(0x15e)][_0x1e041e(0x14c)]<0x1){_0x5cd7a3[_0x1e041e(0x125)][_0x1e041e(0x12c)](_0x5cd7a3['gwName']+'['+_0x5cd7a3['pluginName']+_0x1e041e(0x1c2)+_0x4a9018+_0x1e041e(0x124));return;}if(!_0x1d620e[_0x1e041e(0x1af)]){const _0x4e513a=_0x1d620e?.[_0x1e041e(0x175)]?.[_0x1e041e(0xe6)][_0x1e041e(0x171)]();if(_0x4e513a[_0x1e041e(0x194)](_0x1e041e(0x118)))_0x1d620e[_0x1e041e(0x1af)]=!![];}const _0x362c80={};try{let _0x19ec3b=a0_0x24d390[_0x1e041e(0xf1)](_0x5cd7a3[_0x1e041e(0x15b)],_0x1e041e(0x18c),_0x1d620e?.[_0x1e041e(0x156)]?.['ca']||'file-not-configured');(_0x1d620e?.['certificate']?.['ca']?.[_0x1e041e(0x194)]('/')||_0x1d620e?.[_0x1e041e(0x156)]?.['ca']?.['includes']('\x5c'))&&(_0x19ec3b=_0x1d620e['certificate']['ca']),_0x362c80['ca']=[a0_0x804e61[_0x1e041e(0x1c5)](_0x19ec3b)],_0x362c80['rejectUnauthorized']=!![];}catch(_0x4daf5b){_0x5cd7a3[_0x1e041e(0x125)]['error'](_0x5cd7a3['gwName']+'['+_0x5cd7a3[_0x1e041e(0x152)]+_0x1e041e(0x1c2)+_0x4a9018+']\x20initialization\x20certificate\x20error:\x20'+_0x4daf5b[_0x1e041e(0xe4)]);return;}const _0x1061bd={},_0x315a37=new TextEncoder()[_0x1e041e(0x1ce)](_0x1d620e?.[_0x1e041e(0x175)]?.[_0x1e041e(0xec)]),_0x43bcc3=_0x1d620e?.['nats']?.[_0x1e041e(0x172)];_0x1061bd['authenticator']=a0_0x1f12d0[_0x1e041e(0xfd)](_0x43bcc3,_0x315a37),_0x1061bd[_0x1e041e(0x19e)]=_0x1d620e[_0x1e041e(0x15e)],_0x1061bd[_0x1e041e(0x195)]=_0x362c80,_0x1061bd[_0x1e041e(0x18a)]=![],_0x1061bd[_0x1e041e(0x13b)]=!![],_0x1061bd[_0x1e041e(0x12a)]=0x3e8*0xa,_0x1061bd[_0x1e041e(0xf9)]=-0x1,_0x1061bd[_0x1e041e(0xd6)]=0x2*0x3c*0x3e8,_0x1061bd[_0x1e041e(0x117)]=0x5,_0x1061bd[_0x1e041e(0x1b6)]=![],_0x870e65[_0x4a9018]={},_0x870e65[_0x4a9018][_0x1e041e(0x15a)]=_0x1d620e,_0x870e65[_0x4a9018]['nc']=undefined,_0x870e65[_0x4a9018][_0x1e041e(0xe2)]=undefined,_0xbf2e38(_0x4a9018,_0x1061bd);};const _0x5508c0=async(_0x46ea9e,_0x1c6193)=>{const _0x281443=_0x438835,_0x30ffff=_0x870e65[_0x46ea9e][_0x281443(0x15a)],_0x1d6ade=_0x30ffff?.[_0x281443(0x175)]?.[_0x281443(0xe6)];if(!_0x1c6193){_0x5cd7a3[_0x281443(0x125)][_0x281443(0x12c)](_0x5cd7a3[_0x281443(0x163)]+'['+_0x5cd7a3[_0x281443(0x152)]+_0x281443(0x1c2)+_0x46ea9e+']['+_0x1d6ade+_0x281443(0xdb));return;}const _0x2ea960=async(_0x5a81c0,_0x133c8e)=>{const _0x7ae8bc=_0x281443;try{_0x5cd7a3['logger'][_0x7ae8bc(0x19a)](_0x5a81c0+_0x7ae8bc(0x10a)+_0x133c8e);let _0x494456;try{if(_0x30ffff[_0x7ae8bc(0x112)]&&Array['isArray'](_0x30ffff['replaceDomains']))for(let _0x23a177=0x0;_0x23a177<_0x30ffff[_0x7ae8bc(0x112)][_0x7ae8bc(0x14c)];_0x23a177++){const _0x1ae729=_0x30ffff[_0x7ae8bc(0x112)][_0x23a177];if(!_0x1ae729[_0x7ae8bc(0x16b)]||!_0x1ae729['from'][_0x7ae8bc(0xfb)]('.')||!_0x1ae729['to']||!_0x1ae729['to']['includes']('.'))continue;const _0x2c1c44=new RegExp('@'+_0x1ae729[_0x7ae8bc(0x16b)]+'\x22','gi');_0x133c8e=_0x133c8e[_0x7ae8bc(0x109)](_0x2c1c44,'@'+_0x1ae729['to']+'\x22');}_0x494456=JSON[_0x7ae8bc(0x158)](_0x133c8e);}catch(_0x31790e){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+'\x20message\x20json\x20parsing\x20error:\x20'+_0x31790e[_0x7ae8bc(0xe4)]+'\x20message:\x20'+_0x133c8e),_0x5cd7a3['logger'][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}const _0x1608db=_0x494456['user'];if(!_0x1608db){_0x5cd7a3['logger'][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0x13a)+JSON['stringify'](_0x494456)),_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}if(!_0x1608db[_0x7ae8bc(0xf2)]){_0x5cd7a3['logger']['error'](_0x5a81c0+_0x7ae8bc(0xe5)+JSON[_0x7ae8bc(0x183)](_0x494456)),_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}delete _0x1608db['schemas'];let _0x5975f8;_0x1608db['id']&&(_0x5975f8=_0x1608db['id'],delete _0x1608db['id']);let _0x17139f;_0x1608db[_0x7ae8bc(0x153)]&&(_0x17139f=a0_0x3bafd7[_0x7ae8bc(0x19b)](_0x1608db[_0x7ae8bc(0x153)]),delete _0x1608db[_0x7ae8bc(0x153)]);await _0x2c406b(_0x46ea9e,_0x1608db);const _0x50d822=_0x1608db[_0x7ae8bc(0xf2)];let _0x34ff08,_0x12d0a2;try{_0x34ff08=await _0x13ec27(_0x46ea9e,'userName',_0x50d822);}catch(_0x9a94c5){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0x108)+_0x9a94c5[_0x7ae8bc(0xe4)]),_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);const _0x4005f7=[_0x7ae8bc(0x1d1),'UnableConnectingService','ECONNREFUSED',_0x7ae8bc(0x17a),'ETIMEDOUT',_0x7ae8bc(0x123)];for(const _0x49857 in _0x4005f7){if(_0x9a94c5[_0x7ae8bc(0xe4)][_0x7ae8bc(0xfb)](_0x49857))return!![];}return;}if(!_0x30ffff['skipConvertRolesToGroups']){let _0x7d2977=![];if(_0x494456[_0x7ae8bc(0x1a7)]&&Array[_0x7ae8bc(0x1cb)](_0x494456[_0x7ae8bc(0x1a7)]))for(let _0x456983=0x0;_0x456983<_0x494456[_0x7ae8bc(0x1a7)][_0x7ae8bc(0x14c)];_0x456983++){const _0x35aa23=_0x494456['Operations'][_0x456983];_0x35aa23[_0x7ae8bc(0x18e)][_0x7ae8bc(0x194)](_0x7ae8bc(0xed))&&(_0x35aa23['path']=_0x7ae8bc(0x129),Array[_0x7ae8bc(0x1cb)](_0x35aa23['value'])?(_0x35aa23[_0x7ae8bc(0x14f)][0x0]['id']=_0x35aa23['value'][0x0]['value'],_0x35aa23['value'][0x0]['display']=_0x35aa23['value'][0x0][_0x7ae8bc(0x1b7)]+_0x7ae8bc(0x178)+_0x35aa23[_0x7ae8bc(0x14f)][0x0][_0x7ae8bc(0x14f)],delete _0x35aa23[_0x7ae8bc(0x14f)][0x0][_0x7ae8bc(0x14f)],delete _0x35aa23[_0x7ae8bc(0x14f)][0x0]['type']):_0x35aa23[_0x7ae8bc(0x14f)]=[{'id':_0x35aa23[_0x7ae8bc(0x14f)],'display':_0x35aa23[_0x7ae8bc(0x14f)]}],delete _0x35aa23[_0x7ae8bc(0x132)],_0x7d2977=!![]);}if(_0x1608db[_0x7ae8bc(0xed)]&&Array[_0x7ae8bc(0x1cb)](_0x1608db[_0x7ae8bc(0xed)])&&_0x1608db[_0x7ae8bc(0xed)]['length']>0x0){if(!_0x1608db['groups'])_0x1608db[_0x7ae8bc(0x129)]=[];if(!Array['isArray'](_0x1608db['groups']))_0x1608db['groups']=[];for(let _0x5b8ae8=0x0;_0x5b8ae8<_0x1608db[_0x7ae8bc(0xed)][_0x7ae8bc(0x14c)];_0x5b8ae8++){const _0x447283={},_0x2916bd=_0x1608db['roles'][_0x5b8ae8];_0x447283[_0x7ae8bc(0x14f)]=_0x2916bd[_0x7ae8bc(0x14f)],_0x447283['display']=_0x2916bd['type']+_0x7ae8bc(0x178)+_0x2916bd['display'],_0x1608db['groups'][_0x7ae8bc(0x1a4)](_0x447283);}delete _0x1608db[_0x7ae8bc(0xed)],_0x7d2977=!![];}if(_0x7d2977)_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x10b)+JSON['stringify'](_0x494456));}if(!_0x34ff08){if(_0x494456['activityOperation']===_0x7ae8bc(0x11f)){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0xe7)+_0x50d822+_0x7ae8bc(0xf3)),_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+'\x20done'+_0x5bffdc);return;}if(_0x30ffff[_0x7ae8bc(0x1ad)]&&_0x30ffff[_0x7ae8bc(0x1ad)]===!![]){_0x5cd7a3['logger']['debug'](_0x5a81c0+_0x7ae8bc(0x155)+_0x50d822+_0x7ae8bc(0x1c6)),_0x5cd7a3['logger']['debug'](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}if(Object[_0x7ae8bc(0x180)][_0x7ae8bc(0xd3)][_0x7ae8bc(0x187)](_0x1608db,_0x7ae8bc(0xdf))){if(typeof _0x1608db[_0x7ae8bc(0xdf)]===_0x7ae8bc(0x128)){const _0x23f48a=_0x1608db['active'][_0x7ae8bc(0x116)]();if(_0x23f48a===_0x7ae8bc(0x144))_0x1608db[_0x7ae8bc(0xdf)]=!![];else{if(_0x23f48a===_0x7ae8bc(0x15c))_0x1608db[_0x7ae8bc(0xdf)]=![];}}if(_0x1608db[_0x7ae8bc(0xdf)]===![]){_0x5cd7a3['logger'][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x155)+_0x50d822+_0x7ae8bc(0x169)),_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+'\x20done'+_0x5bffdc);return;}}_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+'\x20Create\x20User\x20userName='+_0x50d822);const _0x40d2a3=a0_0x3bafd7['copyObj'](_0x1608db);try{delete _0x40d2a3['groups'];!_0x40d2a3['password']&&_0x30ffff[_0x7ae8bc(0x1bf)]&&_0x30ffff['generateUserPassword']===!![]&&(_0x40d2a3['password']=a0_0x3bafd7[_0x7ae8bc(0xfe)](0xf));if(_0x17139f||_0x5975f8){if(_0x17139f)for(const _0x3baf5d in _0x17139f){_0x40d2a3[_0x3baf5d]=_0x17139f[_0x3baf5d];}if(_0x5975f8)_0x40d2a3['id']=_0x5975f8;await _0x2c406b(_0x46ea9e,_0x40d2a3);}await _0x5cd7a3[_0x7ae8bc(0xee)](_0x46ea9e,_0x40d2a3),_0x1608db[_0x7ae8bc(0x129)]&&Array[_0x7ae8bc(0x1cb)](_0x1608db[_0x7ae8bc(0x129)])&&_0x1608db[_0x7ae8bc(0x129)][_0x7ae8bc(0x14c)]>0x0&&(_0x12d0a2=await _0x13ec27(_0x46ea9e,_0x7ae8bc(0xf2),_0x50d822));}catch(_0x4fda0f){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0x18f)+JSON[_0x7ae8bc(0x183)](_0x40d2a3)+_0x7ae8bc(0xe0)+_0x4fda0f[_0x7ae8bc(0xe4)]+'}'),_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}}if(_0x34ff08||_0x12d0a2){if(_0x494456[_0x7ae8bc(0x1c7)]===_0x7ae8bc(0x11f)){if(_0x30ffff['modifyOnly']&&_0x30ffff[_0x7ae8bc(0x1ad)]===!![]){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+'\x20Delete\x20User\x20id='+_0x34ff08+'\x20message:\x20user\x20not\x20deleted\x20because\x20of\x20configuration\x20modifyOnly=true'),_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+'\x20done'+_0x5bffdc);return;}_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+'\x20Delete\x20User\x20id='+_0x34ff08);try{await _0x5cd7a3['deleteUser'](_0x46ea9e,_0x34ff08);}catch(_0x9de8c5){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0xd4)+_0x34ff08+_0x7ae8bc(0xe0)+_0x9de8c5[_0x7ae8bc(0xe4)]+'}'),_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}}else{if(_0x12d0a2)_0x34ff08=_0x12d0a2;_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+'\x20Replace\x20User\x20id='+_0x34ff08);try{await _0x5cd7a3['replaceUsrGrp'](_0x7ae8bc(0x146),_0x46ea9e,_0x34ff08,_0x1608db,_0x30ffff[_0x7ae8bc(0x1af)]);}catch(_0x399c3d){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0x1d8)+_0x34ff08+_0x7ae8bc(0xe0)+_0x399c3d[_0x7ae8bc(0xe4)]),_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}if(_0x30ffff[_0x7ae8bc(0x1af)]){const [_0x5e9643,_0x5ec60a]=a0_0x690914[_0x7ae8bc(0x138)]({'Operations':_0x494456['Operations']});if(_0x5ec60a){_0x5cd7a3['logger']['error'](_0x5a81c0+_0x7ae8bc(0x1d8)+_0x34ff08+'\x20convertedScim20\x20error:\x20'+_0x5ec60a[_0x7ae8bc(0xe4)]),_0x5cd7a3['logger'][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}const _0x7525c8=[];if(_0x5e9643[_0x7ae8bc(0xed)]&&Array[_0x7ae8bc(0x1cb)](_0x5e9643[_0x7ae8bc(0xed)]))for(let _0x51cf05=0x0;_0x51cf05<_0x5e9643[_0x7ae8bc(0xed)][_0x7ae8bc(0x14c)];_0x51cf05++){_0x5e9643[_0x7ae8bc(0xed)][_0x51cf05][_0x7ae8bc(0x17d)]&&_0x5e9643[_0x7ae8bc(0xed)][_0x51cf05][_0x7ae8bc(0x17d)]===_0x7ae8bc(0x184)&&_0x7525c8['push'](_0x5e9643[_0x7ae8bc(0xed)][_0x51cf05]);}if(_0x7525c8[_0x7ae8bc(0x14c)]>0x0)try{await _0x5cd7a3[_0x7ae8bc(0x17f)](_0x46ea9e,_0x34ff08,{'roles':_0x7525c8});}catch(_0x4133d8){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0x1d8)+_0x34ff08+_0x7ae8bc(0x182)+_0x4133d8[_0x7ae8bc(0xe4)]);}const _0x37a828=[];if(_0x5e9643[_0x7ae8bc(0x129)]&&Array['isArray'](_0x5e9643[_0x7ae8bc(0x129)]))for(let _0x5ad472=0x0;_0x5ad472<_0x5e9643[_0x7ae8bc(0x129)]['length'];_0x5ad472++){_0x5e9643['groups'][_0x5ad472][_0x7ae8bc(0x17d)]&&_0x5e9643[_0x7ae8bc(0x129)][_0x5ad472][_0x7ae8bc(0x17d)]==='delete'&&_0x37a828[_0x7ae8bc(0x1a4)](_0x5e9643[_0x7ae8bc(0x129)][_0x5ad472]);}if(_0x37a828[_0x7ae8bc(0x14c)]>0x0)for(let _0x28c50e=0x0;_0x28c50e<_0x37a828[_0x7ae8bc(0x14c)];_0x28c50e++){try{await _0x5cd7a3['modifyGroup'](_0x46ea9e,_0x37a828[_0x28c50e]['id'],{'members':[{'operation':_0x7ae8bc(0x184),'value':_0x34ff08}]});}catch(_0x51516a){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+'\x20Replace\x20User\x20id='+_0x34ff08+_0x7ae8bc(0x16a)+_0x51516a[_0x7ae8bc(0xe4)]);}}}if(_0x30ffff[_0x7ae8bc(0x1cf)]&&_0x494456[_0x7ae8bc(0x1c7)]===_0x7ae8bc(0x17f)){if(_0x1608db[_0x7ae8bc(0x129)]&&Array['isArray'](_0x1608db[_0x7ae8bc(0x129)])&&_0x1608db[_0x7ae8bc(0x129)][_0x7ae8bc(0x14c)]===0x0){if(_0x1608db[_0x7ae8bc(0xed)]&&Array[_0x7ae8bc(0x1cb)](_0x1608db[_0x7ae8bc(0xed)])&&_0x1608db[_0x7ae8bc(0xed)][_0x7ae8bc(0x14c)]===0x0){if(_0x494456[_0x7ae8bc(0x1a7)]&&Array[_0x7ae8bc(0x1cb)](_0x494456[_0x7ae8bc(0x1a7)])&&_0x494456[_0x7ae8bc(0x1a7)][_0x7ae8bc(0x14c)]>0x0){let _0x14a593=![];for(let _0x5d58ae=0x0;_0x5d58ae<_0x494456[_0x7ae8bc(0x1a7)][_0x7ae8bc(0x14c)];_0x5d58ae++){const _0x459b9e=_0x494456['Operations'][_0x5d58ae];if(_0x459b9e['op']===_0x7ae8bc(0x13f)){if(_0x459b9e[_0x7ae8bc(0x18e)]){if(_0x459b9e['path'][_0x7ae8bc(0x194)](_0x7ae8bc(0xed))&&_0x459b9e[_0x7ae8bc(0x132)]){_0x14a593=!![];break;}else{if(_0x459b9e[_0x7ae8bc(0x18e)]===_0x7ae8bc(0x129)){_0x14a593=!![];break;}}}}}if(_0x14a593){_0x5cd7a3[_0x7ae8bc(0x125)]['debug'](_0x5a81c0+_0x7ae8bc(0xd4)+_0x34ff08);try{await _0x5cd7a3[_0x7ae8bc(0x11f)](_0x46ea9e,_0x34ff08);}catch(_0x24793b){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5a81c0+_0x7ae8bc(0xd4)+_0x34ff08+_0x7ae8bc(0xe0)+_0x24793b[_0x7ae8bc(0xe4)]+'}'),_0x5cd7a3['logger'][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);return;}}}}}}}}_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x1b6)](_0x5a81c0+_0x7ae8bc(0x16e)+_0x5bffdc);}catch(_0x32755f){_0x5cd7a3[_0x7ae8bc(0x125)][_0x7ae8bc(0x12c)](_0x5cd7a3[_0x7ae8bc(0x163)]+'['+_0x5cd7a3[_0x7ae8bc(0x152)]+_0x7ae8bc(0x1c2)+_0x46ea9e+']['+_0x1d6ade+']\x20error:\x20'+_0x32755f['message']+_0x7ae8bc(0x148)+_0x5bffdc);}},_0xe435c5=a0_0x1f12d0[_0x281443(0x121)](),_0x20c053=_0x1c6193[_0x281443(0x1c8)](),_0x68a56=('durable_'+_0x5cd7a3[_0x281443(0x152)]+'_'+_0x46ea9e)['replaceAll']('*','#')[_0x281443(0x1a5)]('>','##')[_0x281443(0x1a5)]('.','_'),_0x42ba30=_0x1d6ade[_0x281443(0x1de)]('.')[0x0]['toUpperCase']()==='GW',_0x1978fd=async()=>{const _0x442152=_0x281443;try{let _0x2a11a5;const _0x4779d8=''+_0x30ffff?.['nats']?.[_0x442152(0x1ae)],_0x237419=await _0x1c6193[_0x442152(0x1a8)](),_0x579503=async()=>{const _0x256cdf=_0x442152;let _0x31390a;try{_0x31390a=await _0x20c053[_0x256cdf(0x151)]['get'](_0x4779d8,_0x68a56);}catch(_0x55dd78){const _0x2d2f4e={'durable_name':_0x68a56,'deliver_policy':a0_0x1f12d0[_0x256cdf(0x193)][_0x256cdf(0x170)],'ack_policy':a0_0x1f12d0[_0x256cdf(0x12f)][_0x256cdf(0xfa)],'filter_subject':_0x1d6ade};await _0x237419[_0x256cdf(0x151)]['add'](_0x4779d8,_0x2d2f4e),_0x31390a=await _0x20c053['consumers'][_0x256cdf(0x143)](_0x4779d8,_0x68a56);}if(_0x31390a?.['_info']?.[_0x256cdf(0x15a)]?.[_0x256cdf(0x150)]!==_0x256cdf(0x11d))throw new Error(_0x256cdf(0x165));_0x31390a?.[_0x256cdf(0x19f)]?.['config']?.[_0x256cdf(0x1cc)]!==_0x1d6ade&&(await _0x237419[_0x256cdf(0x151)][_0x256cdf(0x1ac)](_0x4779d8,_0x68a56,{'filter_subject':_0x1d6ade}),_0x31390a=await _0x20c053[_0x256cdf(0x151)][_0x256cdf(0x143)](_0x4779d8,_0x68a56)),_0x2a11a5=await _0x31390a['consume']({'max_messages':0x64}),_0x24e427(_0x2a11a5);},_0x24e427=async _0x3d6bd6=>{const _0x525616=_0x442152;for await(const _0x3f3abd of await _0x3d6bd6[_0x525616(0x160)]()){switch(_0x3f3abd[_0x525616(0x1b7)]){case a0_0x1f12d0[_0x525616(0x14b)][_0x525616(0x149)]:_0x5cd7a3[_0x525616(0x125)][_0x525616(0x19a)](_0x5cd7a3[_0x525616(0x163)]+'['+_0x5cd7a3[_0x525616(0x152)]+_0x525616(0x1c2)+_0x46ea9e+']['+_0x1d6ade+']\x20client\x20consumer\x20reinitiated\x20because\x20of\x20'+_0x3f3abd['type']),_0x579503();return;}}};await _0x579503();let _0x2428b0=-0x1;do{for await(const _0x1077d8 of _0x2a11a5){if(!_0x1077d8['headers']||!_0x1077d8[_0x442152(0x185)][_0x442152(0x143)](_0x442152(0x1c0))){_0x1077d8[_0x442152(0x1d9)]();continue;}_0x2428b0=_0x2a11a5[_0x442152(0x11c)]();const _0x393e04=_0x5cd7a3[_0x442152(0x163)]+'['+_0x5cd7a3[_0x442152(0x152)]+']\x20subscriber['+_0x46ea9e+']['+_0x1077d8[_0x442152(0xe6)]+']['+_0x2428b0+']['+(_0x1077d8['headers']?_0x1077d8[_0x442152(0x185)][_0x442152(0x143)](_0x442152(0x1c0)):'')+']',_0x8f4677=_0xe435c5[_0x442152(0x145)](_0x1077d8[_0x442152(0x186)]),_0xb709d1=await _0x2ea960(_0x393e04,_0x8f4677);if(!_0xb709d1||_0xb709d1!==!![])_0x1077d8[_0x442152(0x1d9)]();else _0x5cd7a3[_0x442152(0x125)][_0x442152(0x12c)](_0x393e04+'\x20subscriber\x20error:\x20scimgateway\x20endpoint\x20connect\x20problem\x20-\x20will\x20do\x20auto\x20retry\x20until\x20connected');if(_0x2428b0<0x1)break;}}while(_0x2428b0===0x0);}catch(_0x22cac3){_0x5cd7a3[_0x442152(0x125)][_0x442152(0x12c)](_0x5cd7a3[_0x442152(0x163)]+'['+_0x5cd7a3[_0x442152(0x152)]+_0x442152(0x1c2)+_0x46ea9e+']['+_0x1d6ade+']\x20subscriber\x20stopped\x20error:\x20'+_0x22cac3[_0x442152(0xe4)]);}},_0x8966a2=async()=>{const _0x5f692=_0x281443,_0x1bc183=_0x1c6193[_0x5f692(0x13c)](_0x1d6ade,{'max':0x64});for await(const _0x56df08 of _0x1bc183){if(!_0x56df08[_0x5f692(0x185)]||!_0x56df08[_0x5f692(0x185)]['get'](_0x5f692(0x1c0)))continue;let _0x45967d,_0x263daa;try{try{_0x45967d=JSON[_0x5f692(0x158)](_0x56df08['string']());}catch(_0x996ff6){const _0x48c8a5='subscriber\x20message\x20error:\x20message\x20not\x20JSON\x20formatted';_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x12c)](_0x5cd7a3[_0x5f692(0x163)]+'['+_0x5cd7a3['pluginName']+_0x5f692(0x1c2)+_0x46ea9e+']['+_0x1d6ade+']\x20'+_0x48c8a5+':\x20'+_0x56df08[_0x5f692(0x128)]());throw new Error(_0x48c8a5);}if(!_0x45967d||!_0x45967d[_0x5f692(0xff)]){const _0x428e35=_0x5f692(0xda);this[_0x5f692(0x1d4)][_0x5f692(0x125)][_0x5f692(0x12c)](this['caller']['gwName']+'['+this[_0x5f692(0x1d4)][_0x5f692(0x152)]+']\x20subscriber['+_0x46ea9e+']['+_0x1d6ade+']\x20'+_0x428e35+':\x20'+_0x45967d);throw new Error(_0x428e35);}!Object[_0x5f692(0x180)]['hasOwnProperty'][_0x5f692(0x187)](_0x45967d,'baseEntity')&&(_0x45967d[_0x5f692(0xdc)]=_0x5f692(0xe3));if(_0x45967d['baseEntity']!==_0x46ea9e){const _0x4fb864=_0x5f692(0x1b0)+_0x45967d[_0x5f692(0xdc)]+_0x5f692(0x1a9)+_0x46ea9e;_0x5cd7a3['logger'][_0x5f692(0x12c)](_0x5cd7a3[_0x5f692(0x163)]+'['+_0x5cd7a3[_0x5f692(0x152)]+']\x20subscriber['+_0x46ea9e+']['+_0x1d6ade+']\x20'+_0x4fb864);throw new Error(_0x4fb864);}_0x263daa=_0x5cd7a3[_0x5f692(0x163)]+'['+_0x5cd7a3[_0x5f692(0x152)]+_0x5f692(0x1c2)+_0x46ea9e+']['+_0x56df08[_0x5f692(0xe6)]+']['+(_0x56df08[_0x5f692(0x185)]?_0x56df08[_0x5f692(0x185)][_0x5f692(0x143)](_0x5f692(0x1c0)):'')+']',_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0xea));const _0x4431c2={};let _0x1d8065,_0x486472;switch(_0x45967d[_0x5f692(0xff)]){case'getUsers':if(!_0x45967d[_0x5f692(0x1a2)][_0x5f692(0x142)]&&_0x45967d[_0x5f692(0x1a2)][_0x5f692(0x10e)]&&_0x45967d[_0x5f692(0x1a2)][_0x5f692(0x10e)][_0x5f692(0xfb)](_0x5f692(0x1d6))){const _0x3a7741=_0x45967d[_0x5f692(0x1a2)][_0x5f692(0x10e)][_0x5f692(0x1de)](_0x5f692(0x1d6));let _0x5adcc6=[];for(let _0x309aed=0x0;_0x309aed<_0x3a7741['length'];_0x309aed++){_0x3a7741[_0x309aed]=_0x3a7741[_0x309aed][_0x5f692(0x109)](/\(/g,'')[_0x5f692(0x109)](/\)/g,'')[_0x5f692(0x114)]();const _0x2f8ae6=_0x3a7741[_0x309aed]['split']('\x20');if(_0x2f8ae6['length']===0x3||_0x2f8ae6[_0x5f692(0x14c)]>0x2&&_0x2f8ae6[0x2][_0x5f692(0x194)]('\x22')&&_0x2f8ae6[_0x2f8ae6['length']-0x1][_0x5f692(0x134)]('\x22')){const _0x3c7cf1={};_0x3c7cf1[_0x5f692(0x166)]=_0x2f8ae6[0x0],_0x3c7cf1[_0x5f692(0x142)]=_0x2f8ae6[0x1][_0x5f692(0x116)](),_0x3c7cf1[_0x5f692(0x14f)]=decodeURIComponent(_0x2f8ae6['slice'](0x2)[_0x5f692(0xf1)]('\x20')[_0x5f692(0x109)](/"/g,'')),_0x5adcc6[_0x5f692(0x1a4)](_0x3c7cf1);}else{_0x5adcc6=[];break;}}if(_0x5adcc6[_0x5f692(0x14c)]>0x0){const _0x2e0405=async _0x59ca19=>{const _0x3d51ab=_0x5f692;return await _0x5cd7a3[_0x45967d[_0x3d51ab(0xff)]](_0x46ea9e,_0x59ca19,_0x45967d[_0x3d51ab(0x101)],_0x45967d[_0x3d51ab(0x17b)]);},_0x49f95e=0x5,_0xbf33e7=[];_0x5cd7a3['logger'][_0x5f692(0x1b6)](_0x263daa+'\x20calling\x20\x22'+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x1d0));do{const _0x26deee=_0x5adcc6[_0x5f692(0x1d2)](0x0,_0x49f95e),_0x248983=await Promise[_0x5f692(0x15d)](_0x26deee[_0x5f692(0x1cd)](_0x129877=>_0x2e0405(_0x129877))),_0x3833e8=_0x248983[_0x5f692(0x136)](_0xe1ab4e=>_0xe1ab4e[_0x5f692(0x160)]===_0x5f692(0x16d))[_0x5f692(0x1cd)](_0x1e1be7=>_0x1e1be7[_0x5f692(0x11e)][_0x5f692(0xe4)]);if(_0x3833e8[_0x5f692(0x14c)]>0x0){const _0x37e60c=_0x45967d[_0x5f692(0xff)]+_0x5f692(0xf8)+_0x3833e8[_0x5f692(0xf1)](',\x20');throw new Error(_0x37e60c);}const _0x4ebbe7=_0x248983[_0x5f692(0x1cd)](_0x5b3828=>_0x5b3828?.[_0x5f692(0x14f)]?.[_0x5f692(0x16f)]);for(let _0x1f0483=0x0;_0x1f0483<_0x4ebbe7['length'];_0x1f0483++){Array[_0x5f692(0x180)][_0x5f692(0x1a4)][_0x5f692(0x164)](_0xbf33e7,_0x4ebbe7[_0x1f0483]);}}while(_0x5adcc6[_0x5f692(0x14c)]>0x0);_0x1d8065={'Resources':_0xbf33e7};}}!_0x1d8065&&(_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+'\x22\x20and\x20awaiting\x20result'),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d[_0x5f692(0x1a2)],_0x45967d[_0x5f692(0x101)],_0x45967d[_0x5f692(0x11a)]));if(Array[_0x5f692(0x1cb)](_0x1d8065?.[_0x5f692(0x16f)])){if(_0x45967d?.[_0x5f692(0x101)]?.[_0x5f692(0x14c)]===0x0||_0x45967d?.[_0x5f692(0x101)]?.['includes']('groups'))for(let _0x4ff87c=0x0;_0x4ff87c<_0x1d8065[_0x5f692(0x16f)]['length'];_0x4ff87c++){const _0x378e98=_0x1d8065[_0x5f692(0x16f)][_0x4ff87c];if(!_0x378e98['id'])break;if(_0x378e98[_0x5f692(0x129)])break;_0x378e98[_0x5f692(0x129)]=await _0x5cd7a3[_0x5f692(0x17e)](_0x46ea9e,_0x378e98['id'],'getGroups',_0x45967d['ctxPassThrough']);}}break;case _0x5f692(0x162):_0x5cd7a3['logger'][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+'\x22\x20and\x20awaiting\x20result'),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d[_0x5f692(0x1a2)],_0x45967d['attributes'],_0x45967d[_0x5f692(0x11a)]);break;case'createUser':_0x5cd7a3['logger'][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+'\x22\x20and\x20awaiting\x20result'),_0x1d8065=await _0x5cd7a3[_0x45967d['func']](_0x46ea9e,_0x45967d[_0x5f692(0x1a2)],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0x174):_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['obj'],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0x11f):_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d[_0x5f692(0x11a)]);break;case'deleteGroup':_0x5cd7a3[_0x5f692(0x125)]['debug'](_0x263daa+_0x5f692(0x1c9)+_0x45967d['func']+'\x22\x20and\x20awaiting\x20result'),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d[_0x5f692(0x11a)]);break;case'modifyUser':_0x5cd7a3['logger'][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d['func']+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d[_0x5f692(0x1a2)],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0x1b2):_0x5cd7a3[_0x5f692(0x125)]['debug'](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d['obj'],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0xf6):_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+'\x20calling\x20\x22'+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x45967d[_0x5f692(0x1a6)],_0x46ea9e,_0x45967d['id'],_0x45967d['obj'],_0x30ffff[_0x5f692(0x1af)],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0xeb):_0x5cd7a3[_0x5f692(0x125)]['debug'](_0x263daa+_0x5f692(0x1c9)+_0x45967d['func']+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d[_0x5f692(0x1a2)],_0x45967d['ctxPassThrough']);break;case _0x5f692(0xd8):_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+'\x20calling\x20\x22'+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d['func']](_0x46ea9e,_0x45967d['id'],_0x45967d[_0x5f692(0x1a2)],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0xf5):_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d['func']+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d['obj'],_0x45967d['ctxPassThrough']);break;case _0x5f692(0x103):_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x1b6)](_0x263daa+_0x5f692(0x1c9)+_0x45967d['func']+_0x5f692(0x127)),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d[_0x5f692(0x1be)],_0x45967d[_0x5f692(0x1a2)],_0x45967d[_0x5f692(0x11a)]);break;case _0x5f692(0x137):_0x5cd7a3[_0x5f692(0x125)]['debug'](_0x263daa+_0x5f692(0x1c9)+_0x45967d[_0x5f692(0xff)]+'\x22\x20and\x20awaiting\x20result'),_0x1d8065=await _0x5cd7a3[_0x45967d[_0x5f692(0xff)]](_0x46ea9e,_0x45967d['id'],_0x45967d[_0x5f692(0x11a)]);break;default:_0x486472='subscriber\x20message\x20error:\x20handle\x20\x27'+_0x45967d['func']+_0x5f692(0x19d),_0x5cd7a3[_0x5f692(0x125)][_0x5f692(0x12c)](_0x263daa+'\x20'+_0x486472);throw new Error(_0x486472);}if(!_0x1d8065)_0x1d8065=null;const _0xe2f6dc=JSON[_0x5f692(0x183)](_0x1d8065);_0x56df08[_0x5f692(0x10d)](_0xe2f6dc),_0x5cd7a3['logger'][_0x5f692(0x19a)](_0x263daa+_0x5f692(0x1db)+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x139)+(_0x45967d['obj']?JSON[_0x5f692(0x183)](_0x45967d[_0x5f692(0x1a2)]):'')+_0x5f692(0x192)+(_0x45967d['id']?_0x45967d['id']:'')+_0x5f692(0x157)+(_0x45967d[_0x5f692(0x101)]?_0x45967d[_0x5f692(0x101)]:'')+_0x5f692(0x16c)+_0xe2f6dc+_0x5bffdc);}catch(_0x4d2b58){const _0x16d730=_0x5f692(0x1d3)+_0x4d2b58['message']+_0x5f692(0x1dc)+_0x4d2b58['name']+'\x22}';_0x56df08[_0x5f692(0x10d)](_0x16d730),_0x5cd7a3['logger'][_0x5f692(0x19a)]((_0x263daa||'')+'\x20message\x20handled:\x20'+_0x45967d[_0x5f692(0xff)]+_0x5f692(0x139)+(_0x45967d[_0x5f692(0x1a2)]?JSON[_0x5f692(0x183)](_0x45967d['obj']):'')+_0x5f692(0x192)+(_0x45967d['id']?_0x45967d['id']:'')+_0x5f692(0x157)+(_0x45967d[_0x5f692(0x101)]?_0x45967d['attributes']:'')+'\x20message\x20error\x20response:\x20'+_0x16d730+_0x5bffdc);}}};if(_0x42ba30)_0x8966a2();else _0x1978fd();},_0x2667e9=async(_0x51f58b,_0x5393a0)=>{const _0x2668a6=_0x438835,_0x4e3595=_0x870e65[_0x51f58b][_0x2668a6(0x15a)]?.['nats']?.['subject'];let _0x4457d1=0x0;for await(const _0x274361 of _0x5393a0[_0x2668a6(0x160)]()){switch(_0x274361['type']){case a0_0x1f12d0['Events']['Disconnect']:_0x5cd7a3[_0x2668a6(0x125)][_0x2668a6(0x12c)](_0x5cd7a3[_0x2668a6(0x163)]+'['+_0x5cd7a3[_0x2668a6(0x152)]+_0x2668a6(0x1c2)+_0x51f58b+']['+_0x4e3595+_0x2668a6(0x1b9)+_0x274361[_0x2668a6(0x186)]+_0x2668a6(0x167)),_0x4457d1=0x0;break;case a0_0x1f12d0[_0x2668a6(0x1b3)][_0x2668a6(0x1b1)]:_0x5cd7a3[_0x2668a6(0x125)][_0x2668a6(0x19a)](_0x5cd7a3['gwName']+'['+_0x5cd7a3['pluginName']+_0x2668a6(0x1c2)+_0x51f58b+']['+_0x4e3595+_0x2668a6(0x12d)+_0x274361[_0x2668a6(0x186)]);break;case a0_0x1f12d0[_0x2668a6(0x1b3)]['Error']:_0x5cd7a3[_0x2668a6(0x125)]['error'](_0x5cd7a3['gwName']+'['+_0x5cd7a3[_0x2668a6(0x152)]+']\x20subscriber['+_0x51f58b+']['+_0x4e3595+_0x2668a6(0x1ab)+_0x274361[_0x2668a6(0x186)]);break;case a0_0x1f12d0['DebugEvents']['Reconnecting']:_0x4457d1+=0x1;_0x4457d1%0x1e===0x0&&_0x5cd7a3['logger'][_0x2668a6(0x1b6)](_0x5cd7a3[_0x2668a6(0x163)]+'['+_0x5cd7a3['pluginName']+_0x2668a6(0x1c2)+_0x51f58b+']['+_0x4e3595+_0x2668a6(0x168)+_0x274361[_0x2668a6(0x186)]+'\x20(count='+_0x4457d1+')');break;case a0_0x1f12d0[_0x2668a6(0x1a1)][_0x2668a6(0x1bb)]:_0x5cd7a3['logger']['debug'](_0x5cd7a3[_0x2668a6(0x163)]+'['+_0x5cd7a3[_0x2668a6(0x152)]+_0x2668a6(0x1c2)+_0x51f58b+']['+_0x4e3595+']\x20client\x20has\x20a\x20stale\x20connection\x20'+_0x274361[_0x2668a6(0x186)]);break;}}};process['on'](_0x438835(0x1dd),async()=>{const _0x41deb1=_0x438835;for(const _0x5a1399 in _0x870e65){_0x870e65[_0x5a1399]['nc']&&!_0x870e65[_0x5a1399]['nc'][_0x41deb1(0x12e)]()&&await _0x870e65[_0x5a1399]['nc']['drain']();}}),process['on'](_0x438835(0x11b),async()=>{const _0x30c25e=_0x438835;for(const _0x43f45f in _0x870e65){_0x870e65[_0x43f45f]['nc']&&!_0x870e65[_0x43f45f]['nc'][_0x30c25e(0x12e)]()&&await _0x870e65[_0x43f45f]['nc'][_0x30c25e(0x10f)]();}});const _0x13ec27=async(_0xe1e17b,_0x50684c,_0x2cbb3a)=>{const _0x2cbe0c=_0x438835,_0x361048={'attribute':_0x50684c,'operator':'eq','value':_0x2cbb3a,'rawFilter':undefined,'startIndex':undefined,'count':undefined},_0x5956e9=[_0x50684c];if(_0x50684c!=='id')_0x5956e9[_0x2cbe0c(0x1a4)]('id');try{const _0x3c7d05=await _0x5cd7a3[_0x2cbe0c(0x198)](_0xe1e17b,_0x361048,_0x5956e9);if(!_0x3c7d05||!_0x3c7d05[_0x2cbe0c(0x16f)]||!Array[_0x2cbe0c(0x1cb)](_0x3c7d05[_0x2cbe0c(0x16f)]))throw new Error(_0x2cbe0c(0x110)+JSON['stringify'](_0x361048)+'\x20error:\x20missing\x20result');if(_0x3c7d05['Resources']['length']===0x0)return null;else{if(_0x3c7d05[_0x2cbe0c(0x16f)][_0x2cbe0c(0x14c)]>0x2)throw new Error(_0x2cbe0c(0x110)+JSON[_0x2cbe0c(0x183)](_0x361048)+'\x20error:\x20more\x20than\x20one\x20user\x20were\x20found}');else{const _0x18e8be=_0x3c7d05[_0x2cbe0c(0x16f)][0x0];if(!_0x18e8be['id'])throw new Error(_0x2cbe0c(0x110)+JSON[_0x2cbe0c(0x183)](_0x361048)+'\x20result='+JSON[_0x2cbe0c(0x183)](_0x18e8be)+'\x20error:\x20missing\x20id}');return decodeURIComponent(_0x18e8be['id']);}}}catch(_0x17d49f){throw new Error('getUsers()\x20getObj='+JSON[_0x2cbe0c(0x183)](_0x361048)+_0x2cbe0c(0xe0)+_0x17d49f[_0x2cbe0c(0xe4)]+'}');}},_0x2729f5=_0x5539dd=>{const _0x2b3e67=_0x438835;if(!_0x5539dd||typeof _0x5539dd!==_0x2b3e67(0x128))return[null,null];_0x5539dd=_0x5539dd[_0x2b3e67(0x114)]();const _0x596d13=_0x5539dd[_0x2b3e67(0xf7)]('(');if(_0x596d13<0x1)return[null,null];if(_0x5539dd[_0x2b3e67(0x147)](_0x5539dd[_0x2b3e67(0x14c)]-0x1)!==')')return[null,null];if(_0x4604e4(_0x5539dd,'(')!==_0x4604e4(_0x5539dd,')'))return[null,null];const _0x4e2890=_0x5539dd[_0x2b3e67(0x147)](0x0,_0x596d13),_0x52a25b=_0x5539dd['substring'](_0x596d13+0x1,_0x5539dd['length']-0x1);let _0x5c71c0=[];const _0x24d2a7=_0x52a25b[_0x2b3e67(0x1de)](',');let _0x43398c='';for(let _0x1d941d=0x0;_0x1d941d<_0x24d2a7[_0x2b3e67(0x14c)];_0x1d941d++){const _0x5c9b8e=_0x43398c?_0x43398c+','+_0x24d2a7[_0x1d941d]:_0x24d2a7[_0x1d941d],_0x502653=_0x4604e4(_0x5c9b8e,'('),_0x6c29b3=_0x4604e4(_0x5c9b8e,')');if(_0x502653===_0x6c29b3)_0x5c71c0['push'](_0x505015(_0x5c9b8e,'\x22')),_0x43398c='';else{if(_0x43398c)_0x43398c+=','+_0x24d2a7[_0x1d941d];else _0x43398c+=_0x24d2a7[_0x1d941d];}}if(_0x5c71c0['length']===0x0)_0x5c71c0=null;return[_0x4e2890,_0x5c71c0];};function _0x4604e4(_0x5a062a,_0x8cf49c){const _0x3bad2d=_0x438835;let _0x2588e8=0x0;for(let _0x424b48=0x0;_0x424b48<_0x5a062a[_0x3bad2d(0x14c)];_0x424b48++){_0x5a062a[_0x3bad2d(0x1a0)](_0x424b48)===_0x8cf49c&&(_0x2588e8+=0x1);}return _0x2588e8;}const _0x505015=(_0x280310,_0x1bf89a)=>{const _0x86080a=_0x438835;if(typeof _0x280310!==_0x86080a(0x128)||typeof _0x1bf89a!=='string')return _0x280310;if(_0x280310[_0x86080a(0x14c)]===0x1)return _0x280310;if(_0x1bf89a[_0x86080a(0x14c)]!==0x1)return _0x280310;return _0x280310=_0x280310[_0x86080a(0x114)](),_0x280310[_0x86080a(0x147)](0x0,0x1)===_0x1bf89a&&(_0x280310=_0x280310[_0x86080a(0x147)](0x1)),_0x280310['substring'](_0x280310[_0x86080a(0x14c)]-0x1)===_0x1bf89a&&(_0x280310=_0x280310[_0x86080a(0x147)](0x0,_0x280310['length']-0x1)),_0x280310;},_0x19b82c=async(_0x483b6f,_0x4690ea,_0x52169f,_0x4549c7)=>{const _0x1cd93a=_0x438835;if(!_0x4690ea||!_0x52169f||!_0x4549c7)return null;const [_0x1d1468,_0xb02044]=_0x2729f5(_0x4549c7);if(!_0x1d1468||!_0xb02044){const _0x238733=_0x4549c7[_0x1cd93a(0x1de)]('(');if(_0x238733[_0x1cd93a(0x14c)]>0x1){const _0x518440=[_0x1cd93a(0xe8),_0x1cd93a(0x197),_0x1cd93a(0x15f),'elementnumber',_0x1cd93a(0xf1),_0x1cd93a(0x109),'normalize',_0x1cd93a(0x10c),_0x1cd93a(0x191)],_0x45f8d4=_0x238733[0x0][_0x1cd93a(0x116)]();if(_0x518440[_0x1cd93a(0xfb)](_0x45f8d4))return null;}return _0x4549c7;}for(let _0x44a9ea=0x0;_0x44a9ea<_0xb02044[_0x1cd93a(0x14c)];_0x44a9ea++){if(_0xb02044[_0x44a9ea]['substring'](0x0,0x1)==='['){const _0x5386ed=_0xb02044[_0x44a9ea][_0x1cd93a(0xf7)](']');if(_0x5386ed<0x0)return null;const _0x61c227=_0xb02044[_0x44a9ea]['substring'](0x1,_0x5386ed),_0xbe774f=_0x61c227['split']('.');let _0x131c1c;for(let _0x44f5ff=0x0;_0x44f5ff<_0xbe774f['length'];_0x44f5ff++){if(_0x44f5ff===0x0)_0x131c1c=_0x4690ea[_0xbe774f[_0x44f5ff]];else{if(!_0x131c1c)return null;_0x131c1c=_0x131c1c[_0xbe774f[_0x44f5ff]];}}if(!_0x131c1c)return null;_0xb02044[_0x44a9ea]=_0x131c1c;}}for(let _0x985d5a=0x0;_0x985d5a<_0xb02044[_0x1cd93a(0x14c)];_0x985d5a++){const [_0x3d6d55]=_0x2729f5(_0xb02044[_0x985d5a]);_0x3d6d55&&(_0xb02044[_0x985d5a]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0xb02044[_0x985d5a]));}if(_0xb02044[0x0]===null)return null;switch(_0x1d1468[_0x1cd93a(0x116)]()){case'lowercase':{if(_0xb02044[_0x1cd93a(0x14c)]!==0x1)return null;const [_0x437fad]=_0x2729f5(_0xb02044[0x0]);if(_0x437fad)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x437fad);if(_0xb02044[0x0]===null)return null;return _0xb02044[0x0][_0x1cd93a(0x116)]();}case _0x1cd93a(0x197):{if(_0xb02044[_0x1cd93a(0x14c)]!==0x1)return null;const [_0x504648]=_0x2729f5(_0xb02044[0x0]);if(_0x504648)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x504648);if(_0xb02044[0x0]===null)return null;return _0xb02044[0x0][_0x1cd93a(0x171)]();}case'firstn':{if(_0xb02044[_0x1cd93a(0x14c)]!==0x2)return null;const [_0x2dd456]=_0x2729f5(_0xb02044[0x0]);if(_0x2dd456)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x2dd456);if(_0xb02044[0x0]===null)return null;if(isNaN(_0xb02044[0x1]))return null;return _0xb02044[0x0][_0x1cd93a(0x147)](0x0,_0xb02044[0x1]);}case'elementnumber':{const [_0x1aede6]=_0x2729f5(_0xb02044[0x0]);if(_0xb02044[_0x1cd93a(0x14c)]<0x2)return null;if(_0x1aede6)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x1aede6);if(_0xb02044[0x0]===null)return null;const _0x18712b=_0xb02044[0x1];if(isNaN(_0x18712b))return null;let _0xe9411;if(_0xb02044[_0x1cd93a(0x14c)]===0x3)_0xe9411=_0xb02044[0x0][_0x1cd93a(0x1de)](_0xb02044[0x2]);else _0xe9411=_0xe9411=_0xb02044[0x0][_0x1cd93a(0x1de)]('\x20');if(_0x18712b<=_0xe9411[_0x1cd93a(0x14c)])return _0xe9411[_0x18712b-0x1];else return'';}case _0x1cd93a(0x109):{const [_0x51eca4]=_0x2729f5(_0xb02044[0x0]);if(_0x51eca4)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x51eca4);if(_0xb02044[0x0]===null)return null;if(_0xb02044[_0x1cd93a(0x14c)]!==0x3)return null;return _0xb02044[0x0][_0x1cd93a(0x1a5)](_0xb02044[0x1],_0xb02044[0x2]);}case'normalize':{if(_0xb02044[_0x1cd93a(0x14c)]!==0x1)return null;const [_0x1dbda9]=_0x2729f5(_0xb02044[0x0]);if(_0x1dbda9)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x1dbda9);if(_0xb02044[0x0]===null)return null;return a0_0x7d5195[_0x1cd93a(0x14d)](_0xb02044[0x0]);}case _0x1cd93a(0xf1):{let _0x18f092='';for(let _0x5cd186=0x0;_0x5cd186<_0xb02044[_0x1cd93a(0x14c)];_0x5cd186++){const [_0x504064]=_0x2729f5(_0xb02044[_0x5cd186]);if(_0x504064)_0xb02044[_0x5cd186]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x504064);if(_0xb02044[_0x5cd186]===null)return null;_0x18f092+=_0xb02044[_0x5cd186];}return _0x18f092;}case _0x1cd93a(0x10c):{if(_0xb02044[_0x1cd93a(0x14c)]>0x2)return null;const [_0x36c3da]=_0x2729f5(_0xb02044[0x0]);if(_0x36c3da)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x36c3da);if(_0xb02044[0x0]===null)return null;const _0x26073a=parseInt(_0xb02044[0x0]);if(isNaN(_0x26073a))return null;let _0x37338b=_0x1cd93a(0x140);_0x37338b+=','+_0xb02044[0x0];if(_0xb02044['length']===0x2&&_0xb02044[0x1]['toLowerCase']()===_0x1cd93a(0x144))_0x37338b+=_0x1cd93a(0x1c3);else _0x37338b+=_0x1cd93a(0x1aa);return _0x37338b+='##',_0x37338b;}case _0x1cd93a(0x191):{if(_0xb02044[_0x1cd93a(0x14c)]!==0x1)return null;const [_0x5957df]=_0x2729f5(_0xb02044[0x0]);if(_0x5957df)_0xb02044[0x0]=await _0x19b82c(_0x483b6f,_0x4690ea,_0x52169f,_0x5957df);if(_0xb02044[0x0]===null)return null;let _0x5e7549,_0x2a6489=![],_0x4aa231='';const _0x3ab69e=_0xb02044[0x0][_0x1cd93a(0x1de)]('##');if(_0x3ab69e[_0x1cd93a(0x14c)]>0x2)for(let _0x4bdfc9=0x0;_0x4bdfc9<_0x3ab69e[_0x1cd93a(0x14c)];_0x4bdfc9++){if(_0x3ab69e[_0x4bdfc9][_0x1cd93a(0x194)]('doIncrement')){const _0x4ddc21=_0x3ab69e[_0x4bdfc9][_0x1cd93a(0x1de)](',');if(_0x4ddc21[_0x1cd93a(0x14c)]<0x2)return null;const _0x551eb0=parseInt(_0x4ddc21[0x1]);if(isNaN(_0x551eb0))return null;_0x4aa231='##'+_0x3ab69e[_0x4bdfc9]+'##',_0x5e7549=_0x4ddc21[0x1],_0x4ddc21[_0x1cd93a(0x14c)]>0x2&&(_0x2a6489=_0x4ddc21[0x2][_0x1cd93a(0x116)]()==='true');}}let _0x5cb1ad,_0x2c8ae7=0x0,_0x2148db=0x0;if(_0x5e7549){_0x2148db=_0x5e7549[_0x1cd93a(0x14c)],_0x2c8ae7=0xa;for(let _0xa99ee8=0x1;_0xa99ee8<_0x2148db;_0xa99ee8++){_0x2c8ae7*=0xa;}_0x2c8ae7-=0x1,_0x5cb1ad=parseInt(_0x5e7549);if(isNaN(_0x5cb1ad))return null;_0x5cb1ad-=0x1;}else _0x5cb1ad=0x0;do{_0x5cb1ad+=0x1;let _0x1e809c=_0xb02044[0x0];if(_0x5e7549!==undefined&&_0x4aa231){let _0x123009=_0x5cb1ad[_0x1cd93a(0xef)]();while(_0x123009[_0x1cd93a(0x14c)]<_0x2148db){_0x123009='0'+_0x123009;}_0x2a6489?_0x1e809c=_0x1e809c[_0x1cd93a(0x109)](_0x4aa231,_0x123009):(_0x1e809c=_0x1e809c[_0x1cd93a(0x109)](_0x4aa231,''),_0x2a6489=!![],_0x5cb1ad-=0x1);}try{const _0x14d95a=await _0x13ec27(_0x483b6f,_0x52169f,_0x1e809c);if(!_0x14d95a)return _0x1e809c;}catch(_0x58651f){return _0x5cd7a3['logger'][_0x1cd93a(0x12c)](_0x5cd7a3[_0x1cd93a(0x163)]+'['+_0x5cd7a3[_0x1cd93a(0x152)]+']\x20'+_0x1d1468+_0x1cd93a(0x108)+_0x58651f[_0x1cd93a(0xe4)]),null;}}while(_0x5cb1ad<_0x2c8ae7);return null;}default:}return null;},_0x2c406b=async(_0x44a163,_0x4632af)=>{const _0x9485c7=_0x438835;for(const _0xc6da70 in _0x4632af){const _0x11594e=_0x4632af[_0xc6da70],[_0x4651d9,_0x158e8c]=_0x2729f5(_0x11594e);if(_0x4651d9){const _0xaf184a=''+_0xc6da70,_0x5802d3=_0x4651d9+'('+_0x158e8c[_0x9485c7(0xf1)](',')+')',_0x376b64=await _0x19b82c(_0x44a163,_0x4632af,_0xaf184a,_0x5802d3);if(_0x376b64===null)delete _0x4632af[_0xc6da70];else _0x4632af[_0xc6da70]=_0x376b64;}for(const _0x488214 in _0x11594e){const _0x86d8ce=_0x11594e[_0x488214],[_0x2f627d,_0x5333a1]=_0x2729f5(_0x86d8ce);if(_0x2f627d){const _0x52fb3e=_0xc6da70+'.'+_0x488214,_0x1ac217=_0x2f627d+'('+_0x5333a1[_0x9485c7(0xf1)](',')+')',_0x228217=await _0x19b82c(_0x44a163,_0x4632af,_0x52fb3e,_0x1ac217);if(_0x228217===null)delete _0x11594e[_0x488214];else _0x11594e[_0x488214]=_0x228217;}}}return _0x4632af;};}}export class Publisher{constructor(_0x510f44){const _0x3c1a84=a0_0xe6f9,_0x5ad16e=_0x510f44,_0xbe3537={},_0x292b60=async(_0x42e0c0,_0x4dcdc2)=>{const _0x5ed36c=a0_0xe6f9,_0x37a861=_0xbe3537[_0x42e0c0]['config']?.[_0x5ed36c(0x175)]?.[_0x5ed36c(0xe6)];let _0x140973=0x0;for await(const _0x3d5d6c of _0x4dcdc2[_0x5ed36c(0x160)]()){switch(_0x3d5d6c[_0x5ed36c(0x1b7)]){case a0_0x1f12d0[_0x5ed36c(0x1b3)][_0x5ed36c(0x111)]:_0x5ad16e[_0x5ed36c(0x125)][_0x5ed36c(0x12c)](_0x5ad16e[_0x5ed36c(0x163)]+'['+_0x5ad16e[_0x5ed36c(0x152)]+']\x20publisher['+_0x42e0c0+']['+_0x37a861+_0x5ed36c(0x1b9)+_0x3d5d6c[_0x5ed36c(0x186)]+_0x5ed36c(0x167)),_0x140973=0x0;break;case a0_0x1f12d0[_0x5ed36c(0x1b3)][_0x5ed36c(0x1b1)]:_0x5ad16e[_0x5ed36c(0x125)][_0x5ed36c(0x19a)](_0x5ad16e[_0x5ed36c(0x163)]+'['+_0x5ad16e['pluginName']+']\x20publisher['+_0x42e0c0+']['+_0x37a861+_0x5ed36c(0x12d)+_0x3d5d6c[_0x5ed36c(0x186)]);break;case a0_0x1f12d0[_0x5ed36c(0x1b3)]['Error']:_0x5ad16e[_0x5ed36c(0x125)][_0x5ed36c(0x12c)](_0x5ad16e[_0x5ed36c(0x163)]+'['+_0x5ad16e[_0x5ed36c(0x152)]+_0x5ed36c(0x1d7)+_0x42e0c0+']['+_0x37a861+']\x20client\x20error\x20'+_0x3d5d6c[_0x5ed36c(0x186)]);break;case a0_0x1f12d0[_0x5ed36c(0x1a1)][_0x5ed36c(0x107)]:_0x140973+=0x1;_0x140973%0x1e===0x0&&_0x5ad16e['logger'][_0x5ed36c(0x1b6)](_0x5ad16e[_0x5ed36c(0x163)]+'['+_0x5ad16e[_0x5ed36c(0x152)]+_0x5ed36c(0x1d7)+_0x42e0c0+']['+_0x37a861+']\x20client\x20is\x20attempting\x20to\x20reconnect\x20'+_0x3d5d6c[_0x5ed36c(0x186)]+_0x5ed36c(0xdd)+_0x140973+')');break;case a0_0x1f12d0[_0x5ed36c(0x1a1)]['StaleConnection']:_0x5ad16e[_0x5ed36c(0x125)][_0x5ed36c(0x1b6)](_0x5ad16e['gwName']+'['+_0x5ad16e['pluginName']+']\x20publisher['+_0x42e0c0+']['+_0x37a861+']\x20client\x20has\x20a\x20stale\x20connection\x20'+_0x3d5d6c['data']);break;}}},_0x5bc997=async(_0x3cfc8b,_0xc10f7d)=>{const _0x5a23ea=a0_0xe6f9,_0x40f9c2=_0xbe3537[_0x3cfc8b][_0x5a23ea(0x15a)]?.[_0x5a23ea(0x175)]?.[_0x5a23ea(0xe6)];let _0x465b89;try{_0x465b89=await a0_0x1f12d0[_0x5a23ea(0x1b8)](_0xc10f7d);if(_0x465b89[_0x5a23ea(0x19a)][_0x5a23ea(0x161)]!==_0x5a23ea(0x1c1)){_0x465b89['close']();return;}_0xbe3537[_0x3cfc8b]['nc']=_0x465b89,_0x292b60(_0x3cfc8b,_0x465b89);}catch(_0x5e85db){_0x5ad16e[_0x5a23ea(0x125)][_0x5a23ea(0x12c)](_0x5ad16e[_0x5a23ea(0x163)]+'['+_0x5ad16e['pluginName']+_0x5a23ea(0x1d7)+_0x3cfc8b+']['+_0x40f9c2+_0x5a23ea(0xf4)+_0x5e85db[_0x5a23ea(0xe4)]+'\x20-\x20will\x20do\x20auto\x20connect\x20when\x20available\x20-\x20however,\x20please\x20verify\x20stream\x20configuration'),_0xc10f7d[_0x5a23ea(0x18a)]=!![];try{_0x465b89=await a0_0x1f12d0[_0x5a23ea(0x1b8)](_0xc10f7d);if(_0x465b89[_0x5a23ea(0x19a)][_0x5a23ea(0x161)]!==_0x5a23ea(0x1c1)){_0x465b89[_0x5a23ea(0x102)]();return;}_0xbe3537[_0x3cfc8b]['nc']=_0x465b89,_0x292b60(_0x3cfc8b,_0x465b89);}catch(_0x45c46d){_0x5ad16e[_0x5a23ea(0x125)]['error'](_0x5ad16e[_0x5a23ea(0x163)]+'['+_0x5ad16e[_0x5a23ea(0x152)]+_0x5a23ea(0x1d7)+_0x3cfc8b+']['+_0x40f9c2+_0x5a23ea(0xf4)+_0x45c46d['message']);return;}}_0x5ad16e[_0x5a23ea(0x125)]['debug'](_0x5ad16e[_0x5a23ea(0x163)]+'['+_0x5ad16e['pluginName']+']\x20publisher['+_0x3cfc8b+']['+_0x40f9c2+_0x5a23ea(0x1ba)+(_0xc10f7d['tls']['ca']?_0x5a23ea(0x195):'')+'\x20'+_0x465b89['getServer']()),_0x465b89[_0x5a23ea(0xe9)]()[_0x5a23ea(0xf0)](_0xd0d807=>{const _0x539f87=_0x5a23ea;_0xd0d807&&_0x5ad16e[_0x539f87(0x125)][_0x539f87(0x12c)](_0x5ad16e[_0x539f87(0x163)]+'['+_0x5ad16e['pluginName']+_0x539f87(0x1d7)+_0x3cfc8b+']['+_0x40f9c2+_0x539f87(0x122)+_0xd0d807[_0x539f87(0xe4)]);});};this['add']=async(_0x491304,_0x48a7bb)=>{const _0x5477c2=a0_0xe6f9;if(!_0x48a7bb?.[_0x5477c2(0x175)]){_0x5ad16e[_0x5477c2(0x125)][_0x5477c2(0x12c)](_0x5ad16e[_0x5477c2(0x163)]+'['+_0x5ad16e[_0x5477c2(0x152)]+_0x5477c2(0x1d7)+_0x491304+_0x5477c2(0x13d));return;}if(!_0x48a7bb?.[_0x5477c2(0x175)]?.['tenant']){_0x5ad16e[_0x5477c2(0x125)]['error'](_0x5ad16e['gwName']+'['+_0x5ad16e[_0x5477c2(0x152)]+']\x20publisher['+_0x491304+_0x5477c2(0x1da));return;}if(!_0x48a7bb?.[_0x5477c2(0x175)]?.[_0x5477c2(0xe6)]){_0x5ad16e[_0x5477c2(0x125)][_0x5477c2(0x12c)](_0x5ad16e[_0x5477c2(0x163)]+'['+_0x5ad16e[_0x5477c2(0x152)]+_0x5477c2(0x1d7)+_0x491304+_0x5477c2(0x199));return;}if(!_0x48a7bb?.[_0x5477c2(0x175)]?.[_0x5477c2(0xe6)][_0x5477c2(0x194)](_0x5477c2(0x1c4))){_0x5ad16e[_0x5477c2(0x125)][_0x5477c2(0x12c)](_0x5ad16e[_0x5477c2(0x163)]+'['+_0x5ad16e[_0x5477c2(0x152)]+_0x5477c2(0x1d7)+_0x491304+_0x5477c2(0x105));return;}if(!_0x48a7bb['baseUrls']||!Array[_0x5477c2(0x1cb)](_0x48a7bb['baseUrls'])||_0x48a7bb[_0x5477c2(0x15e)][_0x5477c2(0x14c)]<0x1){_0x5ad16e[_0x5477c2(0x125)][_0x5477c2(0x12c)](_0x5ad16e['gwName']+'['+_0x5ad16e[_0x5477c2(0x152)]+_0x5477c2(0x1d7)+_0x491304+_0x5477c2(0x124));return;}if(!_0x48a7bb?.[_0x5477c2(0x156)]?.['ca']){_0x5ad16e['logger']['error'](_0x5ad16e['gwName']+'['+_0x5ad16e[_0x5477c2(0x152)]+_0x5477c2(0x1d7)+_0x491304+']\x20initialization\x20error:\x20missing\x20certificate\x20configuration');return;}const _0x4b5a83={};try{let _0x5e85d5=a0_0x24d390[_0x5477c2(0xf1)](_0x5ad16e[_0x5477c2(0x15b)],_0x5477c2(0x18c),_0x48a7bb?.[_0x5477c2(0x156)]?.['ca']||_0x5477c2(0x1b4));(_0x48a7bb?.[_0x5477c2(0x156)]?.['ca']?.['startsWith']('/')||_0x48a7bb?.[_0x5477c2(0x156)]?.['ca']?.['includes']('\x5c'))&&(_0x5e85d5=_0x48a7bb['certificate']['ca']),_0x4b5a83['ca']=[a0_0x804e61[_0x5477c2(0x1c5)](_0x5e85d5)],_0x4b5a83['rejectUnauthorized']=!![];}catch(_0x3d855a){_0x5ad16e[_0x5477c2(0x125)][_0x5477c2(0x12c)](_0x5ad16e[_0x5477c2(0x163)]+'['+_0x5ad16e[_0x5477c2(0x152)]+_0x5477c2(0x1d7)+_0x491304+']\x20initialization\x20certificate\x20error:\x20'+_0x3d855a[_0x5477c2(0xe4)]);return;}const _0x30aeba={},_0x11bbbc=new TextEncoder()[_0x5477c2(0x1ce)](_0x48a7bb?.[_0x5477c2(0x175)]?.[_0x5477c2(0xec)]),_0x3dccc7=_0x48a7bb?.[_0x5477c2(0x175)]?.['jwt'];_0x30aeba['authenticator']=a0_0x1f12d0['jwtAuthenticator'](_0x3dccc7,_0x11bbbc),_0x30aeba['servers']=_0x48a7bb[_0x5477c2(0x15e)],_0x30aeba[_0x5477c2(0x195)]=_0x4b5a83,_0x30aeba['waitOnFirstConnect']=![],_0x30aeba['reconnect']=!![],_0x30aeba['reconnectTimeWait']=0x3e8*0xa,_0x30aeba[_0x5477c2(0xf9)]=-0x1,_0x30aeba[_0x5477c2(0xd6)]=0x2*0x3c*0x3e8,_0x30aeba['maxPingOut']=0x5,_0x30aeba[_0x5477c2(0x1b6)]=![],_0xbe3537[_0x491304]={},_0xbe3537[_0x491304][_0x5477c2(0x15a)]=_0x48a7bb,_0xbe3537[_0x491304]['nc']=undefined,_0x5bc997(_0x491304,_0x30aeba);};const _0x9778b2=a0_0x1f12d0['StringCodec']();this['publish']=async _0xfa4001=>{const _0x30d186=a0_0xe6f9;let _0x1b2739;try{if(_0xfa4001['constructor']===Object){_0x1b2739=_0xfa4001[_0x30d186(0xdc)];if(!_0x1b2739)_0xfa4001[_0x30d186(0xdc)]=_0x30d186(0xe3);_0xfa4001=JSON['stringify'](_0xfa4001);}else{const _0x16f574=JSON[_0x30d186(0x158)](_0xfa4001);_0x1b2739=_0x16f574['baseEntity'];}}catch(_0x42ec3b){throw new Error(_0x30d186(0x12b)+_0x1b2739+_0x30d186(0x135));}if(!_0xbe3537[_0x1b2739])throw new Error(_0x30d186(0x12b)+_0x1b2739+_0x30d186(0x1bc)+_0x1b2739);const _0x4b8cc1=a0_0x1f12d0[_0x30d186(0x185)]();_0x4b8cc1[_0x30d186(0x173)](_0x30d186(0x1c0),a0_0xd1e96[_0x30d186(0x188)]());let _0x15f045;try{if(!_0xbe3537[_0x1b2739]['nc'])throw new Error(_0x30d186(0x14e));_0x15f045=await _0xbe3537[_0x1b2739]['nc']['request'](_0xbe3537[_0x1b2739][_0x30d186(0x15a)]?.[_0x30d186(0x175)]?.['subject'],_0x9778b2['encode'](_0xfa4001),{'headers':_0x4b8cc1});}catch(_0xbface6){if(_0xbface6[_0x30d186(0xe4)]===_0x30d186(0xfc))throw new Error('publisher['+_0x1b2739+_0x30d186(0x141)+_0xbe3537[_0x1b2739][_0x30d186(0x15a)]?.['nats']?.[_0x30d186(0xe6)]);else throw new Error(_0x30d186(0x12b)+_0x1b2739+']\x20error:\x20'+_0xbface6['message']);}let _0xc2e300;try{_0xc2e300=JSON['parse'](_0x15f045[_0x30d186(0x128)]());}catch(_0x17d46d){throw new Error(_0x30d186(0x115)+_0x15f045['string']());}if(_0xc2e300?.[_0x30d186(0x12c)]){const _0x1634ad=new Error(_0x30d186(0x1d5)+_0xc2e300[_0x30d186(0x12c)]);_0x1634ad[_0x30d186(0x176)]=_0xc2e300[_0x30d186(0xde)];throw _0x1634ad;}return _0xc2e300;},process['on'](_0x3c1a84(0x1dd),async()=>{const _0x1ad7a5=_0x3c1a84;for(const _0x10514c in _0xbe3537){_0xbe3537[_0x10514c]['nc']&&!_0xbe3537[_0x10514c]['nc'][_0x1ad7a5(0x12e)]()&&await _0xbe3537[_0x10514c]['nc']['drain']();}}),process['on'](_0x3c1a84(0x11b),async()=>{const _0x8bdd93=_0x3c1a84;for(const _0xa7eed2 in _0xbe3537){_0xbe3537[_0xa7eed2]['nc']&&!_0xbe3537[_0xa7eed2]['nc'][_0x8bdd93(0x12e)]()&&await _0xbe3537[_0xa7eed2]['nc'][_0x8bdd93(0x10f)]();}});}}export const getAppRoles=async(_0x2af6a2,_0x118933)=>{const _0xaf47d5=a0_0xe6f9,_0x1cbcee=_0xaf47d5(0x100),_0x470236=_0x2af6a2;_0x470236[_0xaf47d5(0x125)][_0xaf47d5(0x1b6)](_0x470236[_0xaf47d5(0x163)]+'['+_0x470236[_0xaf47d5(0x152)]+']\x20handling\x20\x22'+_0x1cbcee+'\x22');try{if(!a0_0x804e61[_0xaf47d5(0x131)](_0x470236[_0xaf47d5(0x15b)]+'/approles'))a0_0x804e61[_0xaf47d5(0x1ca)](_0x470236[_0xaf47d5(0x15b)]+_0xaf47d5(0x113));}catch(_0x259e0a){void 0x0;}const _0x1bfbdf=a0_0x24d390['join'](''+_0x470236[_0xaf47d5(0x15b)],_0xaf47d5(0x181),_0xaf47d5(0x119)+_0x470236[_0xaf47d5(0x152)]+'_autogenerated.cfg'),_0xe0b9d5={};a0_0x3bafd7[_0xaf47d5(0x190)](_0x1bfbdf)&&a0_0x804e61[_0xaf47d5(0x1c5)](_0x1bfbdf,_0xaf47d5(0x1b5))[_0xaf47d5(0x1de)](/\r?\n/)[_0xaf47d5(0x18b)](_0x57f1d6=>{const _0xdfb2d0=_0xaf47d5,_0xafc7e7=_0x57f1d6[_0xdfb2d0(0x1de)]('\x20');_0xafc7e7[_0xdfb2d0(0x14c)]===0x2&&(_0xe0b9d5[_0xafc7e7[0x0]]=_0xafc7e7[0x1]);});const _0x9f44c3=a0_0x804e61[_0xaf47d5(0x18d)](_0x1bfbdf,{'flags':'w','encoding':_0xaf47d5(0x196),'mode':0x1b6,'autoClose':!![]}),_0x29c2cf=[],_0x105693=await _0x470236[_0xaf47d5(0x162)](_0x118933,{'attribute':undefined,'operator':undefined,'value':undefined},['id','displayName']);return _0x105693['Resources']['forEach'](_0x1b40fb=>{const _0x207852=_0xaf47d5;if(_0x1b40fb['id']){let _0x5b80da=a0_0xd1e96[_0x207852(0x188)]();if(_0xe0b9d5[_0x1b40fb['id']])_0x5b80da=_0xe0b9d5[_0x1b40fb['id']];const _0x17e71d={'allowedMemberTypes':[_0x207852(0x120)],'description':'SCIM\x20Stream\x20-\x20Autogenerated','displayName':_0x1b40fb['displayName']||_0x1b40fb['id'],'id':_0x5b80da,'isEnabled':!![],'lang':null,'origin':_0x207852(0x14a),'value':decodeURIComponent(_0x1b40fb['id'])};_0x29c2cf[_0x207852(0x1a4)](_0x17e71d),_0x9f44c3['write'](_0x1b40fb['id']+'\x20'+_0x5b80da+'\x0a');}}),_0x9f44c3[_0xaf47d5(0x102)](),_0x470236[_0xaf47d5(0x125)][_0xaf47d5(0x1b6)](_0x470236[_0xaf47d5(0x163)]+'['+_0x470236[_0xaf47d5(0x152)]+']\x20approle\x20uuid\x20file\x20created:\x20'+_0x1bfbdf),{'Resources':[{'appRoles':_0x29c2cf}]};};